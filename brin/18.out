                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=9150265.35..9150268.10 rows=100 width=39)
   ->  GroupAggregate  (cost=9150265.35..9975071.04 rows=29992934 width=39)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9150265.35..9225247.69 rows=29992934 width=39)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               ->  Hash Join  (cost=2710403.63..5425424.98 rows=29992934 width=39)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=8)
                     ->  Hash  (cost=2616652.56..2616652.56 rows=7500086 width=39)
                           ->  Hash Join  (cost=2049603.57..2616652.56 rows=7500086 width=39)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=1980571.52..2444494.33 rows=7500086 width=20)
                                       Hash Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..403279.73 rows=15000173 width=16)
                                       ->  Hash  (cost=1975080.99..1975080.99 rows=439243 width=4)
                                             ->  HashAggregate  (cost=1965198.02..1970688.56 rows=439243 width=8)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '315'::double precision)
                                                   ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1665268.68 rows=59985868 width=8)
                                 ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=23)
                                       ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=23)
(21 rows)

+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    31 |   37500000 |     0 |     0 |     0 |   488686 |   423524 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    43 | 1919597438 |     0 |     0 |     0 | 98974090 |  4960667 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |        5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    17 |  210000000 |     0 |     0 |     0 |  4842053 | 17593257 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    25 |   40000000 |     0 |     0 |     0 |   436270 |   571480 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    27 |  176000000 |     0 |     0 |     0 |  3778558 |    40020 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    30 |    2100000 |     0 |     0 |     0 |    21799 |   189929 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      110 |       110 |      110 |     58 |      302 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      110 |       110 |      110 |    108 |      397 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       20 | 213094400 |        0 |    546 |      174 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |       44 | 468807680 |        0 |   1125 |      419 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793858 |  13793858 | 13793858 |  41196 | 41415679 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      114 |   8000110 |  8000110 |   5522 |    16706 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25706 |    102614 |   102614 |   4409 |    73093 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102728 |    102728 |   102728 |    307 |   205793 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=9150265.35..9150268.10 rows=100 width=39) (actual time=108211.286..108211.429 rows=75 loops=1)
   ->  GroupAggregate  (cost=9150265.35..9975071.04 rows=29992934 width=39) (actual time=108211.285..108211.426 rows=75 loops=1)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9150265.35..9225247.69 rows=29992934 width=39) (actual time=108211.274..108211.301 rows=525 loops=1)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               Sort Method: quicksort  Memory: 66kB
               ->  Hash Join  (cost=2710403.63..5425424.98 rows=29992934 width=39) (actual time=68877.802..108167.948 rows=525 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=8) (actual time=0.009..34520.125 rows=59986052 loops=1)
                     ->  Hash  (cost=2616652.56..2616652.56 rows=7500086 width=39) (actual time=68603.951..68603.951 rows=75 loops=1)
                           Buckets: 8388608  Batches: 1  Memory Usage: 65542kB
                           ->  Hash Join  (cost=2049603.57..2616652.56 rows=7500086 width=39) (actual time=53198.548..68603.818 rows=75 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=1980571.52..2444494.33 rows=7500086 width=20) (actual time=50397.068..65802.147 rows=75 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..403279.73 rows=15000173 width=16) (actual time=0.004..14119.515 rows=15000000 loops=1)
                                       ->  Hash  (cost=1975080.99..1975080.99 rows=439243 width=4) (actual time=49962.829..49962.829 rows=75 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 4099kB
                                             ->  HashAggregate  (cost=1965198.02..1970688.56 rows=439243 width=8) (actual time=46856.058..49962.760 rows=75 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '315'::double precision)
                                                   Rows Removed by Filter: 14999925
                                                   ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1665268.68 rows=59985868 width=8) (actual time=0.003..28953.684 rows=59986052 loops=1)
                                 ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=23) (actual time=2773.976..2773.976 rows=1500000 loops=1)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 98416kB
                                       ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=23) (actual time=0.010..2476.992 rows=1500000 loops=1)
 Planning time: 1.000 ms
 Execution time: 108241.806 ms
(28 rows)

Time: 108284.998 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |   B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    33 |   39000000 |     0 |     0 |     0 |    523970 |   423532 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    47 | 2039569542 |     0 |     0 |     0 | 100127654 |  5937931 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |         5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    19 |  225000000 |     0 |     0 |     0 |   5095331 | 17593265 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    25 |   40000000 |     0 |     0 |     0 |    436270 |   571480 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    27 |  176000000 |     0 |     0 |     0 |   3778558 |    40020 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |         4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    30 |    2100000 |     0 |     0 |     0 |     21799 |   189929 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      118 |       118 |      118 |     64 |      322 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      118 |       118 |      118 |    116 |      423 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       20 | 213094400 |        0 |    546 |      174 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |       44 | 468807680 |        0 |   1125 |      419 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793866 |  13793866 | 13793866 |  41202 | 41415699 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      114 |   8000110 |  8000110 |   5522 |    16706 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25706 |    102614 |   102614 |   4409 |    73093 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102728 |    102728 |   102728 |    307 |   205793 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=9150265.35..9150268.10 rows=100 width=39) (actual time=104277.607..104277.737 rows=75 loops=1)
   ->  GroupAggregate  (cost=9150265.35..9975071.04 rows=29992934 width=39) (actual time=104277.606..104277.733 rows=75 loops=1)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9150265.35..9225247.69 rows=29992934 width=39) (actual time=104277.595..104277.613 rows=525 loops=1)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               Sort Method: quicksort  Memory: 66kB
               ->  Hash Join  (cost=2710403.63..5425424.98 rows=29992934 width=39) (actual time=65170.921..104277.171 rows=525 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=8) (actual time=0.011..34374.683 rows=59986052 loops=1)
                     ->  Hash  (cost=2616652.56..2616652.56 rows=7500086 width=39) (actual time=64934.674..64934.674 rows=75 loops=1)
                           Buckets: 8388608  Batches: 1  Memory Usage: 65542kB
                           ->  Hash Join  (cost=2049603.57..2616652.56 rows=7500086 width=39) (actual time=49471.955..64934.537 rows=75 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=1980571.52..2444494.33 rows=7500086 width=20) (actual time=48950.663..64413.081 rows=75 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..403279.73 rows=15000173 width=16) (actual time=0.004..14167.120 rows=15000000 loops=1)
                                       ->  Hash  (cost=1975080.99..1975080.99 rows=439243 width=4) (actual time=48513.617..48513.617 rows=75 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 4099kB
                                             ->  HashAggregate  (cost=1965198.02..1970688.56 rows=439243 width=8) (actual time=45424.813..48513.540 rows=75 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '315'::double precision)
                                                   Rows Removed by Filter: 14999925
                                                   ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1665268.68 rows=59985868 width=8) (actual time=0.003..28820.919 rows=59986052 loops=1)
                                 ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=23) (actual time=518.948..518.948 rows=1500000 loops=1)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 98416kB
                                       ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=23) (actual time=0.004..231.263 rows=1500000 loops=1)
 Planning time: 0.992 ms
 Execution time: 104304.734 ms
(28 rows)

Time: 104349.828 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |   B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    34 |   40500000 |     0 |     0 |     0 |    523970 |   458820 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    49 | 2159541646 |     0 |     0 |     0 | 101281235 |  6915174 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |         5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    20 |  240000000 |     0 |     0 |     0 |   5348575 | 17593303 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    25 |   40000000 |     0 |     0 |     0 |    436270 |   571480 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    27 |  176000000 |     0 |     0 |     0 |   3778558 |    40020 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |         4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    30 |    2100000 |     0 |     0 |     0 |     21799 |   189929 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      122 |       122 |      122 |     64 |      335 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      122 |       122 |      122 |    116 |      440 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       20 | 213094400 |        0 |    546 |      174 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |       44 | 468807680 |        0 |   1125 |      419 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793870 |  13793870 | 13793870 |  41202 | 41415712 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      114 |   8000110 |  8000110 |   5522 |    16706 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25706 |    102614 |   102614 |   4409 |    73093 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102728 |    102728 |   102728 |    307 |   205793 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=9150265.35..9150268.10 rows=100 width=39) (actual time=105355.502..105355.634 rows=75 loops=1)
   ->  GroupAggregate  (cost=9150265.35..9975071.04 rows=29992934 width=39) (actual time=105355.499..105355.626 rows=75 loops=1)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9150265.35..9225247.69 rows=29992934 width=39) (actual time=105355.489..105355.516 rows=525 loops=1)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               Sort Method: quicksort  Memory: 66kB
               ->  Hash Join  (cost=2710403.63..5425424.98 rows=29992934 width=39) (actual time=65202.571..105355.069 rows=525 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=8) (actual time=0.009..35396.512 rows=59986052 loops=1)
                     ->  Hash  (cost=2616652.56..2616652.56 rows=7500086 width=39) (actual time=64985.168..64985.168 rows=75 loops=1)
                           Buckets: 8388608  Batches: 1  Memory Usage: 65542kB
                           ->  Hash Join  (cost=2049603.57..2616652.56 rows=7500086 width=39) (actual time=49581.799..64985.030 rows=75 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=1980571.52..2444494.33 rows=7500086 width=20) (actual time=49063.938..64466.999 rows=75 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..403279.73 rows=15000173 width=16) (actual time=0.003..14143.320 rows=15000000 loops=1)
                                       ->  Hash  (cost=1975080.99..1975080.99 rows=439243 width=4) (actual time=48627.074..48627.074 rows=75 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 4099kB
                                             ->  HashAggregate  (cost=1965198.02..1970688.56 rows=439243 width=8) (actual time=45516.201..48627.005 rows=75 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '315'::double precision)
                                                   Rows Removed by Filter: 14999925
                                                   ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1665268.68 rows=59985868 width=8) (actual time=0.002..28857.899 rows=59986052 loops=1)
                                 ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=23) (actual time=515.342..515.342 rows=1500000 loops=1)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 98416kB
                                       ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=23) (actual time=0.004..230.092 rows=1500000 loops=1)
 Planning time: 0.993 ms
 Execution time: 105382.030 ms
(28 rows)

Time: 105426.409 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |   B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    35 |   42000000 |     0 |     0 |     0 |    523970 |   494108 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    51 | 2279513750 |     0 |     0 |     0 | 102434809 |  7892424 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |         5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    21 |  255000000 |     0 |     0 |     0 |   5601787 | 17593373 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    25 |   40000000 |     0 |     0 |     0 |    436270 |   571480 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    27 |  176000000 |     0 |     0 |     0 |   3778558 |    40020 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |         4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    30 |    2100000 |     0 |     0 |     0 |     21799 |   189929 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      126 |       126 |      126 |     64 |      348 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      126 |       126 |      126 |    116 |      457 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       20 | 213094400 |        0 |    546 |      174 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |       44 | 468807680 |        0 |   1125 |      419 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793874 |  13793874 | 13793874 |  41202 | 41415725 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      114 |   8000110 |  8000110 |   5522 |    16706 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25706 |    102614 |   102614 |   4409 |    73093 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102728 |    102728 |   102728 |    307 |   205793 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=9150265.35..9150268.10 rows=100 width=39) (actual time=106642.491..106642.622 rows=75 loops=1)
   ->  GroupAggregate  (cost=9150265.35..9975071.04 rows=29992934 width=39) (actual time=106642.488..106642.615 rows=75 loops=1)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9150265.35..9225247.69 rows=29992934 width=39) (actual time=106642.478..106642.505 rows=525 loops=1)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               Sort Method: quicksort  Memory: 66kB
               ->  Hash Join  (cost=2710403.63..5425424.98 rows=29992934 width=39) (actual time=67535.541..106642.030 rows=525 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=8) (actual time=0.010..34393.269 rows=59986052 loops=1)
                     ->  Hash  (cost=2616652.56..2616652.56 rows=7500086 width=39) (actual time=67277.172..67277.172 rows=75 loops=1)
                           Buckets: 8388608  Batches: 1  Memory Usage: 65542kB
                           ->  Hash Join  (cost=2049603.57..2616652.56 rows=7500086 width=39) (actual time=51871.786..67277.034 rows=75 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=1980571.52..2444494.33 rows=7500086 width=20) (actual time=49092.080..64497.130 rows=75 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..403279.73 rows=15000173 width=16) (actual time=0.005..14140.071 rows=15000000 loops=1)
                                       ->  Hash  (cost=1975080.99..1975080.99 rows=439243 width=4) (actual time=48657.043..48657.043 rows=75 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 4099kB
                                             ->  HashAggregate  (cost=1965198.02..1970688.56 rows=439243 width=8) (actual time=45565.636..48656.966 rows=75 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '315'::double precision)
                                                   Rows Removed by Filter: 14999925
                                                   ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1665268.68 rows=59985868 width=8) (actual time=0.002..28873.742 rows=59986052 loops=1)
                                 ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=23) (actual time=2777.195..2777.195 rows=1500000 loops=1)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 98416kB
                                       ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=23) (actual time=0.004..2481.555 rows=1500000 loops=1)
 Planning time: 0.975 ms
 Execution time: 106668.245 ms
(28 rows)

Time: 106707.434 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |   B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    36 |   43500000 |     0 |     0 |     0 |    559252 |   494114 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    53 | 2399485854 |     0 |     0 |     0 | 103588445 |  8869612 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |         5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    22 |  270000000 |     0 |     0 |     0 |   5854999 | 17593443 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    25 |   40000000 |     0 |     0 |     0 |    436270 |   571480 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    27 |  176000000 |     0 |     0 |     0 |   3778558 |    40020 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |         4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    30 |    2100000 |     0 |     0 |     0 |     21799 |   189929 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+-----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      130 |       130 |      130 |     64 |      361 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      130 |       130 |      130 |    116 |      474 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       20 | 213094400 |        0 |    546 |      174 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |       44 | 468807680 |        0 |   1125 |      419 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793878 |  13793878 | 13793878 |  41202 | 41415738 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      114 |   8000110 |  8000110 |   5522 |    16706 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25706 |    102614 |   102614 |   4409 |    73093 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102728 |    102728 |   102728 |    307 |   205793 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
