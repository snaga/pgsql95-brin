                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=3087242.04..3087247.64 rows=160 width=46)
   Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
   ->  Sort  (cost=3087242.04..3087242.44 rows=160 width=46)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         ->  Hash Join  (cost=371282.93..3087236.18 rows=160 width=46)
               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
               ->  Nested Loop  (cost=371281.37..3087231.62 rows=160 width=24)
                     ->  Hash Join  (cost=371280.94..3086303.91 rows=160 width=24)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (lineitem.l_partkey = partsupp.ps_partkey))
                           ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=24)
                           ->  Hash  (cost=364007.87..364007.87 rows=484871 width=24)
                                 ->  Hash Join  (cost=71571.41..364007.87 rows=484871 width=24)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=67141.41..352910.89 rows=484871 width=16)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..250919.47 rows=8000347 width=12)
                                             ->  Hash  (cost=65626.30..65626.30 rows=121209 width=4)
                                                   ->  Seq Scan on part  (cost=0.00..65626.30 rows=121209 width=4)
                                                         Filter: ((p_name)::text ~~ '%honeydew%'::text)
                                       ->  Hash  (cost=3180.00..3180.00 rows=100000 width=8)
                                             ->  Seq Scan on supplier  (cost=0.00..3180.00 rows=100000 width=8)
                     ->  Index Scan using pk_orders on orders  (cost=0.43..5.79 rows=1 width=8)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Hash  (cost=1.25..1.25 rows=25 width=30)
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30)
(25 rows)

+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    21 |   25500000 |     0 |     0 |     0 |   418120 |  211788 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    28 | 1439665248 |     0 |     0 |     0 | 35344694 | 3040146 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    31 |        625 |     0 |     0 |     0 |        5 |  102715 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069298 | 2532898 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     5 |    8000000 |     0 |     0 |     0 |   111254 |  246394 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     7 |   48000000 |     0 |     0 |     0 |  1045210 |   38662 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |   25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    16 |    1300000 |     0 |     0 |     0 |    19616 |  157148 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+--------+-----------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |   T_READ  |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+-----------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     80 |        80 |      80 |     52 |    208 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |     80 |        80 |      80 |     72 |    283 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |     12 | 127856640 |       0 |    328 |    104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 | 102694 |    102694 |  102694 |     10 | 102704 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |     16 |  40529920 |       0 |     40 |    120 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |     80 |        80 |      80 |     52 |    213 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     44 |   8000040 | 8000040 |   5475 |  16523 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |      0 |         0 |       0 |      0 |      0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |  25656 |    102564 |  102564 |   4397 |  72940 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     40 |        40 |      40 |      6 |     49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102644 |    102644 |  102644 |    294 | 205618 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |     20 |    460800 |       0 |      3 |     25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+-----------+---------+--------+--------+--------+------------+
SET
Timing is on.
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=3087242.04..3087247.64 rows=160 width=46) (actual time=95014.276..96522.422 rows=175 loops=1)
   Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
   ->  Sort  (cost=3087242.04..3087242.44 rows=160 width=46) (actual time=94992.438..95407.555 rows=3448437 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: quicksort  Memory: 583241kB
         ->  Hash Join  (cost=371282.93..3087236.18 rows=160 width=46) (actual time=7942.431..90560.134 rows=3448437 loops=1)
               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
               ->  Nested Loop  (cost=371281.37..3087231.62 rows=160 width=24) (actual time=7942.401..89364.584 rows=3448437 loops=1)
                     ->  Hash Join  (cost=371280.94..3086303.91 rows=160 width=24) (actual time=7942.385..74513.685 rows=3448437 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (lineitem.l_partkey = partsupp.ps_partkey))
                           ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=24) (actual time=0.003..52646.190 rows=59986052 loops=1)
                           ->  Hash  (cost=364007.87..364007.87 rows=484871 width=24) (actual time=7941.432..7941.432 rows=459844 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 29244kB
                                 ->  Hash Join  (cost=71571.41..364007.87 rows=484871 width=24) (actual time=410.612..7827.795 rows=459844 loops=1)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=67141.41..352910.89 rows=484871 width=16) (actual time=381.810..7607.360 rows=459844 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..250919.47 rows=8000347 width=12) (actual time=0.004..6342.933 rows=8000000 loops=1)
                                             ->  Hash  (cost=65626.30..65626.30 rows=121209 width=4) (actual time=381.505..381.505 rows=114961 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5066kB
                                                   ->  Seq Scan on part  (cost=0.00..65626.30 rows=121209 width=4) (actual time=0.011..360.452 rows=114961 loops=1)
                                                         Filter: ((p_name)::text ~~ '%honeydew%'::text)
                                                         Rows Removed by Filter: 1885039
                                       ->  Hash  (cost=3180.00..3180.00 rows=100000 width=8) (actual time=28.544..28.544 rows=100000 loops=1)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3180.00 rows=100000 width=8) (actual time=0.003..16.568 rows=100000 loops=1)
                     ->  Index Scan using pk_orders on orders  (cost=0.43..5.79 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=3448437)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.010..0.010 rows=25 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 10kB
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.001..0.004 rows=25 loops=1)
 Planning time: 2.100 ms
 Execution time: 96534.331 ms
(33 rows)

Time: 96537.849 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    21 |   25500000 |     0 |     0 |     0 |   418120 |  211788 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    30 | 1499651300 |     0 |     0 |     0 | 36258720 | 3191534 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    33 |        650 |     0 |     0 |     0 |        5 |  102720 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069298 | 5981339 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     7 |   10000000 |     0 |     0 |     0 |   111254 |  287037 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     9 |   56000000 |     0 |     0 |     0 |  1216126 |   38678 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |   25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    18 |    1400000 |     0 |     0 |     0 |    19616 |  159344 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN  |   T_READ  |  T_FTCH | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      80 |        80 |      80 |     52 |      208 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      84 |        84 |      84 |     72 |      301 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |      12 | 127856640 |       0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |  102698 |    102698 |  102698 |     10 |   102710 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |      16 |  40529920 |       0 |     40 |      120 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 3448521 |   3448521 | 3448521 |  41177 | 10323227 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      60 |   8000056 | 8000056 |   5475 |    16573 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |   25672 |    102580 |  102580 |   4403 |    72984 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |      40 |        40 |      40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |  102660 |    102660 |  102660 |    294 |   205652 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |      20 |    460800 |       0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
SET
Timing is on.
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=3087242.04..3087247.64 rows=160 width=46) (actual time=68024.736..69537.870 rows=175 loops=1)
   Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
   ->  Sort  (cost=3087242.04..3087242.44 rows=160 width=46) (actual time=68004.462..68422.866 rows=3448437 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: quicksort  Memory: 583241kB
         ->  Hash Join  (cost=371282.93..3087236.18 rows=160 width=46) (actual time=7894.340..63537.380 rows=3448437 loops=1)
               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
               ->  Nested Loop  (cost=371281.37..3087231.62 rows=160 width=24) (actual time=7894.309..62345.153 rows=3448437 loops=1)
                     ->  Hash Join  (cost=371280.94..3086303.91 rows=160 width=24) (actual time=7894.293..56329.016 rows=3448437 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (lineitem.l_partkey = partsupp.ps_partkey))
                           ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=24) (actual time=0.002..34624.082 rows=59986052 loops=1)
                           ->  Hash  (cost=364007.87..364007.87 rows=484871 width=24) (actual time=7893.355..7893.355 rows=459844 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 29244kB
                                 ->  Hash Join  (cost=71571.41..364007.87 rows=484871 width=24) (actual time=411.757..7781.247 rows=459844 loops=1)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=67141.41..352910.89 rows=484871 width=16) (actual time=382.880..7568.914 rows=459844 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..250919.47 rows=8000347 width=12) (actual time=0.003..6323.699 rows=8000000 loops=1)
                                             ->  Hash  (cost=65626.30..65626.30 rows=121209 width=4) (actual time=381.919..381.919 rows=114961 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5066kB
                                                   ->  Seq Scan on part  (cost=0.00..65626.30 rows=121209 width=4) (actual time=0.010..360.650 rows=114961 loops=1)
                                                         Filter: ((p_name)::text ~~ '%honeydew%'::text)
                                                         Rows Removed by Filter: 1885039
                                       ->  Hash  (cost=3180.00..3180.00 rows=100000 width=8) (actual time=28.616..28.616 rows=100000 loops=1)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3180.00 rows=100000 width=8) (actual time=0.003..16.504 rows=100000 loops=1)
                     ->  Index Scan using pk_orders on orders  (cost=0.43..5.79 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=3448437)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.010..0.010 rows=25 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 10kB
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.004 rows=25 loops=1)
 Planning time: 2.105 ms
 Execution time: 69549.930 ms
(33 rows)

Time: 69553.621 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    21 |   25500000 |     0 |     0 |     0 |   418120 |  211788 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    31 | 1559637352 |     0 |     0 |     0 | 37172714 | 3342952 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    34 |        675 |     0 |     0 |     0 |        5 |  102723 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069298 | 9429778 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     8 |   12000000 |     0 |     0 |     0 |   111254 |  327672 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    10 |   64000000 |     0 |     0 |     0 |  1387008 |   38720 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |   25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    19 |    1500000 |     0 |     0 |     0 |    19616 |  161532 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN  |   T_READ  |  T_FTCH | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      80 |        80 |      80 |     52 |      208 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      86 |        86 |      86 |     72 |      310 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |      12 | 127856640 |       0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |  102700 |    102700 |  102700 |     10 |   102713 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |      16 |  40529920 |       0 |     40 |      120 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 6896960 |   6896960 | 6896960 |  41177 | 20687359 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      68 |   8000064 | 8000064 |   5475 |    16598 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |       0 |         0 |       0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |   25680 |    102588 |  102588 |   4403 |    73009 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |      40 |        40 |      40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |  102668 |    102668 |  102668 |    294 |   205669 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |      20 |    460800 |       0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
SET
Timing is on.
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=3087242.04..3087247.64 rows=160 width=46) (actual time=67832.849..69347.584 rows=175 loops=1)
   Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
   ->  Sort  (cost=3087242.04..3087242.44 rows=160 width=46) (actual time=67816.756..68236.165 rows=3448437 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: quicksort  Memory: 583241kB
         ->  Hash Join  (cost=371282.93..3087236.18 rows=160 width=46) (actual time=7877.415..63315.711 rows=3448437 loops=1)
               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
               ->  Nested Loop  (cost=371281.37..3087231.62 rows=160 width=24) (actual time=7877.384..62119.027 rows=3448437 loops=1)
                     ->  Hash Join  (cost=371280.94..3086303.91 rows=160 width=24) (actual time=7877.367..56093.316 rows=3448437 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (lineitem.l_partkey = partsupp.ps_partkey))
                           ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=24) (actual time=0.002..34404.423 rows=59986052 loops=1)
                           ->  Hash  (cost=364007.87..364007.87 rows=484871 width=24) (actual time=7876.416..7876.416 rows=459844 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 29244kB
                                 ->  Hash Join  (cost=71571.41..364007.87 rows=484871 width=24) (actual time=410.254..7763.694 rows=459844 loops=1)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=67141.41..352910.89 rows=484871 width=16) (actual time=381.410..7549.066 rows=459844 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..250919.47 rows=8000347 width=12) (actual time=0.003..6301.915 rows=8000000 loops=1)
                                             ->  Hash  (cost=65626.30..65626.30 rows=121209 width=4) (actual time=381.083..381.083 rows=114961 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5066kB
                                                   ->  Seq Scan on part  (cost=0.00..65626.30 rows=121209 width=4) (actual time=0.010..359.828 rows=114961 loops=1)
                                                         Filter: ((p_name)::text ~~ '%honeydew%'::text)
                                                         Rows Removed by Filter: 1885039
                                       ->  Hash  (cost=3180.00..3180.00 rows=100000 width=8) (actual time=28.584..28.584 rows=100000 loops=1)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3180.00 rows=100000 width=8) (actual time=0.003..16.421 rows=100000 loops=1)
                     ->  Index Scan using pk_orders on orders  (cost=0.43..5.79 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=3448437)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.010..0.010 rows=25 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 10kB
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.005 rows=25 loops=1)
 Planning time: 2.107 ms
 Execution time: 69359.514 ms
(33 rows)

Time: 69363.199 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    21 |   25500000 |     0 |     0 |     0 |   418120 |   211788 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    32 | 1619623404 |     0 |     0 |     0 | 38086676 |  3494402 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    35 |        700 |     0 |     0 |     0 |        5 |   102726 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069298 | 12878217 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     9 |   14000000 |     0 |     0 |     0 |   111254 |   368307 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    11 |   72000000 |     0 |     0 |     0 |  1557858 |    38794 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    20 |    1600000 |     0 |     0 |     0 |    19616 |   163720 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |       80 |        80 |       80 |     52 |      208 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |       88 |        88 |       88 |     72 |      319 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102702 |    102702 |   102702 |     10 |   102716 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       16 |  40529920 |        0 |     40 |      120 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10345399 |  10345399 | 10345399 |  41177 | 31051491 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       76 |   8000072 |  8000072 |   5475 |    16623 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25688 |    102596 |   102596 |   4403 |    73034 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102676 |    102676 |   102676 |    294 |   205686 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       20 |    460800 |        0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=3087242.04..3087247.64 rows=160 width=46) (actual time=67733.347..69250.330 rows=175 loops=1)
   Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
   ->  Sort  (cost=3087242.04..3087242.44 rows=160 width=46) (actual time=67718.853..68138.918 rows=3448437 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: quicksort  Memory: 583241kB
         ->  Hash Join  (cost=371282.93..3087236.18 rows=160 width=46) (actual time=8002.871..63290.190 rows=3448437 loops=1)
               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
               ->  Nested Loop  (cost=371281.37..3087231.62 rows=160 width=24) (actual time=8002.840..62087.021 rows=3448437 loops=1)
                     ->  Hash Join  (cost=371280.94..3086303.91 rows=160 width=24) (actual time=8002.823..56066.633 rows=3448437 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (lineitem.l_partkey = partsupp.ps_partkey))
                           ->  Seq Scan on lineitem  (cost=0.00..1665268.68 rows=59985868 width=24) (actual time=0.003..34192.453 rows=59986052 loops=1)
                           ->  Hash  (cost=364007.87..364007.87 rows=484871 width=24) (actual time=8001.886..8001.886 rows=459844 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 29244kB
                                 ->  Hash Join  (cost=71571.41..364007.87 rows=484871 width=24) (actual time=409.502..7889.132 rows=459844 loops=1)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=67141.41..352910.89 rows=484871 width=16) (actual time=380.657..7675.886 rows=459844 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..250919.47 rows=8000347 width=12) (actual time=0.004..6429.147 rows=8000000 loops=1)
                                             ->  Hash  (cost=65626.30..65626.30 rows=121209 width=4) (actual time=380.328..380.328 rows=114961 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5066kB
                                                   ->  Seq Scan on part  (cost=0.00..65626.30 rows=121209 width=4) (actual time=0.011..359.031 rows=114961 loops=1)
                                                         Filter: ((p_name)::text ~~ '%honeydew%'::text)
                                                         Rows Removed by Filter: 1885039
                                       ->  Hash  (cost=3180.00..3180.00 rows=100000 width=8) (actual time=28.580..28.580 rows=100000 loops=1)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3180.00 rows=100000 width=8) (actual time=0.003..16.451 rows=100000 loops=1)
                     ->  Index Scan using pk_orders on orders  (cost=0.43..5.79 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=3448437)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.010..0.010 rows=25 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 10kB
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.005 rows=25 loops=1)
 Planning time: 2.110 ms
 Execution time: 69262.198 ms
(33 rows)

Time: 69266.054 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    21 |   25500000 |     0 |     0 |     0 |   418120 |   211788 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    33 | 1679609456 |     0 |     0 |     0 | 39000606 |  3645884 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    36 |        725 |     0 |     0 |     0 |        5 |   102729 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069298 | 16326656 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   80000000 |     0 |     0 |     0 |  1728676 |    38900 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   165908 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |       80 |        80 |       80 |     52 |      208 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |       90 |        90 |       90 |     72 |      328 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102704 |    102704 |   102704 |     10 |   102719 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       16 |  40529920 |        0 |     40 |      120 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793838 |  13793838 | 13793838 |  41177 | 41415623 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73059 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102684 |    102684 |   102684 |    294 |   205703 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       20 |    460800 |        0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
