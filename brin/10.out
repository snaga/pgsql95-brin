                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2272044.56..2272044.61 rows=20 width=175)
   ->  Sort  (cost=2272044.56..2273488.03 rows=577389 width=175)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         ->  HashAggregate  (cost=2250906.56..2256680.45 rows=577389 width=175)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=344669.33..2236471.83 rows=577389 width=175)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=344667.77..2228531.17 rows=577389 width=153)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=275635.73..2151560.03 rows=577389 width=12)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..1815233.35 rows=14644550 width=12)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                 ->  Hash  (cost=268243.10..268243.10 rows=591410 width=8)
                                       ->  Bitmap Heap Scan on orders  (cost=6093.95..268243.10 rows=591410 width=8)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..5946.10 rows=591410 width=0)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=145)
                                 ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=145)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30)
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30)
(22 rows)

+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    21 |   25500000 |     0 |     0 |     0 |   418120 |   211788 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    33 | 1679609456 |     0 |     0 |     0 | 39000606 |  3645884 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    36 |        725 |     0 |     0 |     0 |        5 |   102729 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069298 | 16326656 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   80000000 |     0 |     0 |     0 |  1728676 |    38900 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   165908 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |       80 |        80 |       80 |     52 |      208 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |       90 |        90 |       90 |     72 |      328 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102704 |    102704 |   102704 |     10 |   102719 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       16 |  40529920 |        0 |     40 |      120 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793838 |  13793838 | 13793838 |  41177 | 41415623 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73059 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102684 |    102684 |   102684 |    294 |   205703 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       20 |    460800 |        0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2272044.56..2272044.61 rows=20 width=175) (actual time=61120.411..61120.413 rows=20 loops=1)
   ->  Sort  (cost=2272044.56..2273488.03 rows=577389 width=175) (actual time=61120.410..61120.412 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=2250906.56..2256680.45 rows=577389 width=175) (actual time=60883.016..61029.748 rows=378486 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=344669.33..2236471.83 rows=577389 width=175) (actual time=5082.936..59780.423 rows=1135706 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=344667.77..2228531.17 rows=577389 width=153) (actual time=5082.922..59548.224 rows=1135706 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=275635.73..2151560.03 rows=577389 width=12) (actual time=2251.189..56260.788 rows=1135706 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..1815233.35 rows=14644550 width=12) (actual time=0.010..52062.691 rows=14808183 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 45177869
                                 ->  Hash  (cost=268243.10..268243.10 rows=591410 width=8) (actual time=2237.535..2237.535 rows=567767 loops=1)
                                       Buckets: 1048576  Batches: 1  Memory Usage: 30371kB
                                       ->  Bitmap Heap Scan on orders  (cost=6093.95..268243.10 rows=591410 width=8) (actual time=30.469..2127.135 rows=567767 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Rows Removed by Index Recheck: 14432233
                                             Heap Blocks: lossy=253278
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..5946.10 rows=591410 width=0) (actual time=30.365..30.365 rows=2533120 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=145) (actual time=2829.221..2829.221 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 281536kB
                                 ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=145) (actual time=0.003..2310.851 rows=1500000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.010..0.010 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.004 rows=25 loops=1)
 Planning time: 1.015 ms
 Execution time: 61126.529 ms
(31 rows)

Time: 61139.301 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    23 |   27000000 |     0 |     0 |     0 |   453402 |   211798 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    35 | 1739595508 |     0 |     0 |     0 | 39914727 |  3797177 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    38 |        750 |     0 |     0 |     0 |        5 |   102734 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069299 | 16579937 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   80000000 |     0 |     0 |     0 |  1728676 |    38900 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   165908 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |       88 |        88 |       88 |     52 |      234 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |       94 |        94 |       94 |     72 |      346 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102708 |    102708 |   102708 |     10 |   102725 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       17 |  43063040 |        0 |     45 |      125 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793842 |  13793842 | 13793842 |  41177 | 41415637 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73059 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102684 |    102684 |   102684 |    294 |   205703 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       20 |    460800 |        0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2272044.56..2272044.61 rows=20 width=175) (actual time=58943.139..58943.143 rows=20 loops=1)
   ->  Sort  (cost=2272044.56..2273488.03 rows=577389 width=175) (actual time=58943.137..58943.139 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=2250906.56..2256680.45 rows=577389 width=175) (actual time=58703.610..58852.386 rows=378486 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=344669.33..2236471.83 rows=577389 width=175) (actual time=3029.002..57598.226 rows=1135706 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=344667.77..2228531.17 rows=577389 width=153) (actual time=3028.984..57366.148 rows=1135706 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=275635.73..2151560.03 rows=577389 width=12) (actual time=2222.958..56107.224 rows=1135706 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..1815233.35 rows=14644550 width=12) (actual time=0.009..51935.541 rows=14808183 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 45177869
                                 ->  Hash  (cost=268243.10..268243.10 rows=591410 width=8) (actual time=2213.938..2213.938 rows=567767 loops=1)
                                       Buckets: 1048576  Batches: 1  Memory Usage: 30371kB
                                       ->  Bitmap Heap Scan on orders  (cost=6093.95..268243.10 rows=591410 width=8) (actual time=14.180..2103.667 rows=567767 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Rows Removed by Index Recheck: 14432233
                                             Heap Blocks: lossy=253278
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..5946.10 rows=591410 width=0) (actual time=14.080..14.080 rows=2533120 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=145) (actual time=803.511..803.511 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 281536kB
                                 ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=145) (actual time=0.004..293.794 rows=1500000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.013..0.013 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.003..0.007 rows=25 loops=1)
 Planning time: 1.011 ms
 Execution time: 58948.868 ms
(31 rows)

Time: 58959.914 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    24 |   28500000 |     0 |     0 |     0 |   453402 |   247086 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    36 | 1799581560 |     0 |     0 |     0 | 40828816 |  3948500 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    39 |        775 |     0 |     0 |     0 |        5 |   102737 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069299 | 16833217 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   80000000 |     0 |     0 |     0 |  1728676 |    38900 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   165908 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |       92 |        92 |       92 |     52 |      247 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |       96 |        96 |       96 |     72 |      355 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102710 |    102710 |   102710 |     10 |   102728 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       18 |  45596160 |        0 |     45 |      135 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793844 |  13793844 | 13793844 |  41177 | 41415644 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73059 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102684 |    102684 |   102684 |    294 |   205703 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       20 |    460800 |        0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2272044.56..2272044.61 rows=20 width=175) (actual time=59065.297..59065.301 rows=20 loops=1)
   ->  Sort  (cost=2272044.56..2273488.03 rows=577389 width=175) (actual time=59065.296..59065.297 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=2250906.56..2256680.45 rows=577389 width=175) (actual time=58827.147..58974.725 rows=378486 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=344669.33..2236471.83 rows=577389 width=175) (actual time=3095.292..57768.120 rows=1135706 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=344667.77..2228531.17 rows=577389 width=153) (actual time=3095.276..57536.768 rows=1135706 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=275635.73..2151560.03 rows=577389 width=12) (actual time=2284.401..56271.213 rows=1135706 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..1815233.35 rows=14644550 width=12) (actual time=0.009..52090.224 rows=14808183 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 45177869
                                 ->  Hash  (cost=268243.10..268243.10 rows=591410 width=8) (actual time=2222.964..2222.964 rows=567767 loops=1)
                                       Buckets: 1048576  Batches: 1  Memory Usage: 30371kB
                                       ->  Bitmap Heap Scan on orders  (cost=6093.95..268243.10 rows=591410 width=8) (actual time=14.193..2111.543 rows=567767 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Rows Removed by Index Recheck: 14432233
                                             Heap Blocks: lossy=253278
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..5946.10 rows=591410 width=0) (actual time=14.088..14.088 rows=2533120 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=145) (actual time=808.589..808.589 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 281536kB
                                 ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=145) (actual time=0.004..295.078 rows=1500000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.010..0.010 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.003 rows=25 loops=1)
 Planning time: 1.055 ms
 Execution time: 59071.098 ms
(31 rows)

Time: 59084.855 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    25 |   30000000 |     0 |     0 |     0 |   453402 |   282374 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    37 | 1859567612 |     0 |     0 |     0 | 41742873 |  4099855 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    40 |        800 |     0 |     0 |     0 |        5 |   102740 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069299 | 17086497 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   80000000 |     0 |     0 |     0 |  1728676 |    38900 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   165908 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |       96 |        96 |       96 |     52 |      260 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |       98 |        98 |       98 |     72 |      364 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102712 |    102712 |   102712 |     10 |   102731 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       19 |  48129280 |        0 |     45 |      145 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793846 |  13793846 | 13793846 |  41177 | 41415651 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73059 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102684 |    102684 |   102684 |    294 |   205703 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       20 |    460800 |        0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2272044.56..2272044.61 rows=20 width=175) (actual time=58908.294..58908.298 rows=20 loops=1)
   ->  Sort  (cost=2272044.56..2273488.03 rows=577389 width=175) (actual time=58908.292..58908.294 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=2250906.56..2256680.45 rows=577389 width=175) (actual time=58668.946..58815.494 rows=378486 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=344669.33..2236471.83 rows=577389 width=175) (actual time=3037.804..57622.558 rows=1135706 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=344667.77..2228531.17 rows=577389 width=153) (actual time=3037.786..57389.799 rows=1135706 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=275635.73..2151560.03 rows=577389 width=12) (actual time=2233.573..56130.228 rows=1135706 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..1815233.35 rows=14644550 width=12) (actual time=0.009..51953.179 rows=14808183 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 45177869
                                 ->  Hash  (cost=268243.10..268243.10 rows=591410 width=8) (actual time=2219.841..2219.841 rows=567767 loops=1)
                                       Buckets: 1048576  Batches: 1  Memory Usage: 30371kB
                                       ->  Bitmap Heap Scan on orders  (cost=6093.95..268243.10 rows=591410 width=8) (actual time=14.193..2109.454 rows=567767 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Rows Removed by Index Recheck: 14432233
                                             Heap Blocks: lossy=253278
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..5946.10 rows=591410 width=0) (actual time=14.091..14.091 rows=2533120 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=145) (actual time=801.705..801.705 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 281536kB
                                 ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=145) (actual time=0.005..293.808 rows=1500000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.012..0.012 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.003..0.005 rows=25 loops=1)
 Planning time: 1.015 ms
 Execution time: 58914.246 ms
(31 rows)

Time: 58927.351 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    26 |   31500000 |     0 |     0 |     0 |   453402 |   317662 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    38 | 1919553664 |     0 |     0 |     0 | 42656898 |  4251242 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    41 |        825 |     0 |     0 |     0 |        5 |   102743 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   90000000 |     0 |     0 |     0 |  3069299 | 17339777 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   80000000 |     0 |     0 |     0 |  1728676 |    38900 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   165908 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      100 |       100 |      100 |     52 |      273 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      100 |       100 |      100 |     72 |      373 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102714 |    102714 |   102714 |     10 |   102734 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793848 |  13793848 | 13793848 |  41177 | 41415658 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73059 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102684 |    102684 |   102684 |    294 |   205703 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       20 |    460800 |        0 |      3 |       25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
