                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort  (cost=822939.71..822940.21 rows=200 width=8)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   ->  HashAggregate  (cost=822930.06..822932.06 rows=200 width=8)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=785432.24..800431.37 rows=1499913 width=8)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.04..711933.56 rows=14699735 width=8)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440780.16 rows=14699735 width=8)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                     ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=4)
                           ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=4)
(12 rows)

+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    26 |   31500000 |     0 |     0 |     0 |   453402 |   317662 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    38 | 1919553664 |     0 |     0 |     0 | 46918537 |  4251253 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |        5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    12 |  150000000 |     0 |     0 |     0 |  3829133 | 17593065 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    22 |  144000000 |     0 |     0 |     0 |  3095092 |    39812 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   183388 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      100 |       100 |      100 |     52 |      273 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      110 |       110 |      110 |     96 |      394 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793858 |  13793858 | 13793858 |  41195 | 41415675 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73064 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102724 |    102724 |   102724 |    294 |   205788 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=822939.71..822940.21 rows=200 width=8) (actual time=21984.807..21984.808 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=822930.06..822932.06 rows=200 width=8) (actual time=21984.757..21984.761 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=785432.24..800431.37 rows=1499913 width=8) (actual time=21449.986..21794.407 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.04..711933.56 rows=14699735 width=8) (actual time=2764.986..15689.577 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440780.16 rows=14699735 width=8) (actual time=0.831..6830.894 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=4) (actual time=2761.641..2761.641 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=4) (actual time=0.006..2494.005 rows=1500000 loops=1)
 Planning time: 0.536 ms
 Execution time: 21991.002 ms
(17 rows)

Time: 21995.806 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    28 |   33000000 |     0 |     0 |     0 |   488686 |   317666 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    38 | 1919553664 |     0 |     0 |     0 | 46918537 |  4251253 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |        5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    14 |  165000000 |     0 |     0 |     0 |  4082411 | 17593065 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    22 |  144000000 |     0 |     0 |     0 |  3095092 |    39812 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   183388 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      104 |       104 |      104 |     58 |      281 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      110 |       110 |      110 |     96 |      394 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793858 |  13793858 | 13793858 |  41196 | 41415676 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73064 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102724 |    102724 |   102724 |    294 |   205788 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=822939.71..822940.21 rows=200 width=8) (actual time=19176.300..19176.300 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=822930.06..822932.06 rows=200 width=8) (actual time=19176.255..19176.258 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=785432.24..800431.37 rows=1499913 width=8) (actual time=18636.310..18984.625 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.04..711933.56 rows=14699735 width=8) (actual time=475.121..12836.388 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440780.16 rows=14699735 width=8) (actual time=0.301..6300.026 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=4) (actual time=472.308..472.308 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=4) (actual time=0.005..216.030 rows=1500000 loops=1)
 Planning time: 0.555 ms
 Execution time: 19182.890 ms
(17 rows)

Time: 19185.846 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    29 |   34500000 |     0 |     0 |     0 |   488686 |   352952 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    38 | 1919553664 |     0 |     0 |     0 | 46918537 |  4251253 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |        5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    15 |  180000000 |     0 |     0 |     0 |  4335657 | 17593097 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    22 |  144000000 |     0 |     0 |     0 |  3095092 |    39812 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   183388 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      106 |       106 |      106 |     58 |      288 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      110 |       110 |      110 |     96 |      394 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793858 |  13793858 | 13793858 |  41196 | 41415677 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73064 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102724 |    102724 |   102724 |    294 |   205788 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=822939.71..822940.21 rows=200 width=8) (actual time=18981.470..18981.474 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=822930.06..822932.06 rows=200 width=8) (actual time=18981.422..18981.427 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=785432.24..800431.37 rows=1499913 width=8) (actual time=18446.320..18790.961 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.04..711933.56 rows=14699735 width=8) (actual time=492.396..12669.351 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440780.16 rows=14699735 width=8) (actual time=17.813..6132.650 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=4) (actual time=472.065..472.065 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=4) (actual time=0.005..216.412 rows=1500000 loops=1)
 Planning time: 0.546 ms
 Execution time: 18987.836 ms
(17 rows)

Time: 18991.697 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    30 |   36000000 |     0 |     0 |     0 |   488686 |   388238 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    38 | 1919553664 |     0 |     0 |     0 | 46918537 |  4251253 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |        5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    16 |  195000000 |     0 |     0 |     0 |  4588871 | 17593161 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    22 |  144000000 |     0 |     0 |     0 |  3095092 |    39812 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   183388 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      108 |       108 |      108 |     58 |      295 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      110 |       110 |      110 |     96 |      394 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793858 |  13793858 | 13793858 |  41196 | 41415678 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73064 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102724 |    102724 |   102724 |    294 |   205788 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=822939.71..822940.21 rows=200 width=8) (actual time=17560.404..17560.404 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=822930.06..822932.06 rows=200 width=8) (actual time=17560.356..17560.363 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=785432.24..800431.37 rows=1499913 width=8) (actual time=17024.647..17369.922 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.04..711933.56 rows=14699735 width=8) (actual time=492.091..11309.273 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440780.16 rows=14699735 width=8) (actual time=12.932..4935.553 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.13..50283.13 rows=1499913 width=4) (actual time=476.637..476.637 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.13 rows=1499913 width=4) (actual time=0.005..219.479 rows=1500000 loops=1)
 Planning time: 0.546 ms
 Execution time: 17566.626 ms
(17 rows)

Time: 17569.652 ms
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   | T_INS | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    31 |   37500000 |     0 |     0 |     0 |   488686 |   423524 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    38 | 1919553664 |     0 |     0 |     0 | 46918537 |  4251253 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |    51 |       1025 |     0 |     0 |     0 |        5 |   102771 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    17 |  210000000 |     0 |     0 |     0 |  4842053 | 17593257 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |    10 |   16000000 |     0 |     0 |     0 |   111254 |   408942 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    22 |  144000000 |     0 |     0 |     0 |  3095092 |    39812 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25656 |     128240 |     0 |     0 |     0 |        4 |    25685 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    21 |    1700000 |     0 |     0 |     0 |    19616 |   183388 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+-------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      110 |       110 |      110 |     58 |      302 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      110 |       110 |      110 |     96 |      394 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |       12 | 127856640 |        0 |    328 |      104 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |        4 |  42618880 |        0 |    110 |       34 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |   102734 |    102734 |   102734 |     10 |   102759 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |       20 |  50662400 |        0 |     45 |      155 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 13793858 |  13793858 | 13793858 |  41196 | 41415679 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |       84 |   8000080 |  8000080 |   5475 |    16648 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |        0 |         0 |        0 |      0 |        0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |    25696 |    102604 |   102604 |   4403 |    73064 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       40 |        40 |       40 |      6 |       49 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 |   102724 |    102724 |   102724 |    294 |   205788 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |       28 |    645120 |        0 |      6 |       46 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
