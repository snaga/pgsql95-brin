                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2556438.67..2556438.70 rows=10 width=20)
   ->  Sort  (cost=2556438.67..2564490.26 rows=3220635 width=20)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         ->  HashAggregate  (cost=2454635.56..2486841.91 rows=3220635 width=20)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=773778.05..2406326.04 rows=3220635 width=20)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Bitmap Heap Scan on lineitem  (cost=255237.24..1732133.12 rows=32918870 width=12)
                           Recheck Cond: (l_shipdate > '1995-03-03'::date)
                           ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..247007.52 rows=32918870 width=0)
                                 Index Cond: (l_shipdate > '1995-03-03'::date)
                     ->  Hash  (cost=500196.43..500196.43 rows=1467550 width=12)
                           ->  Hash Join  (cost=114165.44..500196.43 rows=1467550 width=12)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=56345.88..400452.72 rows=7266307 width=16)
                                       Recheck Cond: (o_orderdate < '1995-03-03'::date)
                                       ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..54529.30 rows=7266307 width=0)
                                             Index Cond: (o_orderdate < '1995-03-03'::date)
                                 ->  Hash  (cost=54032.91..54032.91 rows=302932 width=4)
                                       ->  Seq Scan on customer  (cost=0.00..54032.91 rows=302932 width=4)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
(21 rows)

+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ  | T_INS | T_UPD | T_DEL |  B_READ  | B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |     1 |   1500000 |     0 |     0 |     0 |    65284 |      0 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    13 | 719832624 |     0 |     0 |     0 | 12813832 |   1088 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |     6 |       125 |     0 |     0 |     0 |        3 | 102587 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     2 |  30000000 |     0 |     0 |     0 |   536524 |     32 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     0 |         0 |     0 |     0 |     0 |    70627 | 124493 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     7 |  48000000 |     0 |     0 |     0 |  1045210 |  38662 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25646 |    128200 |     0 |     0 |     0 |        2 |  25659 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |     1 |    100000 |     0 |     0 |     0 |     6540 | 144004 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      0 |       0 |       0 |      1 |      4 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 | 102584 |  102584 |  102584 |      2 | 102587 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     24 | 8000020 | 8000020 |   5469 |  16464 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |      0 |       0 |       0 |      0 |      0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |  25656 |  102564 |  102564 |   4397 |  72940 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     20 |      20 |      20 |      2 |     23 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102584 |  102584 |  102584 |    276 | 205501 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |     20 |  460800 |       0 |      3 |     25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
SET
Timing is on.
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2556438.67..2556438.70 rows=10 width=20) (actual time=78645.113..78645.116 rows=10 loops=1)
   ->  Sort  (cost=2556438.67..2564490.26 rows=3220635 width=20) (actual time=78645.109..78645.111 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2454635.56..2486841.91 rows=3220635 width=20) (actual time=78590.978..78623.941 rows=113554 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=773778.05..2406326.04 rows=3220635 width=20) (actual time=19443.689..78405.796 rows=298969 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Bitmap Heap Scan on lineitem  (cost=255237.24..1732133.12 rows=32918870 width=12) (actual time=75.803..55577.384 rows=32634258 loops=1)
                           Recheck Cond: (l_shipdate > '1995-03-03'::date)
                           Rows Removed by Index Recheck: 27351794
                           Heap Blocks: lossy=1065410
                           ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..247007.52 rows=32918870 width=0) (actual time=75.334..75.334 rows=10654720 loops=1)
                                 Index Cond: (l_shipdate > '1995-03-03'::date)
                     ->  Hash  (cost=500196.43..500196.43 rows=1467550 width=12) (actual time=19353.472..19353.472 rows=1443407 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 78406kB
                           ->  Hash Join  (cost=114165.44..500196.43 rows=1467550 width=12) (actual time=2863.645..19023.118 rows=1443407 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=56345.88..400452.72 rows=7266307 width=16) (actual time=15.291..14503.826 rows=7214283 loops=1)
                                       Recheck Cond: (o_orderdate < '1995-03-03'::date)
                                       Rows Removed by Index Recheck: 7785717
                                       Heap Blocks: lossy=253278
                                       ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..54529.30 rows=7266307 width=0) (actual time=15.184..15.184 rows=2533120 loops=1)
                                             Index Cond: (o_orderdate < '1995-03-03'::date)
                                 ->  Hash  (cost=54032.91..54032.91 rows=302932 width=4) (actual time=2847.423..2847.423 rows=299496 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14626kB
                                       ->  Seq Scan on customer  (cost=0.00..54032.91 rows=302932 width=4) (actual time=0.008..2787.864 rows=299496 loops=1)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
                                             Rows Removed by Filter: 1200504
 Planning time: 0.849 ms
 Execution time: 78678.049 ms
(31 rows)

Time: 78718.712 ms
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ  | T_INS | T_UPD | T_DEL |  B_READ  | B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |     3 |   3000000 |     0 |     0 |     0 |   100568 |      8 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    13 | 719832624 |     0 |     0 |     0 | 13879242 |   1092 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |     6 |       125 |     0 |     0 |     0 |        3 | 102587 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     2 |  30000000 |     0 |     0 |     0 |   789802 |     36 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     0 |         0 |     0 |     0 |     0 |    70627 | 124493 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     7 |  48000000 |     0 |     0 |     0 |  1045210 |  38662 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25646 |    128200 |     0 |     0 |     0 |        2 |  25659 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |     1 |    100000 |     0 |     0 |     0 |     6540 | 144004 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ  |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      8 |        8 |       8 |      6 |     20 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      4 |        4 |       4 |      8 |     15 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |      1 | 10654720 |       0 |     29 |      7 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 | 102584 |   102584 |  102584 |      2 | 102587 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |      1 |  2533120 |       0 |      8 |      2 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |      4 |        4 |       4 |      6 |      8 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     24 |  8000020 | 8000020 |   5469 |  16464 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |  25656 |   102564 |  102564 |   4397 |  72940 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     20 |       20 |      20 |      2 |     23 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102584 |   102584 |  102584 |    276 | 205501 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |     20 |   460800 |       0 |      3 |     25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
SET
Timing is on.
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2556438.67..2556438.70 rows=10 width=20) (actual time=78204.659..78204.662 rows=10 loops=1)
   ->  Sort  (cost=2556438.67..2564490.26 rows=3220635 width=20) (actual time=78204.655..78204.657 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2454635.56..2486841.91 rows=3220635 width=20) (actual time=78160.924..78192.062 rows=113554 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=773778.05..2406326.04 rows=3220635 width=20) (actual time=19580.410..77974.596 rows=298969 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Bitmap Heap Scan on lineitem  (cost=255237.24..1732133.12 rows=32918870 width=12) (actual time=83.070..55023.179 rows=32634258 loops=1)
                           Recheck Cond: (l_shipdate > '1995-03-03'::date)
                           Rows Removed by Index Recheck: 27351794
                           Heap Blocks: lossy=1065410
                           ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..247007.52 rows=32918870 width=0) (actual time=82.610..82.610 rows=10654720 loops=1)
                                 Index Cond: (l_shipdate > '1995-03-03'::date)
                     ->  Hash  (cost=500196.43..500196.43 rows=1467550 width=12) (actual time=19467.820..19467.820 rows=1443407 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 78406kB
                           ->  Hash Join  (cost=114165.44..500196.43 rows=1467550 width=12) (actual time=2850.646..19142.494 rows=1443407 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=56345.88..400452.72 rows=7266307 width=16) (actual time=39.848..14655.140 rows=7214283 loops=1)
                                       Recheck Cond: (o_orderdate < '1995-03-03'::date)
                                       Rows Removed by Index Recheck: 7785717
                                       Heap Blocks: lossy=253278
                                       ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..54529.30 rows=7266307 width=0) (actual time=39.742..39.742 rows=2533120 loops=1)
                                             Index Cond: (o_orderdate < '1995-03-03'::date)
                                 ->  Hash  (cost=54032.91..54032.91 rows=302932 width=4) (actual time=2809.873..2809.873 rows=299496 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14626kB
                                       ->  Seq Scan on customer  (cost=0.00..54032.91 rows=302932 width=4) (actual time=0.007..2751.686 rows=299496 loops=1)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
                                             Rows Removed by Filter: 1200504
 Planning time: 153.812 ms
 Execution time: 78211.863 ms
(31 rows)

Time: 78433.829 ms
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ  | T_INS | T_UPD | T_DEL |  B_READ  | B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |     4 |   4500000 |     0 |     0 |     0 |   135852 |     12 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    13 | 719832624 |     0 |     0 |     0 | 14944652 |   1094 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |     6 |       125 |     0 |     0 |     0 |        3 | 102587 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     2 |  30000000 |     0 |     0 |     0 |  1043079 |     39 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     0 |         0 |     0 |     0 |     0 |    70627 | 124493 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     7 |  48000000 |     0 |     0 |     0 |  1045210 |  38662 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25646 |    128200 |     0 |     0 |     0 |        2 |  25659 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |     1 |    100000 |     0 |     0 |     0 |     6540 | 144004 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ  |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     12 |       12 |      12 |     12 |     27 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      6 |        6 |       6 |     16 |     16 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |      2 | 21309440 |       0 |     56 |     16 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 | 102584 |   102584 |  102584 |      2 | 102587 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |      2 |  5066240 |       0 |     14 |      6 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |      6 |        6 |       6 |     12 |      9 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     24 |  8000020 | 8000020 |   5469 |  16464 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |  25656 |   102564 |  102564 |   4397 |  72940 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     20 |       20 |      20 |      2 |     23 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102584 |   102584 |  102584 |    276 | 205501 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |     20 |   460800 |       0 |      3 |     25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
SET
Timing is on.
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2556438.67..2556438.70 rows=10 width=20) (actual time=78071.812..78071.815 rows=10 loops=1)
   ->  Sort  (cost=2556438.67..2564490.26 rows=3220635 width=20) (actual time=78071.808..78071.810 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2454635.56..2486841.91 rows=3220635 width=20) (actual time=78027.715..78059.064 rows=113554 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=773778.05..2406326.04 rows=3220635 width=20) (actual time=19346.929..77840.147 rows=298969 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Bitmap Heap Scan on lineitem  (cost=255237.24..1732133.12 rows=32918870 width=12) (actual time=81.690..55069.329 rows=32634258 loops=1)
                           Recheck Cond: (l_shipdate > '1995-03-03'::date)
                           Rows Removed by Index Recheck: 27351794
                           Heap Blocks: lossy=1065410
                           ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..247007.52 rows=32918870 width=0) (actual time=81.230..81.230 rows=10654720 loops=1)
                                 Index Cond: (l_shipdate > '1995-03-03'::date)
                     ->  Hash  (cost=500196.43..500196.43 rows=1467550 width=12) (actual time=19254.372..19254.372 rows=1443407 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 78406kB
                           ->  Hash Join  (cost=114165.44..500196.43 rows=1467550 width=12) (actual time=2802.115..18926.144 rows=1443407 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=56345.88..400452.72 rows=7266307 width=16) (actual time=31.432..14462.372 rows=7214283 loops=1)
                                       Recheck Cond: (o_orderdate < '1995-03-03'::date)
                                       Rows Removed by Index Recheck: 7785717
                                       Heap Blocks: lossy=253278
                                       ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..54529.30 rows=7266307 width=0) (actual time=31.329..31.329 rows=2533120 loops=1)
                                             Index Cond: (o_orderdate < '1995-03-03'::date)
                                 ->  Hash  (cost=54032.91..54032.91 rows=302932 width=4) (actual time=2769.772..2769.772 rows=299496 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14626kB
                                       ->  Seq Scan on customer  (cost=0.00..54032.91 rows=302932 width=4) (actual time=0.006..2711.109 rows=299496 loops=1)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
                                             Rows Removed by Filter: 1200504
 Planning time: 162.273 ms
 Execution time: 78079.191 ms
(31 rows)

Time: 78327.690 ms
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ  | T_INS | T_UPD | T_DEL |  B_READ  | B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |     5 |   6000000 |     0 |     0 |     0 |   171136 |     16 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    13 | 719832624 |     0 |     0 |     0 | 16010062 |   1096 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |     6 |       125 |     0 |     0 |     0 |        3 | 102587 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     2 |  30000000 |     0 |     0 |     0 |  1296356 |     42 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     0 |         0 |     0 |     0 |     0 |    70627 | 124493 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     7 |  48000000 |     0 |     0 |     0 |  1045210 |  38662 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25646 |    128200 |     0 |     0 |     0 |        2 |  25659 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |     1 |    100000 |     0 |     0 |     0 |     6540 | 144004 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ  |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     16 |       16 |      16 |     18 |     34 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      8 |        8 |       8 |     24 |     17 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |      3 | 31964160 |       0 |     83 |     25 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 | 102584 |   102584 |  102584 |      2 | 102587 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |      3 |  7599360 |       0 |     20 |     10 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |      8 |        8 |       8 |     18 |     10 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     24 |  8000020 | 8000020 |   5469 |  16464 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |  25656 |   102564 |  102564 |   4397 |  72940 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     20 |       20 |      20 |      2 |     23 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102584 |   102584 |  102584 |    276 | 205501 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |     20 |   460800 |       0 |      3 |     25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
SET
Timing is on.
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2556438.67..2556438.70 rows=10 width=20) (actual time=78778.806..78778.807 rows=10 loops=1)
   ->  Sort  (cost=2556438.67..2564490.26 rows=3220635 width=20) (actual time=78778.802..78778.802 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2454635.56..2486841.91 rows=3220635 width=20) (actual time=78735.687..78766.057 rows=113554 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=773778.05..2406326.04 rows=3220635 width=20) (actual time=19213.554..78547.940 rows=298969 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Bitmap Heap Scan on lineitem  (cost=255237.24..1732133.12 rows=32918870 width=12) (actual time=81.394..56062.287 rows=32634258 loops=1)
                           Recheck Cond: (l_shipdate > '1995-03-03'::date)
                           Rows Removed by Index Recheck: 27351794
                           Heap Blocks: lossy=1065410
                           ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..247007.52 rows=32918870 width=0) (actual time=80.937..80.937 rows=10654720 loops=1)
                                 Index Cond: (l_shipdate > '1995-03-03'::date)
                     ->  Hash  (cost=500196.43..500196.43 rows=1467550 width=12) (actual time=19119.870..19119.870 rows=1443407 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 78406kB
                           ->  Hash Join  (cost=114165.44..500196.43 rows=1467550 width=12) (actual time=2810.669..18788.499 rows=1443407 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=56345.88..400452.72 rows=7266307 width=16) (actual time=39.783..14327.974 rows=7214283 loops=1)
                                       Recheck Cond: (o_orderdate < '1995-03-03'::date)
                                       Rows Removed by Index Recheck: 7785717
                                       Heap Blocks: lossy=253278
                                       ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..54529.30 rows=7266307 width=0) (actual time=39.677..39.677 rows=2533120 loops=1)
                                             Index Cond: (o_orderdate < '1995-03-03'::date)
                                 ->  Hash  (cost=54032.91..54032.91 rows=302932 width=4) (actual time=2769.959..2769.959 rows=299496 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14626kB
                                       ->  Seq Scan on customer  (cost=0.00..54032.91 rows=302932 width=4) (actual time=0.007..2711.275 rows=299496 loops=1)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
                                             Rows Removed by Filter: 1200504
 Planning time: 169.979 ms
 Execution time: 78786.542 ms
(31 rows)

Time: 79032.398 ms
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ  | T_INS | T_UPD | T_DEL |  B_READ  | B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |     6 |   7500000 |     0 |     0 |     0 |   206420 |     20 |          | 2015-07-16 11:49:02 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    13 | 719832624 |     0 |     0 |     0 | 17075472 |   1098 |          | 2015-07-16 11:50:15 | pg_default |
| 16602 | snaga | public | nation   |       1 |     6 |       125 |     0 |     0 |     0 |        3 | 102587 |          | 2015-07-16 11:50:15 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     2 |  30000000 |     0 |     0 |     0 |  1549633 |     45 |          | 2015-07-16 11:49:19 | pg_default |
| 16587 | snaga | public | part     |   40627 |     0 |         0 |     0 |     0 |     0 |    70627 | 124493 |          | 2015-07-16 11:48:52 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     7 |  48000000 |     0 |     0 |     0 |  1045210 |  38662 |          | 2015-07-16 11:48:59 | pg_default |
| 16605 | snaga | public | region   |       1 | 25646 |    128200 |     0 |     0 |     0 |        2 |  25659 |          | 2015-07-16 11:50:15 | pg_default |
| 16584 | snaga | public | supplier |    2180 |     1 |    100000 |     0 |     0 |     0 |     6540 | 144004 |          | 2015-07-16 11:48:50 | pg_default |
+-------+-------+--------+----------+---------+-------+-----------+-------+-------+-------+----------+--------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ  |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     20 |       20 |      20 |     24 |     41 |        | pg_default |
| 16670 | snaga | public | customer | i_c_nationkey         |      3 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16677 | snaga | public | lineitem | i_l_commitdate        |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |     10 |       10 |      10 |     32 |     18 |        | pg_default |
| 16663 | snaga | public | lineitem | i_l_shipdate          |     29 |      4 | 42618880 |       0 |    110 |     34 |        | pg_default |
| 16664 | snaga | public | lineitem | i_l_suppkey_partkey   |     37 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16665 | snaga | public | lineitem | i_l_partkey           |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16666 | snaga | public | lineitem | i_l_suppkey           |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16667 | snaga | public | lineitem | i_l_receiptdate       |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16668 | snaga | public | lineitem | i_l_orderkey          |     29 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16669 | snaga | public | lineitem | i_l_orderkey_quantity |     37 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 | 102584 |   102584 |  102584 |      2 | 102587 |        | pg_default |
| 16676 | snaga | public | nation   | i_n_regionkey         |      3 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16671 | snaga | public | orders   | i_o_orderdate         |      8 |      4 | 10132480 |       0 |     26 |     14 |        | pg_default |
| 16672 | snaga | public | orders   | i_o_custkey           |      8 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |     10 |       10 |      10 |     24 |     11 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     24 |  8000020 | 8000020 |   5469 |  16464 |        | pg_default |
| 16674 | snaga | public | partsupp | i_ps_partkey          |      6 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16675 | snaga | public | partsupp | i_ps_suppkey          |      6 |      0 |        0 |       0 |      0 |      0 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |  25656 |   102564 |  102564 |   4397 |  72940 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     20 |       20 |      20 |      2 |     23 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102584 |   102584 |  102584 |    276 | 205501 |        | pg_default |
| 16673 | snaga | public | supplier | i_s_nationkey         |      3 |     20 |   460800 |       0 |      3 |     25 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+----------+---------+--------+--------+--------+------------+
