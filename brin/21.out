                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=276473.72..276473.73 rows=1 width=26)
   ->  Sort  (cost=276473.72..276473.73 rows=1 width=26)
         Sort Key: (count(*)) DESC, supplier.s_name
         ->  HashAggregate  (cost=276473.70..276473.71 rows=1 width=26)
               Group Key: supplier.s_name
               ->  Nested Loop Anti Join  (cost=253.78..276473.70 rows=1 width=26)
                     ->  Nested Loop Semi Join  (cost=253.35..276472.05 rows=1 width=34)
                           Join Filter: (orders.o_orderkey = l2.l_orderkey)
                           ->  Nested Loop  (cost=252.92..231367.25 rows=38682 width=38)
                                 ->  Hash Join  (cost=252.49..190151.53 rows=79818 width=34)
                                       Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                       ->  Seq Scan on lineitem l1  (cost=0.00..181599.24 rows=2000433 width=8)
                                             Filter: (l_receiptdate > l_commitdate)
                                       ->  Hash  (cost=247.49..247.49 rows=400 width=30)
                                             ->  Nested Loop  (cost=15.10..247.49 rows=400 width=30)
                                                   ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4)
                                                         Filter: (n_name = 'JORDAN'::bpchar)
                                                   ->  Bitmap Heap Scan on supplier  (cost=15.10..242.18 rows=400 width=34)
                                                         Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                         ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..15.00 rows=400 width=0)
                                                               Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using pk_orders on orders  (cost=0.43..0.51 rows=1 width=4)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                           ->  Index Scan using pk_lineitem on lineitem l2  (cost=0.43..0.98 rows=15 width=8)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: (l_suppkey <> l1.l_suppkey)
                     ->  Index Scan using pk_lineitem on lineitem l3  (cost=0.43..1.02 rows=5 width=8)
                           Index Cond: (l_orderkey = l1.l_orderkey)
                           Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
(30 rows)

+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  | T_INS | T_UPD | T_DEL | B_READ |   B_HIT    | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   53 |   6450000 |     0 |     0 |     0 |   3531 |     393296 |          | 2015-07-16 02:38:29 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   94 | 442031867 |     0 |     0 |     0 | 106583 | 1541389461 |          | 2015-07-16 02:38:30 | pg_default |
| 16404 | snaga | public | nation   |      1 |   98 |      1975 |     0 |     0 |     0 |      1 |      22206 |          | 2015-07-16 02:38:30 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   46 |  57000000 |     0 |     0 |     0 |  25326 |    4879974 |          | 2015-07-16 02:38:30 | pg_default |
| 16389 | snaga | public | part     |   4064 |   60 |   8917122 |     0 |     0 |     0 |   8128 |     214470 |          | 2015-07-16 02:38:29 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |   56 |  36800000 |     0 |     0 |     0 |  17087 |     810649 |          | 2015-07-16 02:38:29 | pg_default |
| 16407 | snaga | public | region   |      1 | 5472 |     27280 |     0 |     0 |     0 |      2 |       5536 |          | 2015-07-16 02:38:30 | pg_default |
| 16386 | snaga | public | supplier |    218 |   61 |    430000 |     0 |     0 |     0 |    218 |      56064 |          | 2015-07-16 02:38:29 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |    T_READ   |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |   96692 |       96692 |   96692 |    414 |  290196 |        | pg_default |
| 16501 | snaga | public | customer | i_c_nationkey         |     3 |      40 |     1433600 |       0 |      0 |      56 |        | pg_default |
| 16508 | snaga | public | lineitem | i_l_commitdate        |     5 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 | 1699332 |     5635708 | 5635708 |  16457 | 5100569 |        | pg_default |
| 16494 | snaga | public | lineitem | i_l_shipdate          |     5 |      32 |    34119680 |       0 |      0 |     160 |        | pg_default |
| 16495 | snaga | public | lineitem | i_l_suppkey_partkey   |     5 |    4559 |  4860250880 |       0 |      0 |   13685 |        | pg_default |
| 16496 | snaga | public | lineitem | i_l_partkey           |     5 |    9775 | 10422496000 |       0 |      0 |   29341 |        | pg_default |
| 16497 | snaga | public | lineitem | i_l_suppkey           |     5 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16498 | snaga | public | lineitem | i_l_receiptdate       |     5 |       8 |     8529920 |       0 |      0 |      40 |        | pg_default |
| 16499 | snaga | public | lineitem | i_l_orderkey          |     5 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16500 | snaga | public | lineitem | i_l_orderkey_quantity |     5 |      12 |    12794880 |       0 |      0 |      60 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   22126 |       22318 |   22318 |      2 |   22199 |        | pg_default |
| 16507 | snaga | public | nation   | i_n_regionkey         |     3 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16502 | snaga | public | orders   | i_o_orderdate         |     3 |      32 |     8110080 |       0 |      0 |      96 |        | pg_default |
| 16503 | snaga | public | orders   | i_o_custkey           |     3 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 3081828 |     3081828 | 3081828 |   4116 | 9258460 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |     248 |     1600240 | 1600240 |    551 |    4631 |        | pg_default |
| 16505 | snaga | public | partsupp | i_ps_partkey          |     3 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16506 | snaga | public | partsupp | i_ps_suppkey          |     3 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |    6724 |       26437 |   26437 |    600 |   19701 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      80 |          80 |      80 |      2 |     108 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 |   42112 |       42112 |   42112 |     30 |   84519 |        | pg_default |
| 16504 | snaga | public | supplier | i_s_nationkey         |     3 |      20 |       51200 |       0 |      0 |      60 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+---------+--------+------------+
SET
Timing is on.
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=276473.72..276473.73 rows=1 width=26) (actual time=1697.548..1697.560 rows=100 loops=1)
   ->  Sort  (cost=276473.72..276473.73 rows=1 width=26) (actual time=1697.547..1697.550 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 32kB
         ->  HashAggregate  (cost=276473.70..276473.71 rows=1 width=26) (actual time=1697.332..1697.382 rows=362 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Anti Join  (cost=253.78..276473.70 rows=1 width=26) (actual time=1.964..1695.407 rows=3454 loops=1)
                     ->  Nested Loop Semi Join  (cost=253.35..276472.05 rows=1 width=34) (actual time=1.737..1592.728 rows=63631 loops=1)
                           Join Filter: (orders.o_orderkey = l2.l_orderkey)
                           ->  Nested Loop  (cost=252.92..231367.25 rows=38682 width=38) (actual time=1.734..1446.642 rows=66086 loops=1)
                                 ->  Hash Join  (cost=252.49..190151.53 rows=79818 width=34) (actual time=1.705..1187.280 rows=137252 loops=1)
                                       Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                       ->  Seq Scan on lineitem l1  (cost=0.00..181599.24 rows=2000433 width=8) (actual time=0.004..930.409 rows=3793296 loops=1)
                                             Filter: (l_receiptdate > l_commitdate)
                                             Rows Removed by Filter: 2207919
                                       ->  Hash  (cost=247.49..247.49 rows=400 width=30) (actual time=1.693..1.693 rows=362 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 31kB
                                             ->  Nested Loop  (cost=15.10..247.49 rows=400 width=30) (actual time=0.052..1.641 rows=362 loops=1)
                                                   ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.004 rows=1 loops=1)
                                                         Filter: (n_name = 'JORDAN'::bpchar)
                                                         Rows Removed by Filter: 24
                                                   ->  Bitmap Heap Scan on supplier  (cost=15.10..242.18 rows=400 width=34) (actual time=0.047..1.599 rows=362 loops=1)
                                                         Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                         Rows Removed by Index Recheck: 9638
                                                         Heap Blocks: lossy=218
                                                         ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..15.00 rows=400 width=0) (actual time=0.039..0.039 rows=2560 loops=1)
                                                               Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using pk_orders on orders  (cost=0.43..0.51 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=137252)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using pk_lineitem on lineitem l2  (cost=0.43..0.98 rows=15 width=8) (actual time=0.002..0.002 rows=1 loops=66086)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: (l_suppkey <> l1.l_suppkey)
                                 Rows Removed by Filter: 0
                     ->  Index Scan using pk_lineitem on lineitem l3  (cost=0.43..1.02 rows=5 width=8) (actual time=0.001..0.001 rows=1 loops=63631)
                           Index Cond: (l_orderkey = l1.l_orderkey)
                           Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                           Rows Removed by Filter: 1
 Planning time: 1.630 ms
 Execution time: 1697.673 ms
(41 rows)

Time: 1700.309 ms
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  | T_INS | T_UPD | T_DEL | B_READ |   B_HIT    | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   53 |   6450000 |     0 |     0 |     0 |   3531 |     393296 |          | 2015-07-16 02:38:29 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   96 | 448033082 |     0 |     0 |     0 | 106583 | 1541627030 |          | 2015-07-16 02:38:30 | pg_default |
| 16404 | snaga | public | nation   |      1 |  100 |      2000 |     0 |     0 |     0 |      1 |      22211 |          | 2015-07-16 02:38:30 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   46 |  57000000 |     0 |     0 |     0 |  25326 |    5017234 |          | 2015-07-16 02:38:30 | pg_default |
| 16389 | snaga | public | part     |   4064 |   60 |   8917122 |     0 |     0 |     0 |   8128 |     214470 |          | 2015-07-16 02:38:29 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |   56 |  36800000 |     0 |     0 |     0 |  17087 |     810649 |          | 2015-07-16 02:38:29 | pg_default |
| 16407 | snaga | public | region   |      1 | 5472 |     27280 |     0 |     0 |     0 |      2 |       5536 |          | 2015-07-16 02:38:30 | pg_default |
| 16386 | snaga | public | supplier |    218 |   61 |    430000 |     0 |     0 |     0 |    218 |      56290 |          | 2015-07-16 02:38:29 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |    T_READ   |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |   96692 |       96692 |   96692 |    414 |  290196 |        | pg_default |
| 16501 | snaga | public | customer | i_c_nationkey         |     3 |      40 |     1433600 |       0 |      0 |      56 |        | pg_default |
| 16508 | snaga | public | lineitem | i_l_commitdate        |     5 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 | 1829073 |     5832349 | 5832349 |  16457 | 5490342 |        | pg_default |
| 16494 | snaga | public | lineitem | i_l_shipdate          |     5 |      32 |    34119680 |       0 |      0 |     160 |        | pg_default |
| 16495 | snaga | public | lineitem | i_l_suppkey_partkey   |     5 |    4559 |  4860250880 |       0 |      0 |   13685 |        | pg_default |
| 16496 | snaga | public | lineitem | i_l_partkey           |     5 |    9775 | 10422496000 |       0 |      0 |   29341 |        | pg_default |
| 16497 | snaga | public | lineitem | i_l_suppkey           |     5 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16498 | snaga | public | lineitem | i_l_receiptdate       |     5 |       8 |     8529920 |       0 |      0 |      40 |        | pg_default |
| 16499 | snaga | public | lineitem | i_l_orderkey          |     5 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16500 | snaga | public | lineitem | i_l_orderkey_quantity |     5 |      12 |    12794880 |       0 |      0 |      60 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   22130 |       22322 |   22322 |      2 |   22205 |        | pg_default |
| 16507 | snaga | public | nation   | i_n_regionkey         |     3 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16502 | snaga | public | orders   | i_o_orderdate         |     3 |      32 |     8110080 |       0 |      0 |      96 |        | pg_default |
| 16503 | snaga | public | orders   | i_o_custkey           |     3 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 3219088 |     3219088 | 3219088 |   4116 | 9670984 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |     248 |     1600240 | 1600240 |    551 |    4631 |        | pg_default |
| 16505 | snaga | public | partsupp | i_ps_partkey          |     3 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16506 | snaga | public | partsupp | i_ps_suppkey          |     3 |       0 |           0 |       0 |      0 |       0 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |    6724 |       26437 |   26437 |    600 |   19701 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      80 |          80 |      80 |      2 |     108 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 |   42120 |       42120 |   42120 |     30 |   84537 |        | pg_default |
| 16504 | snaga | public | supplier | i_s_nationkey         |     3 |      21 |       53760 |       0 |      0 |      63 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+---------+--------+------------+
SET
Timing is on.
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=276473.72..276473.73 rows=1 width=26) (actual time=1693.667..1693.678 rows=100 loops=1)
   ->  Sort  (cost=276473.72..276473.73 rows=1 width=26) (actual time=1693.666..1693.671 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 32kB
         ->  HashAggregate  (cost=276473.70..276473.71 rows=1 width=26) (actual time=1693.451..1693.514 rows=362 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Anti Join  (cost=253.78..276473.70 rows=1 width=26) (actual time=1.966..1691.560 rows=3454 loops=1)
                     ->  Nested Loop Semi Join  (cost=253.35..276472.05 rows=1 width=34) (actual time=1.738..1589.126 rows=63631 loops=1)
                           Join Filter: (orders.o_orderkey = l2.l_orderkey)
                           ->  Nested Loop  (cost=252.92..231367.25 rows=38682 width=38) (actual time=1.734..1444.064 rows=66086 loops=1)
                                 ->  Hash Join  (cost=252.49..190151.53 rows=79818 width=34) (actual time=1.704..1185.526 rows=137252 loops=1)
                                       Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                       ->  Seq Scan on lineitem l1  (cost=0.00..181599.24 rows=2000433 width=8) (actual time=0.005..926.974 rows=3793296 loops=1)
                                             Filter: (l_receiptdate > l_commitdate)
                                             Rows Removed by Filter: 2207919
                                       ->  Hash  (cost=247.49..247.49 rows=400 width=30) (actual time=1.693..1.693 rows=362 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 31kB
                                             ->  Nested Loop  (cost=15.10..247.49 rows=400 width=30) (actual time=0.050..1.630 rows=362 loops=1)
                                                   ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.005 rows=1 loops=1)
                                                         Filter: (n_name = 'JORDAN'::bpchar)
                                                         Rows Removed by Filter: 24
                                                   ->  Bitmap Heap Scan on supplier  (cost=15.10..242.18 rows=400 width=34) (actual time=0.046..1.592 rows=362 loops=1)
                                                         Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                         Rows Removed by Index Recheck: 9638
                                                         Heap Blocks: lossy=218
                                                         ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..15.00 rows=400 width=0) (actual time=0.038..0.038 rows=2560 loops=1)
                                                               Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using pk_orders on orders  (cost=0.43..0.51 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=137252)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using pk_lineitem on lineitem l2  (cost=0.43..0.98 rows=15 width=8) (actual time=0.002..0.002 rows=1 loops=66086)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: (l_suppkey <> l1.l_suppkey)
                                 Rows Removed by Filter: 0
                     ->  Index Scan using pk_lineitem on lineitem l3  (cost=0.43..1.02 rows=5 width=8) (actual time=0.001..0.001 rows=1 loops=63631)
                           Index Cond: (l_orderkey = l1.l_orderkey)
                           Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                           Rows Removed by Filter: 1
 Planning time: 1.622 ms
 Execution time: 1693.788 ms
(41 rows)

Time: 1696.413 ms
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  | T_INS | T_UPD | T_DEL | B_READ |   B_HIT    | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   53 |   6450000 |     0 |     0 |     0 |   3531 |     393296 |          | 2015-07-16 02:38:29 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   97 | 454034297 |     0 |     0 |     0 | 106583 | 1541864587 |          | 2015-07-16 02:38:30 | pg_default |
| 16404 | snaga | public | nation   |      1 |  101 |      2025 |     0 |     0 |     0 |      1 |      22214 |          | 2015-07-16 02:38:30 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   46 |  57000000 |     0 |     0 |     0 |  25326 |    5154490 |          | 2015-07-16 02:38:30 | pg_default |
| 16389 | snaga | public | part     |   4064 |   60 |   8917122 |     0 |     0 |     0 |   8128 |     214470 |          | 2015-07-16 02:38:29 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |   56 |  36800000 |     0 |     0 |     0 |  17087 |     810649 |          | 2015-07-16 02:38:29 | pg_default |
| 16407 | snaga | public | region   |      1 | 5472 |     27280 |     0 |     0 |     0 |      2 |       5536 |          | 2015-07-16 02:38:30 | pg_default |
| 16386 | snaga | public | supplier |    218 |   61 |    430000 |     0 |     0 |     0 |    218 |      56512 |          | 2015-07-16 02:38:29 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |    T_READ   |  T_FTCH | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |   96692 |       96692 |   96692 |    414 |   290196 |        | pg_default |
| 16501 | snaga | public | customer | i_c_nationkey         |     3 |      40 |     1433600 |       0 |      0 |       56 |        | pg_default |
| 16508 | snaga | public | lineitem | i_l_commitdate        |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 | 1958802 |     6028978 | 6028978 |  16457 |  5880078 |        | pg_default |
| 16494 | snaga | public | lineitem | i_l_shipdate          |     5 |      32 |    34119680 |       0 |      0 |      160 |        | pg_default |
| 16495 | snaga | public | lineitem | i_l_suppkey_partkey   |     5 |    4559 |  4860250880 |       0 |      0 |    13685 |        | pg_default |
| 16496 | snaga | public | lineitem | i_l_partkey           |     5 |    9775 | 10422496000 |       0 |      0 |    29341 |        | pg_default |
| 16497 | snaga | public | lineitem | i_l_suppkey           |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16498 | snaga | public | lineitem | i_l_receiptdate       |     5 |       8 |     8529920 |       0 |      0 |       40 |        | pg_default |
| 16499 | snaga | public | lineitem | i_l_orderkey          |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16500 | snaga | public | lineitem | i_l_orderkey_quantity |     5 |      12 |    12794880 |       0 |      0 |       60 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   22132 |       22324 |   22324 |      2 |    22208 |        | pg_default |
| 16507 | snaga | public | nation   | i_n_regionkey         |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16502 | snaga | public | orders   | i_o_orderdate         |     3 |      32 |     8110080 |       0 |      0 |       96 |        | pg_default |
| 16503 | snaga | public | orders   | i_o_custkey           |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 3356344 |     3356344 | 3356344 |   4116 | 10083495 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |     248 |     1600240 | 1600240 |    551 |     4631 |        | pg_default |
| 16505 | snaga | public | partsupp | i_ps_partkey          |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16506 | snaga | public | partsupp | i_ps_suppkey          |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |    6724 |       26437 |   26437 |    600 |    19701 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      80 |          80 |      80 |      2 |      108 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 |   42124 |       42124 |   42124 |     30 |    84546 |        | pg_default |
| 16504 | snaga | public | supplier | i_s_nationkey         |     3 |      22 |       56320 |       0 |      0 |       66 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=276473.72..276473.73 rows=1 width=26) (actual time=1697.794..1697.803 rows=100 loops=1)
   ->  Sort  (cost=276473.72..276473.73 rows=1 width=26) (actual time=1697.793..1697.797 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 32kB
         ->  HashAggregate  (cost=276473.70..276473.71 rows=1 width=26) (actual time=1697.578..1697.622 rows=362 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Anti Join  (cost=253.78..276473.70 rows=1 width=26) (actual time=1.974..1695.713 rows=3454 loops=1)
                     ->  Nested Loop Semi Join  (cost=253.35..276472.05 rows=1 width=34) (actual time=1.744..1593.320 rows=63631 loops=1)
                           Join Filter: (orders.o_orderkey = l2.l_orderkey)
                           ->  Nested Loop  (cost=252.92..231367.25 rows=38682 width=38) (actual time=1.741..1447.196 rows=66086 loops=1)
                                 ->  Hash Join  (cost=252.49..190151.53 rows=79818 width=34) (actual time=1.712..1187.323 rows=137252 loops=1)
                                       Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                       ->  Seq Scan on lineitem l1  (cost=0.00..181599.24 rows=2000433 width=8) (actual time=0.004..928.908 rows=3793296 loops=1)
                                             Filter: (l_receiptdate > l_commitdate)
                                             Rows Removed by Filter: 2207919
                                       ->  Hash  (cost=247.49..247.49 rows=400 width=30) (actual time=1.700..1.700 rows=362 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 31kB
                                             ->  Nested Loop  (cost=15.10..247.49 rows=400 width=30) (actual time=0.052..1.641 rows=362 loops=1)
                                                   ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.004 rows=1 loops=1)
                                                         Filter: (n_name = 'JORDAN'::bpchar)
                                                         Rows Removed by Filter: 24
                                                   ->  Bitmap Heap Scan on supplier  (cost=15.10..242.18 rows=400 width=34) (actual time=0.048..1.601 rows=362 loops=1)
                                                         Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                         Rows Removed by Index Recheck: 9638
                                                         Heap Blocks: lossy=218
                                                         ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..15.00 rows=400 width=0) (actual time=0.039..0.039 rows=2560 loops=1)
                                                               Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using pk_orders on orders  (cost=0.43..0.51 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=137252)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using pk_lineitem on lineitem l2  (cost=0.43..0.98 rows=15 width=8) (actual time=0.002..0.002 rows=1 loops=66086)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: (l_suppkey <> l1.l_suppkey)
                                 Rows Removed by Filter: 0
                     ->  Index Scan using pk_lineitem on lineitem l3  (cost=0.43..1.02 rows=5 width=8) (actual time=0.001..0.001 rows=1 loops=63631)
                           Index Cond: (l_orderkey = l1.l_orderkey)
                           Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                           Rows Removed by Filter: 1
 Planning time: 1.623 ms
 Execution time: 1697.919 ms
(41 rows)

Time: 1700.556 ms
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  | T_INS | T_UPD | T_DEL | B_READ |   B_HIT    | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   53 |   6450000 |     0 |     0 |     0 |   3531 |     393296 |          | 2015-07-16 02:38:29 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   98 | 460035512 |     0 |     0 |     0 | 106583 | 1542102144 |          | 2015-07-16 02:38:30 | pg_default |
| 16404 | snaga | public | nation   |      1 |  102 |      2050 |     0 |     0 |     0 |      1 |      22217 |          | 2015-07-16 02:38:30 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   46 |  57000000 |     0 |     0 |     0 |  25326 |    5291746 |          | 2015-07-16 02:38:30 | pg_default |
| 16389 | snaga | public | part     |   4064 |   60 |   8917122 |     0 |     0 |     0 |   8128 |     214470 |          | 2015-07-16 02:38:29 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |   56 |  36800000 |     0 |     0 |     0 |  17087 |     810649 |          | 2015-07-16 02:38:29 | pg_default |
| 16407 | snaga | public | region   |      1 | 5472 |     27280 |     0 |     0 |     0 |      2 |       5536 |          | 2015-07-16 02:38:30 | pg_default |
| 16386 | snaga | public | supplier |    218 |   61 |    430000 |     0 |     0 |     0 |    218 |      56734 |          | 2015-07-16 02:38:29 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |    T_READ   |  T_FTCH | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |   96692 |       96692 |   96692 |    414 |   290196 |        | pg_default |
| 16501 | snaga | public | customer | i_c_nationkey         |     3 |      40 |     1433600 |       0 |      0 |       56 |        | pg_default |
| 16508 | snaga | public | lineitem | i_l_commitdate        |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 | 2088531 |     6225607 | 6225607 |  16457 |  6269814 |        | pg_default |
| 16494 | snaga | public | lineitem | i_l_shipdate          |     5 |      32 |    34119680 |       0 |      0 |      160 |        | pg_default |
| 16495 | snaga | public | lineitem | i_l_suppkey_partkey   |     5 |    4559 |  4860250880 |       0 |      0 |    13685 |        | pg_default |
| 16496 | snaga | public | lineitem | i_l_partkey           |     5 |    9775 | 10422496000 |       0 |      0 |    29341 |        | pg_default |
| 16497 | snaga | public | lineitem | i_l_suppkey           |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16498 | snaga | public | lineitem | i_l_receiptdate       |     5 |       8 |     8529920 |       0 |      0 |       40 |        | pg_default |
| 16499 | snaga | public | lineitem | i_l_orderkey          |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16500 | snaga | public | lineitem | i_l_orderkey_quantity |     5 |      12 |    12794880 |       0 |      0 |       60 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   22134 |       22326 |   22326 |      2 |    22211 |        | pg_default |
| 16507 | snaga | public | nation   | i_n_regionkey         |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16502 | snaga | public | orders   | i_o_orderdate         |     3 |      32 |     8110080 |       0 |      0 |       96 |        | pg_default |
| 16503 | snaga | public | orders   | i_o_custkey           |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 3493600 |     3493600 | 3493600 |   4116 | 10496006 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |     248 |     1600240 | 1600240 |    551 |     4631 |        | pg_default |
| 16505 | snaga | public | partsupp | i_ps_partkey          |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16506 | snaga | public | partsupp | i_ps_suppkey          |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |    6724 |       26437 |   26437 |    600 |    19701 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      80 |          80 |      80 |      2 |      108 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 |   42128 |       42128 |   42128 |     30 |    84555 |        | pg_default |
| 16504 | snaga | public | supplier | i_s_nationkey         |     3 |      23 |       58880 |       0 |      0 |       69 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=276473.72..276473.73 rows=1 width=26) (actual time=1691.356..1691.367 rows=100 loops=1)
   ->  Sort  (cost=276473.72..276473.73 rows=1 width=26) (actual time=1691.355..1691.359 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 32kB
         ->  HashAggregate  (cost=276473.70..276473.71 rows=1 width=26) (actual time=1691.142..1691.199 rows=362 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Anti Join  (cost=253.78..276473.70 rows=1 width=26) (actual time=1.965..1689.173 rows=3454 loops=1)
                     ->  Nested Loop Semi Join  (cost=253.35..276472.05 rows=1 width=34) (actual time=1.739..1586.901 rows=63631 loops=1)
                           Join Filter: (orders.o_orderkey = l2.l_orderkey)
                           ->  Nested Loop  (cost=252.92..231367.25 rows=38682 width=38) (actual time=1.736..1441.804 rows=66086 loops=1)
                                 ->  Hash Join  (cost=252.49..190151.53 rows=79818 width=34) (actual time=1.707..1183.691 rows=137252 loops=1)
                                       Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                       ->  Seq Scan on lineitem l1  (cost=0.00..181599.24 rows=2000433 width=8) (actual time=0.004..925.553 rows=3793296 loops=1)
                                             Filter: (l_receiptdate > l_commitdate)
                                             Rows Removed by Filter: 2207919
                                       ->  Hash  (cost=247.49..247.49 rows=400 width=30) (actual time=1.696..1.696 rows=362 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 31kB
                                             ->  Nested Loop  (cost=15.10..247.49 rows=400 width=30) (actual time=0.055..1.635 rows=362 loops=1)
                                                   ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.005 rows=1 loops=1)
                                                         Filter: (n_name = 'JORDAN'::bpchar)
                                                         Rows Removed by Filter: 24
                                                   ->  Bitmap Heap Scan on supplier  (cost=15.10..242.18 rows=400 width=34) (actual time=0.050..1.593 rows=362 loops=1)
                                                         Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                         Rows Removed by Index Recheck: 9638
                                                         Heap Blocks: lossy=218
                                                         ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..15.00 rows=400 width=0) (actual time=0.041..0.041 rows=2560 loops=1)
                                                               Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using pk_orders on orders  (cost=0.43..0.51 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=137252)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using pk_lineitem on lineitem l2  (cost=0.43..0.98 rows=15 width=8) (actual time=0.002..0.002 rows=1 loops=66086)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: (l_suppkey <> l1.l_suppkey)
                                 Rows Removed by Filter: 0
                     ->  Index Scan using pk_lineitem on lineitem l3  (cost=0.43..1.02 rows=5 width=8) (actual time=0.001..0.001 rows=1 loops=63631)
                           Index Cond: (l_orderkey = l1.l_orderkey)
                           Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                           Rows Removed by Filter: 1
 Planning time: 1.617 ms
 Execution time: 1691.478 ms
(41 rows)

Time: 1694.128 ms
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  | T_INS | T_UPD | T_DEL | B_READ |   B_HIT    | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   53 |   6450000 |     0 |     0 |     0 |   3531 |     393296 |          | 2015-07-16 02:38:29 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   99 | 466036727 |     0 |     0 |     0 | 106583 | 1542339701 |          | 2015-07-16 02:38:30 | pg_default |
| 16404 | snaga | public | nation   |      1 |  103 |      2075 |     0 |     0 |     0 |      1 |      22220 |          | 2015-07-16 02:38:30 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   46 |  57000000 |     0 |     0 |     0 |  25326 |    5429002 |          | 2015-07-16 02:38:30 | pg_default |
| 16389 | snaga | public | part     |   4064 |   60 |   8917122 |     0 |     0 |     0 |   8128 |     214470 |          | 2015-07-16 02:38:29 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |   56 |  36800000 |     0 |     0 |     0 |  17087 |     810649 |          | 2015-07-16 02:38:29 | pg_default |
| 16407 | snaga | public | region   |      1 | 5472 |     27280 |     0 |     0 |     0 |      2 |       5536 |          | 2015-07-16 02:38:30 | pg_default |
| 16386 | snaga | public | supplier |    218 |   61 |    430000 |     0 |     0 |     0 |    218 |      56956 |          | 2015-07-16 02:38:29 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+-------+-------+-------+--------+------------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |    T_READ   |  T_FTCH | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |   96692 |       96692 |   96692 |    414 |   290196 |        | pg_default |
| 16501 | snaga | public | customer | i_c_nationkey         |     3 |      40 |     1433600 |       0 |      0 |       56 |        | pg_default |
| 16508 | snaga | public | lineitem | i_l_commitdate        |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 | 2218260 |     6422236 | 6422236 |  16457 |  6659550 |        | pg_default |
| 16494 | snaga | public | lineitem | i_l_shipdate          |     5 |      32 |    34119680 |       0 |      0 |      160 |        | pg_default |
| 16495 | snaga | public | lineitem | i_l_suppkey_partkey   |     5 |    4559 |  4860250880 |       0 |      0 |    13685 |        | pg_default |
| 16496 | snaga | public | lineitem | i_l_partkey           |     5 |    9775 | 10422496000 |       0 |      0 |    29341 |        | pg_default |
| 16497 | snaga | public | lineitem | i_l_suppkey           |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16498 | snaga | public | lineitem | i_l_receiptdate       |     5 |       8 |     8529920 |       0 |      0 |       40 |        | pg_default |
| 16499 | snaga | public | lineitem | i_l_orderkey          |     5 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16500 | snaga | public | lineitem | i_l_orderkey_quantity |     5 |      12 |    12794880 |       0 |      0 |       60 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   22136 |       22328 |   22328 |      2 |    22214 |        | pg_default |
| 16507 | snaga | public | nation   | i_n_regionkey         |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16502 | snaga | public | orders   | i_o_orderdate         |     3 |      32 |     8110080 |       0 |      0 |       96 |        | pg_default |
| 16503 | snaga | public | orders   | i_o_custkey           |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 3630856 |     3630856 | 3630856 |   4116 | 10908517 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |     248 |     1600240 | 1600240 |    551 |     4631 |        | pg_default |
| 16505 | snaga | public | partsupp | i_ps_partkey          |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16506 | snaga | public | partsupp | i_ps_suppkey          |     3 |       0 |           0 |       0 |      0 |        0 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |    6724 |       26437 |   26437 |    600 |    19701 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      80 |          80 |      80 |      2 |      108 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 |   42132 |       42132 |   42132 |     30 |    84564 |        | pg_default |
| 16504 | snaga | public | supplier | i_s_nationkey         |     3 |      24 |       61440 |       0 |      0 |       72 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+-------------+---------+--------+----------+--------+------------+
