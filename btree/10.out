                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=227767.33..227767.38 rows=20 width=176)
   ->  Sort  (cost=227767.33..227908.16 rows=56333 width=176)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         ->  HashAggregate  (cost=225705.00..226268.33 rows=56333 width=176)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=34998.42..224296.67 rows=56333 width=176)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=34996.85..223520.53 rows=56333 width=154)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=28090.85..215839.95 rows=56333 width=12)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..181597.21 rows=1490282 width=12)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                 ->  Hash  (cost=27382.10..27382.10 rows=56700 width=8)
                                       ->  Bitmap Heap Scan on orders  (cost=1205.60..27382.10 rows=56700 width=8)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..1191.43 rows=56700 width=0)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=5031.00..5031.00 rows=150000 width=146)
                                 ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=146)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30)
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30)
(22 rows)

+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   13 |   1650000 |  150000 |     0 |     0 |   5016 |  172727 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   20 | 108021870 | 6001215 |     0 |     0 | 211146 | 6442072 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   28 |       575 |      25 |     0 |     0 |      1 |   11057 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2524197 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |      80 |      80 |      80 |      6 |     254 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     630 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      39 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      39 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7534 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548815 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15047 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13850 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      39 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091659 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |      90 |      90 |      90 |      6 |     304 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11032 |   11224 |   11224 |      2 |   11055 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      13 |  915245 |       5 |    632 |    1937 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48576 |  481196 |  481196 |   3943 |  143315 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540874 | 1540874 | 1540874 |   4116 | 4627032 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=227767.33..227767.38 rows=20 width=176) (actual time=1402.721..1402.722 rows=20 loops=1)
   ->  Sort  (cost=227767.33..227908.16 rows=56333 width=176) (actual time=1402.719..1402.719 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=225705.00..226268.33 rows=56333 width=176) (actual time=1378.881..1393.575 rows=37618 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=34998.42..224296.67 rows=56333 width=176) (actual time=138.816..1288.294 rows=113037 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=34996.85..223520.53 rows=56333 width=154) (actual time=138.802..1267.057 rows=113037 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=28090.85..215839.95 rows=56333 width=12) (actual time=61.930..1148.865 rows=113037 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..181597.21 rows=1490282 width=12) (actual time=0.009..904.330 rows=1478870 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 4522345
                                 ->  Hash  (cost=27382.10..27382.10 rows=56700 width=8) (actual time=61.743..61.743 rows=56516 loops=1)
                                       Buckets: 65536  Batches: 1  Memory Usage: 2720kB
                                       ->  Bitmap Heap Scan on orders  (cost=1205.60..27382.10 rows=56700 width=8) (actual time=9.234..54.579 rows=56516 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Heap Blocks: exact=22767
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..1191.43 rows=56700 width=0) (actual time=6.175..6.175 rows=56516 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=5031.00..5031.00 rows=150000 width=146) (actual time=76.209..76.209 rows=150000 loops=1)
                                 Buckets: 262144  Batches: 1  Memory Usage: 28582kB
                                 ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=146) (actual time=0.003..29.043 rows=150000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.008..0.008 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.001..0.002 rows=25 loops=1)
 Planning time: 1.079 ms
 Execution time: 1403.601 ms
(30 rows)

Time: 1406.748 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   15 |   1800000 |  150000 |     0 |     0 |   5016 |  176266 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   22 | 114023085 | 6001215 |     0 |     0 | 211146 | 6548659 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   30 |       600 |      25 |     0 |     0 |      1 |   11062 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2546976 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |      88 |      88 |      88 |      6 |     280 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     632 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      41 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      41 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7536 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548817 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15049 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13852 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      41 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091661 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |      94 |      94 |      94 |      6 |     318 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11036 |   11228 |   11228 |      2 |   11061 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      26 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      14 |  971761 |       5 |    788 |    1940 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48584 |  481204 |  481204 |   3943 |  143341 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540878 | 1540878 | 1540878 |   4116 | 4627046 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=227767.33..227767.38 rows=20 width=176) (actual time=1402.061..1402.062 rows=20 loops=1)
   ->  Sort  (cost=227767.33..227908.16 rows=56333 width=176) (actual time=1402.058..1402.059 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=225705.00..226268.33 rows=56333 width=176) (actual time=1378.682..1392.956 rows=37618 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=34998.42..224296.67 rows=56333 width=176) (actual time=138.302..1288.191 rows=113037 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=34996.85..223520.53 rows=56333 width=154) (actual time=138.289..1266.916 rows=113037 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=28090.85..215839.95 rows=56333 width=12) (actual time=61.483..1148.964 rows=113037 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..181597.21 rows=1490282 width=12) (actual time=0.010..905.216 rows=1478870 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 4522345
                                 ->  Hash  (cost=27382.10..27382.10 rows=56700 width=8) (actual time=61.296..61.296 rows=56516 loops=1)
                                       Buckets: 65536  Batches: 1  Memory Usage: 2720kB
                                       ->  Bitmap Heap Scan on orders  (cost=1205.60..27382.10 rows=56700 width=8) (actual time=8.616..54.211 rows=56516 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Heap Blocks: exact=22767
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..1191.43 rows=56700 width=0) (actual time=5.562..5.562 rows=56516 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=5031.00..5031.00 rows=150000 width=146) (actual time=76.144..76.144 rows=150000 loops=1)
                                 Buckets: 262144  Batches: 1  Memory Usage: 28582kB
                                 ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=146) (actual time=0.003..28.859 rows=150000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.009..0.009 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.004 rows=25 loops=1)
 Planning time: 1.082 ms
 Execution time: 1402.955 ms
(30 rows)

Time: 1406.995 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   16 |   1950000 |  150000 |     0 |     0 |   5016 |  179801 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   23 | 120024300 | 6001215 |     0 |     0 | 211146 | 6655244 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   31 |       625 |      25 |     0 |     0 |      1 |   11065 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2569749 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |      92 |      92 |      92 |      6 |     293 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     633 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      42 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      42 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7537 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548818 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15050 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13853 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      42 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091662 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |      96 |      96 |      96 |      6 |     325 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11038 |   11230 |   11230 |      2 |   11064 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      27 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      15 | 1028277 |       5 |    788 |    2098 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48588 |  481208 |  481208 |   3943 |  143354 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540880 | 1540880 | 1540880 |   4116 | 4627053 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=227767.33..227767.38 rows=20 width=176) (actual time=1404.887..1404.890 rows=20 loops=1)
   ->  Sort  (cost=227767.33..227908.16 rows=56333 width=176) (actual time=1404.886..1404.886 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=225705.00..226268.33 rows=56333 width=176) (actual time=1381.463..1395.758 rows=37618 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=34998.42..224296.67 rows=56333 width=176) (actual time=140.905..1290.989 rows=113037 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=34996.85..223520.53 rows=56333 width=154) (actual time=140.891..1269.573 rows=113037 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=28090.85..215839.95 rows=56333 width=12) (actual time=61.126..1148.265 rows=113037 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..181597.21 rows=1490282 width=12) (actual time=0.009..903.606 rows=1478870 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 4522345
                                 ->  Hash  (cost=27382.10..27382.10 rows=56700 width=8) (actual time=60.938..60.938 rows=56516 loops=1)
                                       Buckets: 65536  Batches: 1  Memory Usage: 2720kB
                                       ->  Bitmap Heap Scan on orders  (cost=1205.60..27382.10 rows=56700 width=8) (actual time=8.879..53.929 rows=56516 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Heap Blocks: exact=22767
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..1191.43 rows=56700 width=0) (actual time=5.812..5.812 rows=56516 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=5031.00..5031.00 rows=150000 width=146) (actual time=79.115..79.115 rows=150000 loops=1)
                                 Buckets: 262144  Batches: 1  Memory Usage: 28582kB
                                 ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=146) (actual time=0.003..29.125 rows=150000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.009..0.009 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.005 rows=25 loops=1)
 Planning time: 1.087 ms
 Execution time: 1405.782 ms
(30 rows)

Time: 1409.847 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   17 |   2100000 |  150000 |     0 |     0 |   5016 |  183336 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   24 | 126025515 | 6001215 |     0 |     0 | 211146 | 6761829 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   32 |       650 |      25 |     0 |     0 |      1 |   11068 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2592522 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |      96 |      96 |      96 |      6 |     306 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     634 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      43 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      43 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7538 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548819 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15051 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13854 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      43 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091663 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |      98 |      98 |      98 |      6 |     332 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11040 |   11232 |   11232 |      2 |   11067 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      28 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      16 | 1084793 |       5 |    788 |    2256 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48592 |  481212 |  481212 |   3943 |  143367 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540882 | 1540882 | 1540882 |   4116 | 4627060 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=227767.33..227767.38 rows=20 width=176) (actual time=1402.487..1402.488 rows=20 loops=1)
   ->  Sort  (cost=227767.33..227908.16 rows=56333 width=176) (actual time=1402.486..1402.486 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=225705.00..226268.33 rows=56333 width=176) (actual time=1379.093..1393.430 rows=37618 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=34998.42..224296.67 rows=56333 width=176) (actual time=138.918..1288.645 rows=113037 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=34996.85..223520.53 rows=56333 width=154) (actual time=138.905..1267.286 rows=113037 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=28090.85..215839.95 rows=56333 width=12) (actual time=61.067..1148.175 rows=113037 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..181597.21 rows=1490282 width=12) (actual time=0.010..904.790 rows=1478870 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 4522345
                                 ->  Hash  (cost=27382.10..27382.10 rows=56700 width=8) (actual time=60.877..60.877 rows=56516 loops=1)
                                       Buckets: 65536  Batches: 1  Memory Usage: 2720kB
                                       ->  Bitmap Heap Scan on orders  (cost=1205.60..27382.10 rows=56700 width=8) (actual time=8.630..53.640 rows=56516 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Heap Blocks: exact=22767
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..1191.43 rows=56700 width=0) (actual time=5.569..5.569 rows=56516 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=5031.00..5031.00 rows=150000 width=146) (actual time=77.180..77.180 rows=150000 loops=1)
                                 Buckets: 262144  Batches: 1  Memory Usage: 28582kB
                                 ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=146) (actual time=0.003..29.161 rows=150000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.009..0.009 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.005 rows=25 loops=1)
 Planning time: 1.075 ms
 Execution time: 1403.389 ms
(30 rows)

Time: 1407.422 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   18 |   2250000 |  150000 |     0 |     0 |   5016 |  186871 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 6868414 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   33 |       675 |      25 |     0 |     0 |      1 |   11071 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2615295 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     100 |     100 |     100 |      6 |     319 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     635 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7539 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548820 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15052 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13855 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091664 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     100 |     100 |     100 |      6 |     339 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11042 |   11234 |   11234 |      2 |   11070 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      29 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2414 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48596 |  481216 |  481216 |   3943 |  143380 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540884 | 1540884 | 1540884 |   4116 | 4627067 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
