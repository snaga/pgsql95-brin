                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2275132.10..2275132.15 rows=20 width=176)
   ->  Sort  (cost=2275132.10..2276517.46 rows=554144 width=176)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         ->  HashAggregate  (cost=2254845.09..2260386.53 rows=554144 width=176)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=349877.23..2240991.49 rows=554144 width=176)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=349875.67..2233370.45 rows=554144 width=154)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=280843.20..2156718.50 rows=554144 width=12)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..1815236.60 rows=14692603 width=12)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                 ->  Hash  (cost=273771.42..273771.42 rows=565742 width=8)
                                       ->  Bitmap Heap Scan on orders  (cost=12007.29..273771.42 rows=565742 width=8)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..11865.85 rows=565742 width=0)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=146)
                                 ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=146)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30)
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30)
(22 rows)

+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    59 |   69000000 |  1500000 |     0 |     0 |   656340 |  1203732 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    58 | 2640193988 | 59986052 |     0 |     0 | 43717765 | 29698331 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25731 |     642675 |       25 |     0 |     0 |        6 |    26067 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    32 |  360000000 | 15000000 |     0 |     0 |  7280100 | 18694719 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    24 |   25309115 |  2000000 |     0 |     0 |   445050 |   507526 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1297020 |  9802839 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    31021 | 10548976 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      216 |       216 |      216 |     53 |      651 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     13 |       43 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     21 |       74 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     23 |       72 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       23 | 136636474 |       12 | 323648 |    49862 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     23 |       72 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90203 |   2693329 |  2693329 |  34751 |   333389 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     57 |      790 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        5 |  45554435 |        0 | 124507 |       73 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638984 | 15440902 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      218 |       218 |      218 |    119 |      848 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      362 |       362 |      362 |     19 |      403 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       46 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       48 |  88362727 |       13 | 107245 |   134406 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      216 |       216 |      216 |     58 |      668 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366195 |  10366195 | 10366195 | 101832 | 31053397 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      154 |   8001326 |  8001326 |   5493 |    16858 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25724 |  24151383 | 24151383 |  48255 |    95005 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   111470 |   8904885 |  8904885 |  20145 |   339045 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       17 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468821 |  10468821 | 10468821 |    982 | 20994488 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        8 |     31960 |        0 |     26 |      133 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2275132.10..2275132.15 rows=20 width=176) (actual time=50761.164..50761.167 rows=20 loops=1)
   ->  Sort  (cost=2275132.10..2276517.46 rows=554144 width=176) (actual time=50761.161..50761.163 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=2254845.09..2260386.53 rows=554144 width=176) (actual time=50501.857..50653.598 rows=378486 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=349877.23..2240991.49 rows=554144 width=176) (actual time=2305.430..49224.455 rows=1135706 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=349875.67..2233370.45 rows=554144 width=154) (actual time=2305.410..48947.158 rows=1135706 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=280843.20..2156718.50 rows=554144 width=12) (actual time=1494.683..47620.241 rows=1135706 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..1815236.60 rows=14692603 width=12) (actual time=10.383..43926.739 rows=14808183 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 45177869
                                 ->  Hash  (cost=273771.42..273771.42 rows=565742 width=8) (actual time=1451.037..1451.037 rows=567767 loops=1)
                                       Buckets: 1048576  Batches: 1  Memory Usage: 30371kB
                                       ->  Bitmap Heap Scan on orders  (cost=12007.29..273771.42 rows=565742 width=8) (actual time=210.054..1330.501 rows=567767 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Heap Blocks: exact=227501
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..11865.85 rows=565742 width=0) (actual time=158.600..158.600 rows=567767 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=146) (actual time=808.060..808.060 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 281536kB
                                 ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=146) (actual time=0.005..301.106 rows=1500000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.012..0.012 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.003..0.006 rows=25 loops=1)
 Planning time: 1.165 ms
 Execution time: 50769.081 ms
(30 rows)

Time: 50829.891 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    62 |   73500000 |  1500000 |     0 |     0 |   656340 |  1309594 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    60 | 2760166092 | 59986052 |     0 |     0 | 44556569 | 30990351 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25733 |     642725 |       25 |     0 |     0 |        6 |    26073 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    33 |  375000000 | 15000000 |     0 |     0 |  7671570 | 19011543 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    24 |   25309115 |  2000000 |     0 |     0 |   445050 |   507526 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1297020 |  9802839 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    31021 | 10548976 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      226 |       226 |      226 |     53 |      684 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     13 |       46 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     21 |       76 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     23 |       74 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       23 | 136636474 |       12 | 323648 |    49864 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     23 |       74 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90203 |   2693329 |  2693329 |  34751 |   333391 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     57 |      792 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        5 |  45554435 |        0 | 124507 |       75 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638984 | 15440904 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      222 |       222 |      222 |    119 |      866 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      366 |       366 |      366 |     19 |      409 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       48 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       50 |  89498261 |       13 | 108800 |   135964 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      226 |       226 |      226 |     58 |      701 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366199 |  10366199 | 10366199 | 101832 | 31053412 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      154 |   8001326 |  8001326 |   5493 |    16858 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25724 |  24151383 | 24151383 |  48255 |    95005 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   111470 |   8904885 |  8904885 |  20145 |   339045 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       17 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468821 |  10468821 | 10468821 |    982 | 20994488 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        8 |     31960 |        0 |     26 |      133 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2275132.10..2275132.15 rows=20 width=176) (actual time=54518.770..54518.774 rows=20 loops=1)
   ->  Sort  (cost=2275132.10..2276517.46 rows=554144 width=176) (actual time=54518.768..54518.768 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  HashAggregate  (cost=2254845.09..2260386.53 rows=554144 width=176) (actual time=54274.023..54426.412 rows=378486 loops=1)
               Group Key: customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment
               ->  Hash Join  (cost=349877.23..2240991.49 rows=554144 width=176) (actual time=1699.578..53102.850 rows=1135706 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=349875.67..2233370.45 rows=554144 width=154) (actual time=1699.558..52861.377 rows=1135706 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=280843.20..2156718.50 rows=554144 width=12) (actual time=881.531..51569.385 rows=1135706 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..1815236.60 rows=14692603 width=12) (actual time=0.022..48684.116 rows=14808183 loops=1)
                                       Filter: (l_returnflag = 'R'::bpchar)
                                       Rows Removed by Filter: 45177869
                                 ->  Hash  (cost=273771.42..273771.42 rows=565742 width=8) (actual time=880.160..880.160 rows=567767 loops=1)
                                       Buckets: 1048576  Batches: 1  Memory Usage: 30371kB
                                       ->  Bitmap Heap Scan on orders  (cost=12007.29..273771.42 rows=565742 width=8) (actual time=160.162..743.219 rows=567767 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                                             Heap Blocks: exact=227501
                                             ->  Bitmap Index Scan on i_o_orderdate  (cost=0.00..11865.85 rows=565742 width=0) (actual time=106.385..106.385 rows=567767 loops=1)
                                                   Index Cond: ((o_orderdate >= '1994-09-01'::date) AND (o_orderdate < '1994-12-01 00:00:00'::timestamp without time zone))
                           ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=146) (actual time=815.511..815.511 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 281536kB
                                 ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=146) (actual time=0.005..302.470 rows=1500000 loops=1)
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.013..0.013 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.003..0.005 rows=25 loops=1)
 Planning time: 1.203 ms
 Execution time: 54525.363 ms
(30 rows)

Time: 54541.664 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    63 |   75000000 |  1500000 |     0 |     0 |   656340 |  1344882 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 45641566 | 31383683 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25734 |     642750 |       25 |     0 |     0 |        6 |    26076 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    33 |  375000000 | 15000000 |     0 |     0 |  7671570 | 19239050 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    26 |   27309115 |  2000000 |     0 |     0 |   485677 |   507530 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1297020 |  9802839 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    31021 | 10548976 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      230 |       230 |      230 |     53 |      697 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     13 |       47 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     21 |       79 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     23 |       77 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       24 | 137411506 |       12 | 325770 |    49867 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     23 |       77 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90207 |   2693333 |  2693333 |  34758 |   333403 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     57 |      795 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        5 |  45554435 |        0 | 124507 |       78 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638984 | 15440907 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      224 |       224 |      224 |    119 |      877 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      368 |       368 |      368 |     19 |      412 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       49 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108800 |   137520 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      230 |       230 |      230 |     58 |      714 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366201 |  10366201 | 10366201 | 101832 | 31053419 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      158 |   8001330 |  8001330 |   5499 |    16866 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25724 |  24151383 | 24151383 |  48255 |    95005 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   111470 |   8904885 |  8904885 |  20145 |   339045 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       17 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468821 |  10468821 | 10468821 |    982 | 20994488 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        8 |     31960 |        0 |     26 |      133 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1169711.58..1169711.59 rows=1 width=29) (actual time=25195.819..25195.819 rows=1 loops=1)
   ->  Hash Join  (cost=102232.81..1156415.69 rows=759765 width=29) (actual time=1698.267..24953.144 rows=775032 loops=1)
         Hash Cond: (lineitem.l_partkey = part.p_partkey)
         ->  Bitmap Heap Scan on lineitem  (cost=16606.71..1059278.70 rows=782648 width=12) (actual time=274.185..23049.032 rows=775032 loops=1)
               Recheck Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate < '1995-02-01 00:00:00'::timestamp without time zone))
               Heap Blocks: exact=412913
               ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..16411.04 rows=782648 width=0) (actual time=164.527..164.527 rows=775032 loops=1)
                     Index Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate < '1995-02-01 00:00:00'::timestamp without time zone))
         ->  Hash  (cost=60626.60..60626.60 rows=1999960 width=25) (actual time=1421.482..1421.482 rows=2000000 loops=1)
               Buckets: 2097152  Batches: 1  Memory Usage: 131903kB
               ->  Seq Scan on part  (cost=0.00..60626.60 rows=1999960 width=25) (actual time=0.004..957.035 rows=2000000 loops=1)
 Planning time: 0.653 ms
 Execution time: 25197.440 ms
(13 rows)

Time: 25205.895 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    63 |   75000000 |  1500000 |     0 |     0 |   656340 |  1344882 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 45854156 | 31996923 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25734 |     642750 |       25 |     0 |     0 |        6 |    26076 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    33 |  375000000 | 15000000 |     0 |     0 |  7671570 | 19239050 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    28 |   31309115 |  2000000 |     0 |     0 |   526302 |   548163 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1297020 |  9802839 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    31021 | 10548976 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      230 |       230 |      230 |     53 |      697 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     13 |       47 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     21 |       81 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     23 |       79 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       26 | 138961570 |       12 | 327892 |    51991 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     23 |       79 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90211 |   2693337 |  2693337 |  34764 |   333415 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     57 |      797 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        5 |  45554435 |        0 | 124507 |       80 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638984 | 15440909 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      224 |       224 |      224 |    119 |      879 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      368 |       368 |      368 |     19 |      412 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       49 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108800 |   137520 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      230 |       230 |      230 |     58 |      714 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366201 |  10366201 | 10366201 | 101832 | 31053419 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      162 |   8001334 |  8001334 |   5504 |    16875 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25724 |  24151383 | 24151383 |  48255 |    95005 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   111470 |   8904885 |  8904885 |  20145 |   339045 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       17 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468821 |  10468821 | 10468821 |    982 | 20994488 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        8 |     31960 |        0 |     26 |      133 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1169711.58..1169711.59 rows=1 width=29) (actual time=2290.719..2290.719 rows=1 loops=1)
   ->  Hash Join  (cost=102232.81..1156415.69 rows=759765 width=29) (actual time=1037.857..2135.217 rows=775032 loops=1)
         Hash Cond: (lineitem.l_partkey = part.p_partkey)
         ->  Bitmap Heap Scan on lineitem  (cost=16606.71..1059278.70 rows=782648 width=12) (actual time=296.899..1009.262 rows=775032 loops=1)
               Recheck Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate < '1995-02-01 00:00:00'::timestamp without time zone))
               Heap Blocks: exact=412913
               ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..16411.04 rows=782648 width=0) (actual time=177.734..177.734 rows=775032 loops=1)
                     Index Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate < '1995-02-01 00:00:00'::timestamp without time zone))
         ->  Hash  (cost=60626.60..60626.60 rows=1999960 width=25) (actual time=738.292..738.292 rows=2000000 loops=1)
               Buckets: 2097152  Batches: 1  Memory Usage: 131903kB
               ->  Seq Scan on part  (cost=0.00..60626.60 rows=1999960 width=25) (actual time=0.005..336.402 rows=2000000 loops=1)
 Planning time: 0.693 ms
 Execution time: 2292.356 ms
(13 rows)

Time: 2301.433 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    63 |   75000000 |  1500000 |     0 |     0 |   656340 |  1344882 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 45854156 | 32822753 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25734 |     642750 |       25 |     0 |     0 |        6 |    26076 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    33 |  375000000 | 15000000 |     0 |     0 |  7671570 | 19239050 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    30 |   35309115 |  2000000 |     0 |     0 |   526302 |   629421 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1297020 |  9802839 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    31021 | 10548976 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      230 |       230 |      230 |     53 |      697 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     13 |       47 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     21 |       83 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     23 |       81 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       28 | 140511634 |       12 | 327892 |    56237 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     23 |       81 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90215 |   2693341 |  2693341 |  34764 |   333433 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     57 |      799 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        5 |  45554435 |        0 | 124507 |       82 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638984 | 15440911 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      224 |       224 |      224 |    119 |      881 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      368 |       368 |      368 |     19 |      412 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       49 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108800 |   137520 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      230 |       230 |      230 |     58 |      714 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366201 |  10366201 | 10366201 | 101832 | 31053419 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      166 |   8001338 |  8001338 |   5504 |    16889 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25724 |  24151383 | 24151383 |  48255 |    95005 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   111470 |   8904885 |  8904885 |  20145 |   339045 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       17 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468821 |  10468821 | 10468821 |    982 | 20994488 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        8 |     31960 |        0 |     26 |      133 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
