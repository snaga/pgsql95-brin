                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort  (cost=825754.84..825755.34 rows=200 width=8)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   ->  HashAggregate  (cost=825745.19..825747.19 rows=200 width=8)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=788246.90..803246.21 rows=1499932 width=8)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.47..713997.55 rows=14849868 width=8)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440779.40 rows=14849868 width=8)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                     ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=4)
                           ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=4)
(12 rows)

+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    64 |   75000000 |  1500000 |     0 |     0 |   656342 |  1344882 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 52296954 | 36427651 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    40 |  450000000 | 15000000 |     0 |     0 |  8937928 | 19239096 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    41 |   53309115 |  2000000 |     0 |     0 |   587414 |   933974 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      232 |       232 |      232 |     59 |      698 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       47 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     27 |       91 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     29 |       89 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       33 | 150251466 |       12 | 352408 |    58369 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     29 |       89 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154625 |   4702213 |  4702213 |  37559 |   593990 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     63 |      807 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       10 |  91108870 |        0 | 224101 |    24987 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638990 | 15440919 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      236 |       236 |      236 |    152 |      910 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108804 |   137523 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      232 |       232 |      232 |     67 |      718 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366213 |  10366213 | 10366213 | 101855 | 31053439 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      188 |   8001360 |  8001360 |   5510 |    16960 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=825754.84..825755.34 rows=200 width=8) (actual time=27200.866..27200.873 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=825745.19..825747.19 rows=200 width=8) (actual time=27200.824..27200.827 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=788246.90..803246.21 rows=1499932 width=8) (actual time=26379.420..26775.850 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.47..713997.55 rows=14849868 width=8) (actual time=3519.892..20392.899 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440779.40 rows=14849868 width=8) (actual time=0.013..10609.881 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=4) (actual time=3517.126..3517.126 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=4) (actual time=0.006..3249.710 rows=1500000 loops=1)
 Planning time: 0.608 ms
 Execution time: 27207.630 ms
(17 rows)

Time: 27501.271 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    65 |   76500000 |  1500000 |     0 |     0 |   691624 |  1344886 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 52296954 | 36427651 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    41 |  465000000 | 15000000 |     0 |     0 |  9191157 | 19239147 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    41 |   53309115 |  2000000 |     0 |     0 |   587414 |   933974 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      234 |       234 |      234 |     59 |      705 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       48 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     27 |       91 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     29 |       89 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       33 | 150251466 |       12 | 352408 |    58369 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     29 |       89 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154625 |   4702213 |  4702213 |  37559 |   593990 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     63 |      807 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       10 |  91108870 |        0 | 224101 |    24987 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638990 | 15440919 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      236 |       236 |      236 |    152 |      910 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108804 |   137524 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      234 |       234 |      234 |     67 |      725 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366213 |  10366213 | 10366213 | 101855 | 31053440 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      188 |   8001360 |  8001360 |   5510 |    16960 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=825754.84..825755.34 rows=200 width=8) (actual time=29598.344..29598.345 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=825745.19..825747.19 rows=200 width=8) (actual time=29598.287..29598.296 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=788246.90..803246.21 rows=1499932 width=8) (actual time=28899.115..29305.474 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.47..713997.55 rows=14849868 width=8) (actual time=671.488..22408.359 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440779.40 rows=14849868 width=8) (actual time=98.996..15208.762 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=4) (actual time=569.694..569.694 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=4) (actual time=0.012..271.753 rows=1500000 loops=1)
 Planning time: 0.734 ms
 Execution time: 29605.769 ms
(17 rows)

Time: 29786.461 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    66 |   78000000 |  1500000 |     0 |     0 |   691624 |  1380172 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 52296954 | 36427651 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    42 |  480000000 | 15000000 |     0 |     0 |  9444398 | 19239186 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    41 |   53309115 |  2000000 |     0 |     0 |   587414 |   933974 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      236 |       236 |      236 |     59 |      712 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       49 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     27 |       91 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     29 |       89 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       33 | 150251466 |       12 | 352408 |    58369 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     29 |       89 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154625 |   4702213 |  4702213 |  37559 |   593990 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     63 |      807 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       10 |  91108870 |        0 | 224101 |    24987 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638990 | 15440919 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      236 |       236 |      236 |    152 |      910 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108804 |   137525 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      236 |       236 |      236 |     67 |      732 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366213 |  10366213 | 10366213 | 101855 | 31053441 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      188 |   8001360 |  8001360 |   5510 |    16960 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=825754.84..825755.34 rows=200 width=8) (actual time=31968.265..31968.266 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=825745.19..825747.19 rows=200 width=8) (actual time=31968.212..31968.216 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=788246.90..803246.21 rows=1499932 width=8) (actual time=31284.134..31679.583 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.47..713997.55 rows=14849868 width=8) (actual time=2012.773..24823.120 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440779.40 rows=14849868 width=8) (actual time=76.671..16273.213 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=4) (actual time=1933.417..1933.417 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=4) (actual time=0.005..1648.115 rows=1500000 loops=1)
 Planning time: 0.721 ms
 Execution time: 31975.268 ms
(17 rows)

Time: 32183.533 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    67 |   79500000 |  1500000 |     0 |     0 |   706437 |  1400645 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 52296954 | 36427651 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    43 |  495000000 | 15000000 |     0 |     0 |  9697674 | 19239190 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    41 |   53309115 |  2000000 |     0 |     0 |   587414 |   933974 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      238 |       238 |      238 |     59 |      719 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       50 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     27 |       91 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     29 |       89 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       33 | 150251466 |       12 | 352408 |    58369 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     29 |       89 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154625 |   4702213 |  4702213 |  37559 |   593990 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     63 |      807 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       10 |  91108870 |        0 | 224101 |    24987 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638990 | 15440919 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      236 |       236 |      236 |    152 |      910 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108804 |   137526 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      238 |       238 |      238 |     67 |      739 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366213 |  10366213 | 10366213 | 101855 | 31053442 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      188 |   8001360 |  8001360 |   5510 |    16960 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=825754.84..825755.34 rows=200 width=8) (actual time=20418.386..20418.389 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=825745.19..825747.19 rows=200 width=8) (actual time=20418.346..20418.350 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=788246.90..803246.21 rows=1499932 width=8) (actual time=19883.412..20227.473 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.47..713997.55 rows=14849868 width=8) (actual time=1154.300..13788.669 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440779.40 rows=14849868 width=8) (actual time=0.020..6415.849 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=4) (actual time=1151.794..1151.794 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=4) (actual time=0.005..860.417 rows=1500000 loops=1)
 Planning time: 0.724 ms
 Execution time: 20426.398 ms
(17 rows)

Time: 20431.641 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    68 |   81000000 |  1500000 |     0 |     0 |   714525 |  1427843 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 53300986 | 36427864 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    45 |  525000000 | 15000000 |     0 |     0 | 10168217 | 19275207 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    41 |   53309115 |  2000000 |     0 |     0 |   587414 |   933974 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      240 |       240 |      240 |     59 |      726 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     28 |       91 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     30 |       89 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       33 | 150251466 |       12 | 352409 |    58369 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     30 |       89 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154625 |   4702213 |  4702213 |  37560 |   593990 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     64 |      807 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       11 | 100219757 |        0 | 248999 |    24987 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638991 | 15440919 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      238 |       238 |      238 |    160 |      911 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108805 |   137527 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      240 |       240 |      240 |     68 |      746 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366215 |  10366215 | 10366215 | 101861 | 31053444 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      188 |   8001360 |  8001360 |   5510 |    16960 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
