                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=82584.94..82585.44 rows=200 width=8)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   ->  HashAggregate  (cost=82575.30..82577.30 rows=200 width=8)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=78825.30..80325.30 rows=150000 width=8)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=6906.00..71400.42 rows=1484976 width=8)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..44076.00 rows=1484976 width=8)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                     ->  Hash  (cost=5031.00..5031.00 rows=150000 width=4)
                           ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=4)
(12 rows)

+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   18 |   2250000 |  150000 |     0 |     0 |   5016 |  186871 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 7270088 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   43 |       875 |      25 |     0 |     0 |      1 |   11099 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   14 |  18000000 | 1500000 |     0 |     0 |  48612 | 2716609 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 | 1099674 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1410274 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     100 |     100 |     100 |      6 |     319 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     635 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7544 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548825 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15057 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13860 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       4 | 3634072 |       0 |   2486 |    7504 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091669 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     110 |     110 |     110 |      6 |     374 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11062 |   11254 |   11254 |      2 |   11095 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      34 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2419 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48596 |  481216 |  481216 |   3943 |  143385 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540894 | 1540894 | 1540894 |   4116 | 4627102 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7919 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |   11116 |  879800 |  879800 |   1704 |   34167 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |      14 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404288 | 1444284 | 1444284 |     30 | 2816284 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       8 |    3176 |       0 |      4 |      50 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=82584.94..82585.44 rows=200 width=8) (actual time=1415.036..1415.039 rows=42 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 26kB
   ->  HashAggregate  (cost=82575.30..82577.30 rows=200 width=8) (actual time=1415.001..1415.006 rows=42 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=78825.30..80325.30 rows=150000 width=8) (actual time=1364.926..1395.558 rows=150000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=6906.00..71400.42 rows=1484976 width=8) (actual time=42.654..907.961 rows=1529895 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..44076.00 rows=1484976 width=8) (actual time=0.011..407.308 rows=1479891 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 20109
                     ->  Hash  (cost=5031.00..5031.00 rows=150000 width=4) (actual time=41.953..41.953 rows=150000 loops=1)
                           Buckets: 262144  Batches: 1  Memory Usage: 7322kB
                           ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=4) (actual time=0.004..21.234 rows=150000 loops=1)
 Planning time: 0.577 ms
 Execution time: 1416.471 ms
(17 rows)

Time: 1417.963 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   20 |   2400000 |  150000 |     0 |     0 |   5016 |  190406 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 7270088 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   43 |       875 |      25 |     0 |     0 |      1 |   11099 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   16 |  19500000 | 1500000 |     0 |     0 |  48612 | 2741939 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 | 1099674 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1410274 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     104 |     104 |     104 |      6 |     333 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     637 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7544 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548825 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15057 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13860 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       4 | 3634072 |       0 |   2486 |    7504 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091669 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     110 |     110 |     110 |      6 |     374 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11062 |   11254 |   11254 |      2 |   11095 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      34 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2421 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48600 |  481220 |  481220 |   3943 |  143399 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540894 | 1540894 | 1540894 |   4116 | 4627104 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7919 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |   11116 |  879800 |  879800 |   1704 |   34167 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |      14 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404288 | 1444284 | 1444284 |     30 | 2816284 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       8 |    3176 |       0 |      4 |      50 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=82584.94..82585.44 rows=200 width=8) (actual time=1436.644..1436.644 rows=42 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 26kB
   ->  HashAggregate  (cost=82575.30..82577.30 rows=200 width=8) (actual time=1436.609..1436.612 rows=42 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=78825.30..80325.30 rows=150000 width=8) (actual time=1386.039..1417.322 rows=150000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=6906.00..71400.42 rows=1484976 width=8) (actual time=42.750..919.748 rows=1529895 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..44076.00 rows=1484976 width=8) (actual time=0.012..405.477 rows=1479891 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 20109
                     ->  Hash  (cost=5031.00..5031.00 rows=150000 width=4) (actual time=42.056..42.056 rows=150000 loops=1)
                           Buckets: 262144  Batches: 1  Memory Usage: 7322kB
                           ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=4) (actual time=0.004..21.371 rows=150000 loops=1)
 Planning time: 0.569 ms
 Execution time: 1437.918 ms
(17 rows)

Time: 1439.446 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   21 |   2550000 |  150000 |     0 |     0 |   5016 |  193939 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 7270088 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   43 |       875 |      25 |     0 |     0 |      1 |   11099 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   17 |  21000000 | 1500000 |     0 |     0 |  48612 | 2767267 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 | 1099674 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1410274 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     106 |     106 |     106 |      6 |     340 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     638 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7544 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548825 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15057 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13860 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       4 | 3634072 |       0 |   2486 |    7504 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091669 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     110 |     110 |     110 |      6 |     374 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11062 |   11254 |   11254 |      2 |   11095 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      34 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2422 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48602 |  481222 |  481222 |   3943 |  143406 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540894 | 1540894 | 1540894 |   4116 | 4627105 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7919 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |   11116 |  879800 |  879800 |   1704 |   34167 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |      14 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404288 | 1444284 | 1444284 |     30 | 2816284 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       8 |    3176 |       0 |      4 |      50 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=82584.94..82585.44 rows=200 width=8) (actual time=1437.625..1437.625 rows=42 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 26kB
   ->  HashAggregate  (cost=82575.30..82577.30 rows=200 width=8) (actual time=1437.589..1437.595 rows=42 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=78825.30..80325.30 rows=150000 width=8) (actual time=1387.022..1418.108 rows=150000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=6906.00..71400.42 rows=1484976 width=8) (actual time=42.842..920.333 rows=1529895 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..44076.00 rows=1484976 width=8) (actual time=0.013..405.016 rows=1479891 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 20109
                     ->  Hash  (cost=5031.00..5031.00 rows=150000 width=4) (actual time=42.151..42.151 rows=150000 loops=1)
                           Buckets: 262144  Batches: 1  Memory Usage: 7322kB
                           ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=4) (actual time=0.004..21.388 rows=150000 loops=1)
 Planning time: 0.563 ms
 Execution time: 1438.884 ms
(17 rows)

Time: 1440.384 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   22 |   2700000 |  150000 |     0 |     0 |   5016 |  197472 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 7270088 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   43 |       875 |      25 |     0 |     0 |      1 |   11099 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   18 |  22500000 | 1500000 |     0 |     0 |  48612 | 2792595 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 | 1099674 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1410274 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     108 |     108 |     108 |      6 |     347 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     639 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7544 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548825 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15057 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13860 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       4 | 3634072 |       0 |   2486 |    7504 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091669 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     110 |     110 |     110 |      6 |     374 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11062 |   11254 |   11254 |      2 |   11095 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      34 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2423 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48604 |  481224 |  481224 |   3943 |  143413 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540894 | 1540894 | 1540894 |   4116 | 4627106 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7919 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |   11116 |  879800 |  879800 |   1704 |   34167 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |      14 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404288 | 1444284 | 1444284 |     30 | 2816284 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       8 |    3176 |       0 |      4 |      50 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=82584.94..82585.44 rows=200 width=8) (actual time=1436.819..1436.820 rows=42 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 26kB
   ->  HashAggregate  (cost=82575.30..82577.30 rows=200 width=8) (actual time=1436.784..1436.788 rows=42 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=78825.30..80325.30 rows=150000 width=8) (actual time=1386.141..1417.170 rows=150000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=6906.00..71400.42 rows=1484976 width=8) (actual time=42.790..920.208 rows=1529895 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..44076.00 rows=1484976 width=8) (actual time=0.012..404.766 rows=1479891 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 20109
                     ->  Hash  (cost=5031.00..5031.00 rows=150000 width=4) (actual time=42.091..42.091 rows=150000 loops=1)
                           Buckets: 262144  Batches: 1  Memory Usage: 7322kB
                           ->  Seq Scan on customer  (cost=0.00..5031.00 rows=150000 width=4) (actual time=0.004..21.193 rows=150000 loops=1)
 Planning time: 0.571 ms
 Execution time: 1438.088 ms
(17 rows)

Time: 1439.613 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   23 |   2850000 |  150000 |     0 |     0 |   5016 |  201005 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 7270088 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   43 |       875 |      25 |     0 |     0 |      1 |   11099 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |   19 |  24000000 | 1500000 |     0 |     0 |  48612 | 2817923 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 | 1099674 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1410274 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     110 |     110 |     110 |      6 |     354 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     640 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      49 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7544 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548825 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15057 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13860 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       4 | 3634072 |       0 |   2486 |    7504 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091669 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     110 |     110 |     110 |      6 |     374 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11062 |   11254 |   11254 |      2 |   11095 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      34 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2424 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48606 |  481226 |  481226 |   3943 |  143420 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540894 | 1540894 | 1540894 |   4116 | 4627107 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7919 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |   11116 |  879800 |  879800 |   1704 |   34167 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |      14 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404288 | 1444284 | 1444284 |     30 | 2816284 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       8 |    3176 |       0 |      4 |      50 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
