                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2675281.39..2675281.41 rows=10 width=20)
   ->  Sort  (cost=2675281.39..2683183.79 rows=3160960 width=20)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         ->  HashAggregate  (cost=2575364.58..2606974.18 rows=3160960 width=20)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=558290.73..2527950.18 rows=3160960 width=20)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1815236.60 rows=32750198 width=12)
                           Filter: (l_shipdate > '1995-03-03'::date)
                     ->  Hash  (cost=540193.61..540193.61 rows=1447770 width=12)
                           ->  Hash Join  (cost=57781.72..540193.61 rows=1447770 width=12)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..440779.40 rows=7241276 width=16)
                                       Filter: (o_orderdate < '1995-03-03'::date)
                                 ->  Hash  (cost=54033.15..54033.15 rows=299886 width=4)
                                       ->  Seq Scan on customer  (cost=0.00..54033.15 rows=299886 width=4)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
(17 rows)

+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |     6 |    4500000 |  1500000 |     0 |     0 |   132525 |   210131 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    25 | 1080556636 | 59986052 |     0 |     0 | 12068988 | 10607848 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25653 |     641125 |       25 |     0 |     0 |        2 |    25719 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |     7 |   60000000 | 15000000 |     0 |     0 |  1137532 |   795868 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |     2 |    4000000 |  2000000 |     0 |     0 |   239833 |   279756 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |   953104 |  6847512 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    20 |         52 |        5 |     0 |     0 |        2 |       50 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    18 |     700004 |   100000 |     0 |     0 |     6562 |   129314 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     12 |      12 |      12 |      6 |     33 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |      0 |       0 |       0 |      1 |      2 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |      0 |       0 |       0 |      1 |     15 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      0 |       0 |       0 |      1 |     15 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |     12 |      12 |      12 |      5 |     59 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |      0 |       0 |       0 |      1 |     15 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |      0 |       0 |       0 |      1 |     15 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      0 |       0 |       0 |      1 |     15 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |      0 |       0 |       0 |      1 |     15 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |      0 |       0 |       0 |      1 |     15 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      8 |       8 |       8 |      8 |     40 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |     72 |      72 |      72 |      2 |     79 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |      0 |       0 |       0 |      1 |      3 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |     12 |      12 |      12 |      6 |     34 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |      8 |       8 |       8 |      6 |     22 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     42 | 8001214 | 8001214 |   5469 |  16524 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |  25672 |  102580 |  102580 |   4397 |  72992 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |  79422 | 6347997 | 6347997 |  15595 | 240344 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     36 |      36 |      36 |      2 |     43 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102616 |  102616 |  102616 |    276 | 205569 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
SET
Timing is on.
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2675281.39..2675281.41 rows=10 width=20) (actual time=51459.204..51459.207 rows=10 loops=1)
   ->  Sort  (cost=2675281.39..2683183.79 rows=3160960 width=20) (actual time=51459.201..51459.203 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2575364.58..2606974.18 rows=3160960 width=20) (actual time=51413.065..51446.482 rows=113554 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=558290.73..2527950.18 rows=3160960 width=20) (actual time=13332.736..51257.414 rows=298969 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1815236.60 rows=32750198 width=12) (actual time=0.015..34299.262 rows=32634258 loops=1)
                           Filter: (l_shipdate > '1995-03-03'::date)
                           Rows Removed by Filter: 27351794
                     ->  Hash  (cost=540193.61..540193.61 rows=1447770 width=12) (actual time=13267.564..13267.564 rows=1443407 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 78406kB
                           ->  Hash Join  (cost=57781.72..540193.61 rows=1447770 width=12) (actual time=405.949..12931.938 rows=1443407 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..440779.40 rows=7241276 width=16) (actual time=0.031..10801.131 rows=7214283 loops=1)
                                       Filter: (o_orderdate < '1995-03-03'::date)
                                       Rows Removed by Filter: 7785717
                                 ->  Hash  (cost=54033.15..54033.15 rows=299886 width=4) (actual time=404.971..404.971 rows=299496 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14626kB
                                       ->  Seq Scan on customer  (cost=0.00..54033.15 rows=299886 width=4) (actual time=0.008..341.069 rows=299496 loops=1)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
                                             Rows Removed by Filter: 1200504
 Planning time: 0.927 ms
 Execution time: 51466.528 ms
(25 rows)

Time: 51473.494 ms
+----+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |     9 |    7500000 |  1500000 |     0 |     0 |   166195 |   247041 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    28 | 1200528740 | 59986052 |     0 |     0 | 12932774 | 11874888 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25653 |     641125 |       25 |     0 |     0 |        2 |    25719 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    10 |   90000000 | 15000000 |     0 |     0 |  1441007 |   998967 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |     2 |    4000000 |  2000000 |     0 |     0 |   239833 |   279756 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |   953104 |  6847512 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    20 |         52 |        5 |     0 |     0 |        2 |       50 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    18 |     700004 |   100000 |     0 |     0 |     6562 |   129314 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+---------+----+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     24 |      24 |      24 |      6 |     72 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |      0 |       0 |       0 |      1 |      5 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |      0 |       0 |       0 |      1 |     18 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      0 |       0 |       0 |      1 |     18 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |     12 |      12 |      12 |      5 |     62 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |      0 |       0 |       0 |      1 |     18 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |      0 |       0 |       0 |      1 |     18 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      0 |       0 |       0 |      1 |     18 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |      0 |       0 |       0 |      1 |     18 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |      0 |       0 |       0 |      1 |     18 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |     14 |      14 |      14 |      8 |     67 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |     72 |      72 |      72 |      2 |     79 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |      0 |       0 |       0 |      1 |      6 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |     24 |      24 |      24 |      6 |     73 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |     14 |      14 |      14 |      6 |     43 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     42 | 8001214 | 8001214 |   5469 |  16524 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |  25672 |  102580 |  102580 |   4397 |  72992 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |  79422 | 6347997 | 6347997 |  15595 | 240344 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     36 |      36 |      36 |      2 |     43 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102616 |  102616 |  102616 |    276 | 205569 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+---------SET
TSET
Timing is                                                                              QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2675281.39..2675281.41 rows=10 width=20) (actual time=49650.250..49650.253 rows=10 loops=1)
   ->  Sort  (cost=2675281.39..2683183.79 rows=3160960 width=20) (actual time=49650.247..49650.247 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2575364.58..2606974.18 rows=3160960 width=20) (actual time=49603.343..49637.521 rows=113554 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=558290.73..2527950.18 rows=3160960 width=20) (actual time=11548.784..49436.891 rows=298969 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1815236.60 rows=32750198 width=12) (actual time=0.029..34207.418 rows=32634258 loops=1)
                           Filter: (l_shipdate > '1995-03-03'::date)
                           Rows Removed by Filter: 27351794
                     ->  Hash  (cost=540193.61..540193.61 rows=1447770 width=12) (actual time=11545.556..11545.556 rows=1443407 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 78406kB
                           ->  Hash Join  (cost=57781.72..540193.61 rows=1447770 width=12) (actual time=351.465..11208.202 rows=1443407 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..440779.40 rows=7241276 width=16) (actual time=7.760..9111.996 rows=7214283 loops=1)
                                       Filter: (o_orderdate < '1995-03-03'::date)
                                       Rows Removed by Filter: 7785717
                                 ->  Hash  (cost=54033.15..54033.15 rows=299886 width=4) (actual time=342.472..342.472 rows=299496 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14626kB
                                       ->  Seq Scan on customer  (cost=0.00..54033.15 rows=299886 width=4) (actual time=0.008..285.275 rows=299496 loops=1)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
                                             Rows Removed by Filter: 1200504
 Planning time: 0.834 ms
 Execution time: 49659.053 ms
(25 rows)

Time: 49666.01+----+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    11 |   10500000 |  1500000 |     0 |     0 |   166195 |   317617 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    30 | 1320500844 | 59986052 |     0 |     0 | 13749840 | 13188646 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25653 |     641125 |       25 |     0 |     0 |        2 |    25719 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    12 |  120000000 | 15000000 |     0 |     0 |  1697011 |  1249531 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |     2 |    4000000 |  2000000 |     0 |     0 |   239833 |   279756 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |   953104 |  6847512 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    20 |         52 |        5 |     0 |     0 |        2 |       50 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    18 |     700004 |   100000 |     0 |     0 |     6562 |   129314 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+---------+----+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     32 |      32 |      32 |      6 |     98 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |      0 |       0 |       0 |      1 |      7 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |      0 |       0 |       0 |      1 |     20 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      0 |       0 |       0 |      1 |     20 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |     12 |      12 |      12 |      5 |     64 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |      0 |       0 |       0 |      1 |     20 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |      0 |       0 |       0 |      1 |     20 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      0 |       0 |       0 |      1 |     20 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |      0 |       0 |       0 |      1 |     20 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |      0 |       0 |       0 |      1 |     20 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |     18 |      18 |      18 |      8 |     85 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |     72 |      72 |      72 |      2 |     79 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |     32 |      32 |      32 |      6 |     99 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |     18 |      18 |      18 |      6 |     57 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     42 | 8001214 | 8001214 |   5469 |  16524 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |  25672 |  102580 |  102580 |   4397 |  72992 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |  79422 | 6347997 | 6347997 |  15595 | 240344 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     36 |      36 |      36 |      2 |     43 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102616 |  102616 |  102616 |    276 | 205569 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+---------SET
TSET
Timing is                                                                              QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2675281.39..2675281.41 rows=10 width=20) (actual time=49476.996..49476.998 rows=10 loops=1)
   ->  Sort  (cost=2675281.39..2683183.79 rows=3160960 width=20) (actual time=49476.993..49476.994 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2575364.58..2606974.18 rows=3160960 width=20) (actual time=49431.740..49464.399 rows=113554 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=558290.73..2527950.18 rows=3160960 width=20) (actual time=11266.597..49276.232 rows=298969 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1815236.60 rows=32750198 width=12) (actual time=0.018..34415.880 rows=32634258 loops=1)
                           Filter: (l_shipdate > '1995-03-03'::date)
                           Rows Removed by Filter: 27351794
                     ->  Hash  (cost=540193.61..540193.61 rows=1447770 width=12) (actual time=11263.085..11263.085 rows=1443407 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 78406kB
                           ->  Hash Join  (cost=57781.72..540193.61 rows=1447770 width=12) (actual time=343.344..10937.225 rows=1443407 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..440779.40 rows=7241276 width=16) (actual time=0.037..8885.400 rows=7214283 loops=1)
                                       Filter: (o_orderdate < '1995-03-03'::date)
                                       Rows Removed by Filter: 7785717
                                 ->  Hash  (cost=54033.15..54033.15 rows=299886 width=4) (actual time=342.262..342.262 rows=299496 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14626kB
                                       ->  Seq Scan on customer  (cost=0.00..54033.15 rows=299886 width=4) (actual time=0.011..284.855 rows=299496 loops=1)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
                                             Rows Removed by Filter: 1200504
 Planning time: 0.828 ms
 Execution time: 49484.983 ms
(25 rows)

Time: 49492.16+----+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    13 |   13500000 |  1500000 |     0 |     0 |   166195 |   388193 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    32 | 1440472948 | 59986052 |     0 |     0 | 14566716 | 14502594 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25653 |     641125 |       25 |     0 |     0 |        2 |    25719 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    14 |  150000000 | 15000000 |     0 |     0 |  1952178 |  1500932 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |     2 |    4000000 |  2000000 |     0 |     0 |   239833 |   279756 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |   953104 |  6847512 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    20 |         52 |        5 |     0 |     0 |        2 |       50 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    18 |     700004 |   100000 |     0 |     0 |     6562 |   129314 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+---------+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     40 |      40 |      40 |      6 |    124 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |      0 |       0 |       0 |      1 |      9 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |      0 |       0 |       0 |      1 |     22 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      0 |       0 |       0 |      1 |     22 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |     12 |      12 |      12 |      5 |     66 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |      0 |       0 |       0 |      1 |     22 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |      0 |       0 |       0 |      1 |     22 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      0 |       0 |       0 |      1 |     22 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |      0 |       0 |       0 |      1 |     22 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |      0 |       0 |       0 |      1 |     22 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |     22 |      22 |      22 |      8 |    103 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |     72 |      72 |      72 |      2 |     79 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |      0 |       0 |       0 |      1 |     10 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |     40 |      40 |      40 |      6 |    125 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |     22 |      22 |      22 |      6 |     71 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     42 | 8001214 | 8001214 |   5469 |  16524 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |  25672 |  102580 |  102580 |   4397 |  72992 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |  79422 | 6347997 | 6347997 |  15595 | 240344 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     36 |      36 |      36 |      2 |     43 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102616 |  102616 |  102616 |    276 | 205569 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
SET
Timing is on.
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2675281.39..2675281.41 rows=10 width=20) (actual time=49743.768..49743.770 rows=10 loops=1)
   ->  Sort  (cost=2675281.39..2683183.79 rows=3160960 width=20) (actual time=49743.767..49743.767 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::double precision - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2575364.58..2606974.18 rows=3160960 width=20) (actual time=49696.807..49731.211 rows=113554 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Hash Join  (cost=558290.73..2527950.18 rows=3160960 width=20) (actual time=11449.866..49527.510 rows=298969 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1815236.60 rows=32750198 width=12) (actual time=0.011..34258.983 rows=32634258 loops=1)
                           Filter: (l_shipdate > '1995-03-03'::date)
                           Rows Removed by Filter: 27351794
                     ->  Hash  (cost=540193.61..540193.61 rows=1447770 width=12) (actual time=11446.413..11446.413 rows=1443407 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 78406kB
                           ->  Hash Join  (cost=57781.72..540193.61 rows=1447770 width=12) (actual time=352.407..11106.142 rows=1443407 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..440779.40 rows=7241276 width=16) (actual time=8.894..8982.402 rows=7214283 loops=1)
                                       Filter: (o_orderdate < '1995-03-03'::date)
                                       Rows Removed by Filter: 7785717
                                 ->  Hash  (cost=54033.15..54033.15 rows=299886 width=4) (actual time=342.267..342.267 rows=299496 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14626kB
                                       ->  Seq Scan on customer  (cost=0.00..54033.15 rows=299886 width=4) (actual time=0.008..285.269 rows=299496 loops=1)
                                             Filter: (c_mktsegment = 'FURNITURE'::bpchar)
                                             Rows Removed by Filter: 1200504
 Planning time: 0.921 ms
 Execution time: 49752.448 ms
(25 rows)

Time: 49759.615 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    15 |   16500000 |  1500000 |     0 |     0 |   166195 |   458769 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    34 | 1560445052 | 59986052 |     0 |     0 | 15383769 | 15816365 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25653 |     641125 |       25 |     0 |     0 |        2 |    25719 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    16 |  180000000 | 15000000 |     0 |     0 |  2207752 |  1751926 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |     2 |    4000000 |  2000000 |     0 |     0 |   239833 |   279756 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |   953104 |  6847512 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    20 |         52 |        5 |     0 |     0 |        2 |       50 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    18 |     700004 |   100000 |     0 |     0 |     6562 |   129314 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |  SCAN  |  T_READ |  T_FTCH | B_READ | B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     48 |      48 |      48 |      6 |    150 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |      0 |       0 |       0 |      1 |     11 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |      0 |       0 |       0 |      1 |     24 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |      0 |       0 |       0 |      1 |     24 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |     12 |      12 |      12 |      5 |     68 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |      0 |       0 |       0 |      1 |     24 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |      0 |       0 |       0 |      1 |     24 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      0 |       0 |       0 |      1 |     24 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |      0 |       0 |       0 |      1 |     24 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |      0 |       0 |       0 |      1 |     24 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |     26 |      26 |      26 |      8 |    121 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |     72 |      72 |      72 |      2 |     79 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |      0 |       0 |       0 |      1 |     12 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |     48 |      48 |      48 |      6 |    151 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 |     26 |      26 |      26 |      6 |     85 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     42 | 8001214 | 8001214 |   5469 |  16524 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |  25672 |  102580 |  102580 |   4397 |  72992 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |  79422 | 6347997 | 6347997 |  15595 | 240344 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |     36 |      36 |      36 |      2 |     43 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 102616 |  102616 |  102616 |    276 | 205569 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |      0 |       0 |       0 |      1 |      8 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+--------+---------+---------+--------+--------+--------+------------+
---+
