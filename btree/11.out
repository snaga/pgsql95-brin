                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Sort  (cost=12352.55..12432.55 rows=32000 width=12)
   Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision))) DESC
   InitPlan 1 (returns $2)
     ->  Aggregate  (cost=4619.01..4619.02 rows=1 width=8)
           ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=8)
                 ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4)
                       ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4)
                             Filter: (n_name = 'BRAZIL'::bpchar)
                       ->  Bitmap Heap Scan on supplier supplier_1  (cost=11.38..238.46 rows=400 width=8)
                             Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                             ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0)
                                   Index Cond: (s_nationkey = nation_1.n_nationkey)
                 ->  Index Scan using i_ps_suppkey on partsupp partsupp_1  (cost=0.42..9.54 rows=80 width=12)
                       Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  HashAggregate  (cost=4939.01..5339.01 rows=32000 width=12)
         Group Key: partsupp.ps_partkey
         Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision)) > $2)
         ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=12)
               ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4)
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4)
                           Filter: (n_name = 'BRAZIL'::bpchar)
                     ->  Bitmap Heap Scan on supplier  (cost=11.38..238.46 rows=400 width=8)
                           Recheck Cond: (s_nationkey = nation.n_nationkey)
                           ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0)
                                 Index Cond: (s_nationkey = nation.n_nationkey)
               ->  Index Scan using i_ps_suppkey on partsupp  (cost=0.42..9.54 rows=80 width=16)
                     Index Cond: (ps_suppkey = supplier.s_suppkey)
(27 rows)

+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   18 |   2250000 |  150000 |     0 |     0 |   5016 |  186871 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 6868414 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   33 |       675 |      25 |     0 |     0 |      1 |   11071 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2615295 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     100 |     100 |     100 |      6 |     319 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     635 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7539 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548820 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15052 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13855 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091664 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     100 |     100 |     100 |      6 |     339 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11042 |   11234 |   11234 |      2 |   11070 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      29 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2414 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48596 |  481216 |  481216 |   3943 |  143380 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540884 | 1540884 | 1540884 |   4116 | 4627067 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=12352.55..12432.55 rows=32000 width=12) (actual time=74.457..74.509 rows=907 loops=1)
   Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision))) DESC
   Sort Method: quicksort  Memory: 67kB
   InitPlan 1 (returns $2)
     ->  Aggregate  (cost=4619.01..4619.02 rows=1 width=8) (actual time=22.174..22.174 rows=1 loops=1)
           ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=8) (actual time=0.067..18.793 rows=31760 loops=1)
                 ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4) (actual time=0.061..0.290 rows=397 loops=1)
                       ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.006 rows=1 loops=1)
                             Filter: (n_name = 'BRAZIL'::bpchar)
                             Rows Removed by Filter: 24
                       ->  Bitmap Heap Scan on supplier supplier_1  (cost=11.38..238.46 rows=400 width=8) (actual time=0.056..0.229 rows=397 loops=1)
                             Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                             Heap Blocks: exact=181
                             ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0) (actual time=0.041..0.041 rows=397 loops=1)
                                   Index Cond: (s_nationkey = nation_1.n_nationkey)
                 ->  Index Scan using i_ps_suppkey on partsupp partsupp_1  (cost=0.42..9.54 rows=80 width=12) (actual time=0.003..0.038 rows=80 loops=397)
                       Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  HashAggregate  (cost=4939.01..5339.01 rows=32000 width=12) (actual time=70.381..74.186 rows=907 loops=1)
         Group Key: partsupp.ps_partkey
         Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision)) > $2)
         Rows Removed by Filter: 29157
         ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=12) (actual time=0.108..39.420 rows=31760 loops=1)
               ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4) (actual time=0.090..0.540 rows=397 loops=1)
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.009 rows=1 loops=1)
                           Filter: (n_name = 'BRAZIL'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Bitmap Heap Scan on supplier  (cost=11.38..238.46 rows=400 width=8) (actual time=0.083..0.477 rows=397 loops=1)
                           Recheck Cond: (s_nationkey = nation.n_nationkey)
                           Heap Blocks: exact=181
                           ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0) (actual time=0.066..0.066 rows=397 loops=1)
                                 Index Cond: (s_nationkey = nation.n_nationkey)
               ->  Index Scan using i_ps_suppkey on partsupp  (cost=0.42..9.54 rows=80 width=16) (actual time=0.007..0.089 rows=80 loops=397)
                     Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning time: 0.796 ms
 Execution time: 74.866 ms
(35 rows)

Time: 76.824 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   18 |   2250000 |  150000 |     0 |     0 |   5016 |  186871 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 6868414 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   33 |       675 |      25 |     0 |     0 |      1 |   11071 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2615295 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     100 |     100 |     100 |      6 |     319 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     635 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7539 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548820 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15052 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13855 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091664 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     100 |     100 |     100 |      6 |     339 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11042 |   11234 |   11234 |      2 |   11070 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      29 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2414 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48596 |  481216 |  481216 |   3943 |  143380 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540884 | 1540884 | 1540884 |   4116 | 4627067 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=12352.55..12432.55 rows=32000 width=12) (actual time=73.313..73.361 rows=907 loops=1)
   Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision))) DESC
   Sort Method: quicksort  Memory: 67kB
   InitPlan 1 (returns $2)
     ->  Aggregate  (cost=4619.01..4619.02 rows=1 width=8) (actual time=22.113..22.113 rows=1 loops=1)
           ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=8) (actual time=0.064..18.745 rows=31760 loops=1)
                 ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4) (actual time=0.058..0.278 rows=397 loops=1)
                       ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.006 rows=1 loops=1)
                             Filter: (n_name = 'BRAZIL'::bpchar)
                             Rows Removed by Filter: 24
                       ->  Bitmap Heap Scan on supplier supplier_1  (cost=11.38..238.46 rows=400 width=8) (actual time=0.053..0.224 rows=397 loops=1)
                             Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                             Heap Blocks: exact=181
                             ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0) (actual time=0.037..0.037 rows=397 loops=1)
                                   Index Cond: (s_nationkey = nation_1.n_nationkey)
                 ->  Index Scan using i_ps_suppkey on partsupp partsupp_1  (cost=0.42..9.54 rows=80 width=12) (actual time=0.003..0.038 rows=80 loops=397)
                       Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  HashAggregate  (cost=4939.01..5339.01 rows=32000 width=12) (actual time=69.407..73.040 rows=907 loops=1)
         Group Key: partsupp.ps_partkey
         Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision)) > $2)
         Rows Removed by Filter: 29157
         ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=12) (actual time=0.082..38.697 rows=31760 loops=1)
               ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4) (actual time=0.067..0.507 rows=397 loops=1)
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.009 rows=1 loops=1)
                           Filter: (n_name = 'BRAZIL'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Bitmap Heap Scan on supplier  (cost=11.38..238.46 rows=400 width=8) (actual time=0.060..0.441 rows=397 loops=1)
                           Recheck Cond: (s_nationkey = nation.n_nationkey)
                           Heap Blocks: exact=181
                           ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0) (actual time=0.043..0.043 rows=397 loops=1)
                                 Index Cond: (s_nationkey = nation.n_nationkey)
               ->  Index Scan using i_ps_suppkey on partsupp  (cost=0.42..9.54 rows=80 width=16) (actual time=0.006..0.087 rows=80 loops=397)
                     Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning time: 0.801 ms
 Execution time: 73.715 ms
(35 rows)

Time: 75.700 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   18 |   2250000 |  150000 |     0 |     0 |   5016 |  186871 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 6868414 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   33 |       675 |      25 |     0 |     0 |      1 |   11071 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2615295 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     100 |     100 |     100 |      6 |     319 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     635 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7539 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548820 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15052 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13855 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091664 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     100 |     100 |     100 |      6 |     339 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11042 |   11234 |   11234 |      2 |   11070 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      29 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2414 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48596 |  481216 |  481216 |   3943 |  143380 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540884 | 1540884 | 1540884 |   4116 | 4627067 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=12352.55..12432.55 rows=32000 width=12) (actual time=73.445..73.491 rows=907 loops=1)
   Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision))) DESC
   Sort Method: quicksort  Memory: 67kB
   InitPlan 1 (returns $2)
     ->  Aggregate  (cost=4619.01..4619.02 rows=1 width=8) (actual time=22.157..22.157 rows=1 loops=1)
           ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=8) (actual time=0.066..18.715 rows=31760 loops=1)
                 ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4) (actual time=0.060..0.286 rows=397 loops=1)
                       ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.002..0.005 rows=1 loops=1)
                             Filter: (n_name = 'BRAZIL'::bpchar)
                             Rows Removed by Filter: 24
                       ->  Bitmap Heap Scan on supplier supplier_1  (cost=11.38..238.46 rows=400 width=8) (actual time=0.054..0.219 rows=397 loops=1)
                             Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                             Heap Blocks: exact=181
                             ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0) (actual time=0.038..0.038 rows=397 loops=1)
                                   Index Cond: (s_nationkey = nation_1.n_nationkey)
                 ->  Index Scan using i_ps_suppkey on partsupp partsupp_1  (cost=0.42..9.54 rows=80 width=12) (actual time=0.003..0.038 rows=80 loops=397)
                       Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  HashAggregate  (cost=4939.01..5339.01 rows=32000 width=12) (actual time=69.450..73.181 rows=907 loops=1)
         Group Key: partsupp.ps_partkey
         Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision)) > $2)
         Rows Removed by Filter: 29157
         ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=12) (actual time=0.084..38.676 rows=31760 loops=1)
               ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4) (actual time=0.068..0.519 rows=397 loops=1)
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.010 rows=1 loops=1)
                           Filter: (n_name = 'BRAZIL'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Bitmap Heap Scan on supplier  (cost=11.38..238.46 rows=400 width=8) (actual time=0.061..0.457 rows=397 loops=1)
                           Recheck Cond: (s_nationkey = nation.n_nationkey)
                           Heap Blocks: exact=181
                           ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0) (actual time=0.043..0.043 rows=397 loops=1)
                                 Index Cond: (s_nationkey = nation.n_nationkey)
               ->  Index Scan using i_ps_suppkey on partsupp  (cost=0.42..9.54 rows=80 width=16) (actual time=0.006..0.087 rows=80 loops=397)
                     Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning time: 0.794 ms
 Execution time: 73.855 ms
(35 rows)

Time: 75.844 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   18 |   2250000 |  150000 |     0 |     0 |   5016 |  186871 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 6868414 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   33 |       675 |      25 |     0 |     0 |      1 |   11071 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2615295 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 |  845554 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1408786 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     100 |     100 |     100 |      6 |     319 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     635 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7539 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548820 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15052 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13855 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091664 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     100 |     100 |     100 |      6 |     339 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11042 |   11234 |   11234 |      2 |   11070 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      29 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2414 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48596 |  481216 |  481216 |   3943 |  143380 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540884 | 1540884 | 1540884 |   4116 | 4627067 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7914 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |    7900 |  625680 |  625680 |   1554 |   23840 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |       9 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404248 | 1444244 | 1444244 |     30 | 2816199 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       0 |       0 |       0 |      1 |      24 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
Timing is on.
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=12352.55..12432.55 rows=32000 width=12) (actual time=74.136..74.179 rows=907 loops=1)
   Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision))) DESC
   Sort Method: quicksort  Memory: 67kB
   InitPlan 1 (returns $2)
     ->  Aggregate  (cost=4619.01..4619.02 rows=1 width=8) (actual time=21.990..21.990 rows=1 loops=1)
           ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=8) (actual time=0.070..18.545 rows=31760 loops=1)
                 ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4) (actual time=0.063..0.283 rows=397 loops=1)
                       ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.007 rows=1 loops=1)
                             Filter: (n_name = 'BRAZIL'::bpchar)
                             Rows Removed by Filter: 24
                       ->  Bitmap Heap Scan on supplier supplier_1  (cost=11.38..238.46 rows=400 width=8) (actual time=0.057..0.233 rows=397 loops=1)
                             Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                             Heap Blocks: exact=181
                             ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0) (actual time=0.040..0.040 rows=397 loops=1)
                                   Index Cond: (s_nationkey = nation_1.n_nationkey)
                 ->  Index Scan using i_ps_suppkey on partsupp partsupp_1  (cost=0.42..9.54 rows=80 width=12) (actual time=0.003..0.037 rows=80 loops=397)
                       Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  HashAggregate  (cost=4939.01..5339.01 rows=32000 width=12) (actual time=68.498..73.883 rows=907 loops=1)
         Group Key: partsupp.ps_partkey
         Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::double precision)) > $2)
         Rows Removed by Filter: 29157
         ->  Nested Loop  (cost=11.81..4379.01 rows=32000 width=12) (actual time=0.080..37.818 rows=31760 loops=1)
               ->  Nested Loop  (cost=11.38..243.78 rows=400 width=4) (actual time=0.066..0.527 rows=397 loops=1)
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.009 rows=1 loops=1)
                           Filter: (n_name = 'BRAZIL'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Bitmap Heap Scan on supplier  (cost=11.38..238.46 rows=400 width=8) (actual time=0.059..0.459 rows=397 loops=1)
                           Recheck Cond: (s_nationkey = nation.n_nationkey)
                           Heap Blocks: exact=181
                           ->  Bitmap Index Scan on i_s_nationkey  (cost=0.00..11.29 rows=400 width=0) (actual time=0.042..0.042 rows=397 loops=1)
                                 Index Cond: (s_nationkey = nation.n_nationkey)
               ->  Index Scan using i_ps_suppkey on partsupp  (cost=0.42..9.54 rows=80 width=16) (actual time=0.006..0.085 rows=80 loops=397)
                     Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning time: 0.789 ms
 Execution time: 74.574 ms
(35 rows)

Time: 76.528 ms
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |  BLKS  | SCAN |   T_READ  |  T_INS  | T_UPD | T_DEL | B_READ |  B_HIT  | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
| 16395 | snaga | public | customer |   3531 |   18 |   2250000 |  150000 |     0 |     0 |   5016 |  186871 |          | 2015-07-16 01:41:13 | pg_default |
| 16401 | snaga | public | lineitem | 106583 |   25 | 132026730 | 6001215 |     0 |     0 | 211146 | 6868414 |          | 2015-07-16 01:41:14 | pg_default |
| 16404 | snaga | public | nation   |      1 |   43 |       875 |      25 |     0 |     0 |      1 |   11099 |          | 2015-07-16 01:41:14 | pg_default |
| 16398 | snaga | public | orders   |  25326 |    9 |  12000000 | 1500000 |     0 |     0 |  48612 | 2615295 |          | 2015-07-16 01:41:13 | pg_default |
| 16389 | snaga | public | part     |   4064 |   12 |   2000000 |  200000 |     0 |     0 |   6082 |   75666 |          | 2015-07-16 01:41:13 | pg_default |
| 16392 | snaga | public | partsupp |  17087 |    9 |   6400000 |  800000 |     0 |     0 |  32200 | 1099674 |          | 2015-07-16 01:41:13 | pg_default |
| 16407 | snaga | public | region   |      1 | 2738 |     13650 |       5 |     0 |     0 |      1 |    2772 |          | 2015-07-16 01:41:14 | pg_default |
| 16386 | snaga | public | supplier |    218 |   17 |    110000 |   10000 |     0 |     0 |    220 | 1410274 |          | 2015-07-16 01:41:12 | pg_default |
+-------+-------+--------+----------+--------+------+-----------+---------+-------+-------+--------+---------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS |   SCAN  |  T_READ |  T_FTCH | B_READ |  B_HIT  | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
| 16416 | snaga | public | customer | pk_customer           |   414 |     100 |     100 |     100 |      6 |     319 |        | pg_default |
| 16439 | snaga | public | customer | i_c_nationkey         |   414 |      40 |  241520 |       0 |    174 |     635 |        | pg_default |
| 16446 | snaga | public | lineitem | i_l_commitdate        | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16420 | snaga | public | lineitem | pk_lineitem           | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16426 | snaga | public | lineitem | i_l_shipdate          | 16457 |       9 | 3645585 |       5 |   2497 |    7539 |        | pg_default |
| 16427 | snaga | public | lineitem | i_l_suppkey_partkey   | 16457 |  184448 | 1383232 | 1383232 |   8901 |  548820 |        | pg_default |
| 16430 | snaga | public | lineitem | i_l_partkey           | 16457 |    5336 |  157612 |  157612 |   1429 |   15052 |        | pg_default |
| 16434 | snaga | public | lineitem | i_l_suppkey           | 16457 |    3472 | 2021816 | 2021816 |   2246 |   13855 |        | pg_default |
| 16436 | snaga | public | lineitem | i_l_receiptdate       | 16457 |       0 |       0 |       0 |      1 |      44 |        | pg_default |
| 16437 | snaga | public | lineitem | i_l_orderkey          | 16457 |  368420 |  889972 |  889972 |  16401 | 1091664 |        | pg_default |
| 16438 | snaga | public | lineitem | i_l_orderkey_quantity | 16457 |     100 |     100 |     100 |      6 |     339 |        | pg_default |
| 16422 | snaga | public | nation   | pk_nation             |     2 |   11062 |   11254 |   11254 |      2 |   11095 |        | pg_default |
| 16445 | snaga | public | nation   | i_n_regionkey         |     2 |       0 |       0 |       0 |      1 |      34 |        | pg_default |
| 16440 | snaga | public | orders   | i_o_orderdate         |  4116 |      17 | 1141309 |       5 |    788 |    2414 |        | pg_default |
| 16441 | snaga | public | orders   | i_o_custkey           |  4116 |   48596 |  481216 |  481216 |   3943 |  143380 |        | pg_default |
| 16418 | snaga | public | orders   | pk_orders             |  4116 | 1540884 | 1540884 | 1540884 |   4116 | 4627067 |        | pg_default |
| 16412 | snaga | public | part     | pk_part               |   551 |      84 |  800080 |  800080 |    551 |    1900 |        | pg_default |
| 16443 | snaga | public | partsupp | i_ps_partkey          |  2196 |    2776 |   10924 |   10924 |    456 |    7919 |        | pg_default |
| 16444 | snaga | public | partsupp | i_ps_suppkey          |  2196 |   11116 |  879800 |  879800 |   1704 |   34167 |        | pg_default |
| 16414 | snaga | public | partsupp | pk_partsupp           |  2196 |       0 |       0 |       0 |      1 |      14 |        | pg_default |
| 16424 | snaga | public | region   | pk_region             |     2 |      40 |      40 |      40 |      2 |      53 |        | pg_default |
| 16410 | snaga | public | supplier | pk_supplier           |    30 | 1404288 | 1444284 | 1444284 |     30 | 2816284 |        | pg_default |
| 16442 | snaga | public | supplier | i_s_nationkey         |    30 |       8 |    3176 |       0 |      4 |      50 |        | pg_default |
+-------+-------+--------+----------+-----------------------+-------+---------+---------+---------+--------+---------+--------+------------+
