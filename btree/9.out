                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=3362987.57..3362994.78 rows=206 width=46)
   Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
   ->  Sort  (cost=3362987.57..3362988.08 rows=206 width=46)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         ->  Hash Join  (cost=2602281.93..3362979.65 rows=206 width=46)
               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
               ->  Nested Loop  (cost=2602280.37..3362974.22 rows=206 width=24)
                     ->  Nested Loop  (cost=2602279.94..3361779.79 rows=206 width=24)
                           ->  Merge Join  (cost=2602279.64..3360614.74 rows=209 width=28)
                                 Merge Cond: (partsupp.ps_partkey = lineitem.l_partkey)
                                 Join Filter: (lineitem.l_suppkey = partsupp.ps_suppkey)
                                 ->  Index Scan using i_ps_partkey on partsupp  (cost=0.43..378668.70 rows=7999917 width=12)
                                 ->  Sort  (cost=2602272.00..2615506.64 rows=5293857 width=28)
                                       Sort Key: part.p_partkey
                                       ->  Hash Join  (cost=67899.19..2011057.02 rows=5293857 width=28)
                                             Hash Cond: (lineitem.l_partkey = part.p_partkey)
                                             ->  Seq Scan on lineitem  (cost=0.00..1665271.28 rows=59986128 width=24)
                                             ->  Hash  (cost=65626.50..65626.50 rows=181815 width=4)
                                                   ->  Seq Scan on part  (cost=0.00..65626.50 rows=181815 width=4)
                                                         Filter: ((p_name)::text ~~ '%honeydew%'::text)
                           ->  Index Scan using pk_supplier on supplier  (cost=0.29..5.56 rows=1 width=8)
                                 Index Cond: (s_suppkey = lineitem.l_suppkey)
                     ->  Index Scan using pk_orders on orders  (cost=0.43..5.79 rows=1 width=8)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Hash  (cost=1.25..1.25 rows=25 width=30)
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30)
(26 rows)

+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    53 |   63000000 |  1500000 |     0 |     0 |   585774 |  1133146 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    52 | 2400249780 | 59986052 |     0 |     0 | 35883182 | 28249971 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25715 |     642375 |       25 |     0 |     0 |        5 |    26024 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    22 |  240000000 | 15000000 |     0 |     0 |  5547552 | 11255962 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    20 |   19309115 |  2000000 |     0 |     0 |   377638 |   453025 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1124021 |  6923552 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    27902 |  3619787 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN  |   T_READ  |  T_FTCH | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |     200 |       200 |     200 |     47 |      603 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |       0 |         0 |       0 |     12 |       38 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |       0 |         0 |       0 |     16 |       67 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |       0 |         0 |       0 |     18 |       65 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |      23 | 136636474 |      12 | 323643 |    49855 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |       0 |         0 |       0 |     18 |       65 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   90171 |   2693297 | 2693297 |  34746 |   333254 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |     156 |       156 |     156 |     52 |      655 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       0 |         0 |       0 |     17 |       66 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 | 4015697 |   5829530 | 5829530 | 638979 | 15440895 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |     194 |       194 |     194 |     79 |      780 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |     330 |       330 |     330 |     17 |      362 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |       0 |         0 |       0 |     13 |       36 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |      47 |  87794960 |      13 | 107241 |   132839 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |     200 |       200 |     200 |     49 |      613 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 3448631 |   3448631 | 3448631 |  41183 | 10323586 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |     122 |   8001294 | 8001294 |   5492 |    16759 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |   25689 |   8102541 | 8102541 |  26260 |    73039 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   79438 |   6348013 | 6348013 |  15601 |   240388 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |       0 |         0 |       0 |      2 |        9 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |      94 |        94 |      94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 3551209 |   3551209 | 3551209 |    572 |  7121516 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       0 |         0 |       0 |     12 |       34 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+---------+-----------+---------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=3362987.57..3362994.78 rows=206 width=46) (actual time=428751.086..430203.279 rows=175 loops=1)
   Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
   ->  Sort  (cost=3362987.57..3362988.08 rows=206 width=46) (actual time=428745.903..429134.236 rows=3448437 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: quicksort  Memory: 583241kB
         ->  Hash Join  (cost=2602281.93..3362979.65 rows=206 width=46) (actual time=49995.372..424173.422 rows=3448437 loops=1)
               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
               ->  Nested Loop  (cost=2602280.37..3362974.22 rows=206 width=24) (actual time=49995.341..422452.791 rows=3448437 loops=1)
                     ->  Nested Loop  (cost=2602279.94..3361779.79 rows=206 width=24) (actual time=49976.689..68473.595 rows=3448437 loops=1)
                           ->  Merge Join  (cost=2602279.64..3360614.74 rows=209 width=28) (actual time=49976.675..60633.206 rows=3448437 loops=1)
                                 Merge Cond: (partsupp.ps_partkey = lineitem.l_partkey)
                                 Join Filter: (lineitem.l_suppkey = partsupp.ps_suppkey)
                                 Rows Removed by Join Filter: 10345311
                                 ->  Index Scan using i_ps_partkey on partsupp  (cost=0.43..378668.70 rows=7999917 width=12) (actual time=0.005..6401.140 rows=7999945 loops=1)
                                 ->  Sort  (cost=2602272.00..2615506.64 rows=5293857 width=28) (actual time=49898.536..51003.537 rows=13793745 loops=1)
                                       Sort Key: part.p_partkey
                                       Sort Method: quicksort  Memory: 367714kB
                                       ->  Hash Join  (cost=67899.19..2011057.02 rows=5293857 width=28) (actual time=1922.706..48374.235 rows=3448437 loops=1)
                                             Hash Cond: (lineitem.l_partkey = part.p_partkey)
                                             ->  Seq Scan on lineitem  (cost=0.00..1665271.28 rows=59986128 width=24) (actual time=0.014..35891.728 rows=59986052 loops=1)
                                             ->  Hash  (cost=65626.50..65626.50 rows=181815 width=4) (actual time=1922.038..1922.038 rows=114961 loops=1)
                                                   Buckets: 262144  Batches: 1  Memory Usage: 6090kB
                                                   ->  Seq Scan on part  (cost=0.00..65626.50 rows=181815 width=4) (actual time=0.006..1897.996 rows=114961 loops=1)
                                                         Filter: ((p_name)::text ~~ '%honeydew%'::text)
                                                         Rows Removed by Filter: 1885039
                           ->  Index Scan using pk_supplier on supplier  (cost=0.29..5.56 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=3448437)
                                 Index Cond: (s_suppkey = lineitem.l_suppkey)
                     ->  Index Scan using pk_orders on orders  (cost=0.43..5.79 rows=1 width=8) (actual time=0.102..0.102 rows=1 loops=3448437)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.009..0.009 rows=25 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 10kB
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.002..0.005 rows=25 loops=1)
 Planning time: 2.665 ms
 Execution time: 430221.012 ms
(34 rows)

Time: 430230.284 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    54 |   64500000 |  1500000 |     0 |     0 |   585774 |  1168434 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    56 | 2580207936 | 59986052 |     0 |     0 | 37631137 | 29698302 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25719 |     642450 |       25 |     0 |     0 |        5 |    26035 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    22 |  240000000 | 15000000 |     0 |     0 |  5573291 | 18354610 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    23 |   23309115 |  2000000 |     0 |     0 |   410753 |   501188 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1294937 |  7246534 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    30033 | 10514554 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      204 |       204 |      204 |     47 |      616 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     12 |       39 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     16 |       71 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     18 |       69 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       23 | 136636474 |       12 | 323643 |    49859 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     18 |       69 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90195 |   2693321 |  2693321 |  34746 |   333354 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      180 |       180 |      180 |     52 |      755 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        0 |         0 |        0 |     17 |       70 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638979 | 15440899 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      202 |       202 |      202 |     79 |      816 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      338 |       338 |      338 |     17 |      374 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     13 |       40 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       48 |  88362727 |       13 | 107241 |   134398 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      204 |       204 |      204 |     49 |      629 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10345513 |  10345513 | 10345513 |  82308 | 31010739 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      146 |   8001318 |  8001318 |   5493 |    16833 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25715 |  24102455 | 24102455 |  48122 |    94972 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |    79462 |   6348037 |  6348037 |  15607 |   240457 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       11 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10448107 |  10448107 | 10448107 |    845 | 20953082 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        0 |         0 |        0 |     13 |       36 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
Time: 600019.444 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    54 |   64500000 |  1500000 |     0 |     0 |   585774 |  1168434 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    57 | 2640193988 | 59986052 |     0 |     0 | 41709275 | 29698329 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25730 |     642675 |       25 |     0 |     0 |        5 |    26066 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    26 |  285000000 | 15000000 |     0 |     0 |  6094599 | 18613812 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    24 |   25309115 |  2000000 |     0 |     0 |   445050 |   507526 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1297020 |  9802839 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    31021 | 10548976 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      204 |       204 |      204 |     47 |      616 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     12 |       39 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     18 |       74 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     20 |       72 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       23 | 136636474 |       12 | 323645 |    49862 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     20 |       72 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90203 |   2693329 |  2693329 |  34748 |   333389 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     54 |      790 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        3 |  27332661 |        0 |  74710 |       73 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638981 | 15440902 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      212 |       212 |      212 |     95 |      845 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      360 |       360 |      360 |     17 |      402 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     13 |       46 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       48 |  88362727 |       13 | 107243 |   134401 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      204 |       204 |      204 |     51 |      632 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366189 |  10366189 | 10366189 | 101824 | 31053380 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      154 |   8001326 |  8001326 |   5493 |    16858 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25724 |  24151383 | 24151383 |  48255 |    95005 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   111470 |   8904885 |  8904885 |  20145 |   339045 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       17 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468821 |  10468821 | 10468821 |    982 | 20994488 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        8 |     31960 |        0 |     26 |      133 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2058990.90..2058990.91 rows=1 width=27) (actual time=97381.769..97381.769 rows=2 loops=1)
   Sort Key: lineitem.l_shipmode
   Sort Method: quicksort  Memory: 25kB
   ->  HashAggregate  (cost=2058990.88..2058990.89 rows=1 width=27) (actual time=97376.106..97376.107 rows=2 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Hash Join  (cost=778507.80..2054070.74 rows=281151 width=27) (actual time=19009.282..97046.539 rows=312347 loops=1)
               Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
               ->  Bitmap Heap Scan on lineitem  (cost=187727.28..1454504.25 rows=281151 width=15) (actual time=5035.392..82839.097 rows=312347 loops=1)
                     Recheck Cond: ((l_receiptdate >= '1993-01-01'::date) AND (l_receiptdate < '1994-01-01 00:00:00'::timestamp without time zone))
                     Filter: ((l_shipmode = ANY ('{FOB,TRUCK}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate))
                     Rows Removed by Filter: 8798540
                     Heap Blocks: exact=1004243
                     ->  Bitmap Index Scan on i_l_receiptdate  (cost=0.00..187656.99 rows=8949643 width=0) (actual time=4752.502..4752.502 rows=9110887 loops=1)
                           Index Cond: ((l_receiptdate >= '1993-01-01'::date) AND (l_receiptdate < '1994-01-01 00:00:00'::timestamp without time zone))
               ->  Hash  (cost=403279.12..403279.12 rows=15000112 width=20) (actual time=13956.259..13956.259 rows=15000000 loops=1)
                     Buckets: 16777216  Batches: 1  Memory Usage: 892791kB
                     ->  Seq Scan on orders  (cost=0.00..403279.12 rows=15000112 width=20) (actual time=17.413..10989.256 rows=15000000 loops=1)
 Planning time: 293.473 ms
 Execution time: 97386.703 ms
(19 rows)

Time: 98060.514 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    56 |   66000000 |  1500000 |     0 |     0 |   621058 |  1168438 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    57 | 2640193988 | 59986052 |     0 |     0 | 43717763 | 29698331 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25730 |     642675 |       25 |     0 |     0 |        5 |    26066 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    30 |  330000000 | 15000000 |     0 |     0 |  6847618 | 18620635 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    24 |   25309115 |  2000000 |     0 |     0 |   445050 |   507526 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1297020 |  9802839 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    31021 | 10548976 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      208 |       208 |      208 |     53 |      624 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     13 |       40 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     20 |       74 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     22 |       72 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       23 | 136636474 |       12 | 323647 |    49862 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     22 |       72 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90203 |   2693329 |  2693329 |  34750 |   333389 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     56 |      790 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        5 |  45554435 |        0 | 124506 |       73 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638983 | 15440902 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      216 |       216 |      216 |    111 |      847 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      360 |       360 |      360 |     17 |      402 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     13 |       46 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       48 |  88362727 |       13 | 107245 |   134403 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      208 |       208 |      208 |     58 |      641 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366193 |  10366193 | 10366193 | 101830 | 31053390 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      154 |   8001326 |  8001326 |   5493 |    16858 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25724 |  24151383 | 24151383 |  48255 |    95005 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   111470 |   8904885 |  8904885 |  20145 |   339045 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       17 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468821 |  10468821 | 10468821 |    982 | 20994488 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        8 |     31960 |        0 |     26 |      133 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=825754.84..825755.34 rows=200 width=8) (actual time=23159.010..23159.010 rows=46 loops=1)
   Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
   Sort Method: quicksort  Memory: 27kB
   ->  HashAggregate  (cost=825745.19..825747.19 rows=200 width=8) (actual time=23158.962..23158.970 rows=46 loops=1)
         Group Key: count(orders.o_orderkey)
         ->  HashAggregate  (cost=788246.90..803246.21 rows=1499932 width=8) (actual time=22626.210..22968.543 rows=1500000 loops=1)
               Group Key: customer.c_custkey
               ->  Hash Right Join  (cost=69032.47..713997.55 rows=14849868 width=8) (actual time=2034.703..16272.892 rows=15299061 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Seq Scan on orders  (cost=0.00..440779.40 rows=14849868 width=8) (actual time=0.013..7696.794 rows=14799039 loops=1)
                           Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                           Rows Removed by Filter: 200961
                     ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=4) (actual time=2032.170..2032.170 rows=1500000 loops=1)
                           Buckets: 2097152  Batches: 1  Memory Usage: 69119kB
                           ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=4) (actual time=0.005..1765.966 rows=1500000 loops=1)
 Planning time: 0.617 ms
 Execution time: 23165.098 ms
(17 rows)

Time: 23170.108 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    58 |   69000000 |  1500000 |     0 |     0 |   656340 |  1203728 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    57 | 2640193988 | 59986052 |     0 |     0 | 43717763 | 29698331 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25730 |     642675 |       25 |     0 |     0 |        5 |    26066 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    32 |  360000000 | 15000000 |     0 |     0 |  7280098 | 18694715 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    24 |   25309115 |  2000000 |     0 |     0 |   445050 |   507526 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |     4 |   32000000 |  8000000 |     0 |     0 |  1297020 |  9802839 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    53 |    3600004 |   100000 |     0 |     0 |    31021 | 10548976 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      212 |       212 |      212 |     53 |      638 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     13 |       42 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     20 |       74 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     22 |       72 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       23 | 136636474 |       12 | 323647 |    49862 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     22 |       72 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |    90203 |   2693329 |  2693329 |  34750 |   333389 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     56 |      790 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |        5 |  45554435 |        0 | 124506 |       73 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638983 | 15440902 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      216 |       216 |      216 |    111 |      847 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      360 |       360 |      360 |     17 |      402 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     13 |       46 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       48 |  88362727 |       13 | 107245 |   134405 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      212 |       212 |      212 |     58 |      655 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366193 |  10366193 | 10366193 | 101830 | 31053392 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      154 |   8001326 |  8001326 |   5493 |    16858 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25724 |  24151383 | 24151383 |  48255 |    95005 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   111470 |   8904885 |  8904885 |  20145 |   339045 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      3 |       17 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468821 |  10468821 | 10468821 |    982 | 20994488 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |        8 |     31960 |        0 |     26 |      133 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
