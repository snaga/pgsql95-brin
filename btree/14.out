                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1169711.58..1169711.59 rows=1 width=29)
   ->  Hash Join  (cost=102232.81..1156415.69 rows=759765 width=29)
         Hash Cond: (lineitem.l_partkey = part.p_partkey)
         ->  Bitmap Heap Scan on lineitem  (cost=16606.71..1059278.70 rows=782648 width=12)
               Recheck Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate < '1995-02-01 00:00:00'::timestamp without time zone))
               ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..16411.04 rows=782648 width=0)
                     Index Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate < '1995-02-01 00:00:00'::timestamp without time zone))
         ->  Hash  (cost=60626.60..60626.60 rows=1999960 width=25)
               ->  Seq Scan on part  (cost=0.00..60626.60 rows=1999960 width=25)
(9 rows)

+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    68 |   81000000 |  1500000 |     0 |     0 |   714525 |  1427843 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    61 | 2820152144 | 59986052 |     0 |     0 | 53300987 | 36427865 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    45 |  525000000 | 15000000 |     0 |     0 | 10168217 | 19275207 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    42 |   53309115 |  2000000 |     0 |     0 |   587416 |   933974 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      240 |       240 |      240 |     59 |      726 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     29 |       91 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     31 |       89 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       33 | 150251466 |       12 | 352410 |    58369 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     31 |       89 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154627 |   4702215 |  4702215 |  37568 |   593991 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     65 |      807 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       11 | 100219757 |        0 | 249000 |    24987 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638992 | 15440919 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      238 |       238 |      238 |    161 |      911 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108805 |   137527 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      240 |       240 |      240 |     68 |      746 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366215 |  10366215 | 10366215 | 101861 | 31053444 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      190 |   8001362 |  8001362 |   5516 |    16961 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1169711.58..1169711.59 rows=1 width=29) (actual time=97594.634..97594.634 rows=1 loops=1)
   ->  Hash Join  (cost=102232.81..1156415.69 rows=759765 width=29) (actual time=2209.209..97229.276 rows=775032 loops=1)
         Hash Cond: (lineitem.l_partkey = part.p_partkey)
         ->  Bitmap Heap Scan on lineitem  (cost=16606.71..1059278.70 rows=782648 width=12) (actual time=330.674..94723.910 rows=775032 loops=1)
               Recheck Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate < '1995-02-01 00:00:00'::timestamp without time zone))
               Heap Blocks: exact=412913
               ->  Bitmap Index Scan on i_l_shipdate  (cost=0.00..16411.04 rows=782648 width=0) (actual time=206.235..206.235 rows=775032 loops=1)
                     Index Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate < '1995-02-01 00:00:00'::timestamp without time zone))
         ->  Hash  (cost=60626.60..60626.60 rows=1999960 width=25) (actual time=1875.875..1875.875 rows=2000000 loops=1)
               Buckets: 2097152  Batches: 1  Memory Usage: 131903kB
               ->  Seq Scan on part  (cost=0.00..60626.60 rows=1999960 width=25) (actual time=0.005..1469.006 rows=2000000 loops=1)
 Planning time: 0.639 ms
 Execution time: 97596.076 ms
(13 rows)

Time: 97610.330 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    70 |   82500000 |  1500000 |     0 |     0 |   714525 |  1463133 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    63 | 2820152144 | 59986052 |     0 |     0 | 53692451 | 36449320 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    47 |  540000000 | 15000000 |     0 |     0 | 10401307 | 19295405 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    43 |   55309115 |  2000000 |     0 |     0 |   628041 |   933978 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      246 |       246 |      246 |     59 |      746 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       53 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     29 |       93 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     31 |       91 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       34 | 151026498 |       12 | 354532 |    58371 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     31 |       91 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154629 |   4702217 |  4702217 |  37568 |   594001 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     65 |      809 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       11 | 100219757 |        0 | 249000 |    24989 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638992 | 15440921 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      242 |       242 |      242 |    168 |      922 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108805 |   137529 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      246 |       246 |      246 |     68 |      766 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366219 |  10366219 | 10366219 | 101866 | 31053453 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      192 |   8001364 |  8001364 |   5516 |    16968 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=9150866.24..9150868.99 rows=100 width=39) (actual time=179149.939..179150.082 rows=75 loops=1)
   ->  GroupAggregate  (cost=9150866.24..9975675.50 rows=29993064 width=39) (actual time=179149.937..179150.075 rows=75 loops=1)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9150866.24..9225848.90 rows=29993064 width=39) (actual time=179141.283..179141.313 rows=525 loops=1)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               Sort Method: quicksort  Memory: 66kB
               ->  Hash Join  (cost=2710980.27..5426008.79 rows=29993064 width=39) (actual time=127175.143..179140.815 rows=525 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1665271.28 rows=59986128 width=8) (actual time=0.009..48345.621 rows=59986052 loops=1)
                     ->  Hash  (cost=2617229.57..2617229.57 rows=7500056 width=39) (actual time=124846.348..124846.348 rows=75 loops=1)
                           Buckets: 8388608  Batches: 1  Memory Usage: 65542kB
                           ->  Hash Join  (cost=2050054.28..2617229.57 rows=7500056 width=39) (actual time=100385.425..124846.202 rows=75 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=1981021.81..2445071.33 rows=7500056 width=20) (actual time=99784.309..124244.853 rows=75 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..403279.12 rows=15000112 width=16) (actual time=0.008..23265.827 rows=15000000 loops=1)
                                       ->  Hash  (cost=1975371.85..1975371.85 rows=451997 width=4) (actual time=99044.899..99044.899 rows=75 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 4099kB
                                             ->  HashAggregate  (cost=1965201.92..1970851.88 rows=451997 width=8) (actual time=95720.306..99044.783 rows=75 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '315'::double precision)
                                                   Rows Removed by Filter: 14999925
                                                   ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1665271.28 rows=59986128 width=8) (actual time=0.004..76294.731 rows=59986052 loops=1)
                                 ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=23) (actual time=571.228..571.228 rows=1500000 loops=1)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 98416kB
                                       ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=23) (actual time=0.008..258.197 rows=1500000 loops=1)
 Planning time: 1.049 ms
 Execution time: 179197.596 ms
(28 rows)

Time: 179291.817 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    72 |   85500000 |  1500000 |     0 |     0 |   714525 |  1533709 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    67 | 3060096352 | 59986052 |     0 |     0 | 56113550 | 38289869 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    49 |  570000000 | 15000000 |     0 |     0 | 10907764 | 19295520 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    43 |   55309115 |  2000000 |     0 |     0 |   628041 |   933978 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      254 |       254 |      254 |     59 |      772 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       55 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     29 |       95 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     31 |       93 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       34 | 151026498 |       12 | 354532 |    58373 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     31 |       93 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154629 |   4702217 |  4702217 |  37568 |   594003 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     65 |      811 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       11 | 100219757 |        0 | 249000 |    24991 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638992 | 15440923 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      250 |       250 |      250 |    168 |      956 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108805 |   137531 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      254 |       254 |      254 |     68 |      792 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366227 |  10366227 | 10366227 | 101866 | 31053479 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      192 |   8001364 |  8001364 |   5516 |    16968 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=9150866.24..9150868.99 rows=100 width=39) (actual time=176349.611..176349.753 rows=75 loops=1)
   ->  GroupAggregate  (cost=9150866.24..9975675.50 rows=29993064 width=39) (actual time=176349.609..176349.741 rows=75 loops=1)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9150866.24..9225848.90 rows=29993064 width=39) (actual time=176333.222..176333.257 rows=525 loops=1)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               Sort Method: quicksort  Memory: 66kB
               ->  Hash Join  (cost=2710980.27..5426008.79 rows=29993064 width=39) (actual time=126675.447..176266.053 rows=525 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1665271.28 rows=59986128 width=8) (actual time=0.009..44066.798 rows=59986052 loops=1)
                     ->  Hash  (cost=2617229.57..2617229.57 rows=7500056 width=39) (actual time=126208.934..126208.934 rows=75 loops=1)
                           Buckets: 8388608  Batches: 1  Memory Usage: 65542kB
                           ->  Hash Join  (cost=2050054.28..2617229.57 rows=7500056 width=39) (actual time=100991.666..126208.800 rows=75 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=1981021.81..2445071.33 rows=7500056 width=20) (actual time=100459.356..125676.299 rows=75 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..403279.12 rows=15000112 width=16) (actual time=0.009..24106.863 rows=15000000 loops=1)
                                       ->  Hash  (cost=1975371.85..1975371.85 rows=451997 width=4) (actual time=99741.725..99741.725 rows=75 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 4099kB
                                             ->  HashAggregate  (cost=1965201.92..1970851.88 rows=451997 width=8) (actual time=96527.395..99741.621 rows=75 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '315'::double precision)
                                                   Rows Removed by Filter: 14999925
                                                   ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1665271.28 rows=59986128 width=8) (actual time=0.002..78570.170 rows=59986052 loops=1)
                                 ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=23) (actual time=529.909..529.909 rows=1500000 loops=1)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 98416kB
                                       ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=23) (actual time=0.004..234.675 rows=1500000 loops=1)
 Planning time: 1.098 ms
 Execution time: 176393.727 ms
(28 rows)

Time: 176825.164 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    74 |   88500000 |  1500000 |     0 |     0 |   714525 |  1604285 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    71 | 3300040560 | 59986052 |     0 |     0 | 58011295 | 40653772 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    51 |  600000000 | 15000000 |     0 |     0 | 11414092 | 19295764 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    43 |   55309115 |  2000000 |     0 |     0 |   628041 |   933978 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      262 |       262 |      262 |     59 |      798 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       57 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     29 |       97 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     31 |       95 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       34 | 151026498 |       12 | 354532 |    58375 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     31 |       95 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154629 |   4702217 |  4702217 |  37568 |   594005 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     65 |      813 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       11 | 100219757 |        0 | 249000 |    24993 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638992 | 15440925 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      258 |       258 |      258 |    168 |      990 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108805 |   137533 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      262 |       262 |      262 |     68 |      818 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366235 |  10366235 | 10366235 | 101866 | 31053505 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      192 |   8001364 |  8001364 |   5516 |    16968 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
SET
Timing is on.
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=9150866.24..9150868.99 rows=100 width=39) (actual time=176758.484..176758.627 rows=75 loops=1)
   ->  GroupAggregate  (cost=9150866.24..9975675.50 rows=29993064 width=39) (actual time=176758.482..176758.622 rows=75 loops=1)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9150866.24..9225848.90 rows=29993064 width=39) (actual time=176740.141..176740.163 rows=525 loops=1)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               Sort Method: quicksort  Memory: 66kB
               ->  Hash Join  (cost=2710980.27..5426008.79 rows=29993064 width=39) (actual time=129856.103..176704.483 rows=525 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1665271.28 rows=59986128 width=8) (actual time=0.008..41416.066 rows=59986052 loops=1)
                     ->  Hash  (cost=2617229.57..2617229.57 rows=7500056 width=39) (actual time=129230.568..129230.568 rows=75 loops=1)
                           Buckets: 8388608  Batches: 1  Memory Usage: 65542kB
                           ->  Hash Join  (cost=2050054.28..2617229.57 rows=7500056 width=39) (actual time=107914.673..129230.430 rows=75 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=1981021.81..2445071.33 rows=7500056 width=20) (actual time=107385.867..128701.424 rows=75 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..403279.12 rows=15000112 width=16) (actual time=0.008..20178.109 rows=15000000 loops=1)
                                       ->  Hash  (cost=1975371.85..1975371.85 rows=451997 width=4) (actual time=106654.057..106654.057 rows=75 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 4099kB
                                             ->  HashAggregate  (cost=1965201.92..1970851.88 rows=451997 width=8) (actual time=103459.150..106653.965 rows=75 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '315'::double precision)
                                                   Rows Removed by Filter: 14999925
                                                   ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1665271.28 rows=59986128 width=8) (actual time=0.003..85561.880 rows=59986052 loops=1)
                                 ->  Hash  (cost=50283.32..50283.32 rows=1499932 width=23) (actual time=526.074..526.074 rows=1500000 loops=1)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 98416kB
                                       ->  Seq Scan on customer  (cost=0.00..50283.32 rows=1499932 width=23) (actual time=0.006..234.359 rows=1500000 loops=1)
 Planning time: 1.055 ms
 Execution time: 176803.708 ms
(28 rows)

Time: 177117.928 ms
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |   BLKS  |  SCAN |   T_READ   |  T_INS   | T_UPD | T_DEL |  B_READ  |  B_HIT   | VACUUMED |       ANALYZED      | TABLESPACE |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
| 16593 | snaga | public | customer |   35284 |    76 |   91500000 |  1500000 |     0 |     0 |   714525 |  1674861 |          | 2015-07-16 05:49:04 | pg_default |
| 16599 | snaga | public | lineitem | 1065410 |    75 | 3539984768 | 59986052 |     0 |     0 | 59943607 | 42983108 |          | 2015-07-16 05:49:41 | pg_default |
| 16602 | snaga | public | nation   |       1 | 25738 |     642800 |       25 |     0 |     0 |        6 |    26086 |          | 2015-07-16 05:49:41 | pg_default |
| 16596 | snaga | public | orders   |  253278 |    53 |  630000000 | 15000000 |     0 |     0 | 11920292 | 19296136 |          | 2015-07-16 05:49:16 | pg_default |
| 16587 | snaga | public | part     |   40627 |    43 |   55309115 |  2000000 |     0 |     0 |   628041 |   933978 |          | 2015-07-16 05:48:56 | pg_default |
| 16590 | snaga | public | partsupp |  170916 |    12 |   88000000 |  8000000 |     0 |     0 |  2012375 | 10923128 |          | 2015-07-16 05:49:04 | pg_default |
| 16605 | snaga | public | region   |       1 |    49 |        177 |        5 |     0 |     0 |        6 |      129 |          | 2015-07-16 05:49:41 | pg_default |
| 16584 | snaga | public | supplier |    2180 |    68 |    4300004 |   100000 |     0 |     0 |    35524 | 10563427 |          | 2015-07-16 05:48:55 | pg_default |
+-------+-------+--------+----------+---------+-------+------------+----------+-------+-------+----------+----------+----------+---------------------+------------+
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
|  OID  | OWNER | SCHEMA |  TABLE   |         INDEX         |  BLKS  |   SCAN   |   T_READ  |  T_FTCH  | B_READ |  B_HIT   | STATUS | TABLESPACE |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
| 16619 | snaga | public | customer | pk_customer           |   4116 |      270 |       270 |      270 |     59 |      824 |        | pg_default |
| 16638 | snaga | public | customer | i_c_nationkey         |   4116 |        0 |         0 |        0 |     14 |       59 |        | pg_default |
| 16645 | snaga | public | lineitem | i_l_commitdate        | 164480 |        0 |         0 |        0 |     29 |       99 |        | pg_default |
| 16624 | snaga | public | lineitem | pk_lineitem           | 164480 |        0 |         0 |        0 |     31 |       97 |        | pg_default |
| 16631 | snaga | public | lineitem | i_l_shipdate          | 164480 |       34 | 151026498 |       12 | 354532 |    58377 |        | pg_default |
| 16632 | snaga | public | lineitem | i_l_suppkey_partkey   | 164480 |        0 |         0 |        0 |     31 |       97 |        | pg_default |
| 16633 | snaga | public | lineitem | i_l_partkey           | 164480 |   154629 |   4702217 |  4702217 |  37568 |   594007 |        | pg_default |
| 16634 | snaga | public | lineitem | i_l_suppkey           | 164480 |      188 |       188 |      188 |     65 |      815 |        | pg_default |
| 16635 | snaga | public | lineitem | i_l_receiptdate       | 164480 |       11 | 100219757 |        0 | 249000 |    24995 |        | pg_default |
| 16636 | snaga | public | lineitem | i_l_orderkey          | 164480 |  4015697 |   5829530 |  5829530 | 638992 | 15440927 |        | pg_default |
| 16637 | snaga | public | lineitem | i_l_orderkey_quantity | 164480 |      266 |       266 |      266 |    168 |     1024 |        | pg_default |
| 16627 | snaga | public | nation   | pk_nation             |      2 |      376 |       376 |      376 |     19 |      422 |        | pg_default |
| 16644 | snaga | public | nation   | i_n_regionkey         |      2 |        0 |         0 |        0 |     14 |       51 |        | pg_default |
| 16639 | snaga | public | orders   | i_o_orderdate         |  41131 |       51 |  90066028 |       13 | 108805 |   137535 |        | pg_default |
| 16640 | snaga | public | orders   | i_o_custkey           |  41131 |      270 |       270 |      270 |     68 |      844 |        | pg_default |
| 16622 | snaga | public | orders   | pk_orders             |  41131 | 10366243 |  10366243 | 10366243 | 101866 | 31053531 |        | pg_default |
| 16612 | snaga | public | part     | pk_part               |   5487 |      192 |   8001364 |  8001364 |   5516 |    16968 |        | pg_default |
| 16642 | snaga | public | partsupp | i_ps_partkey          |  21937 |    25740 |  24151399 | 24151399 |  48262 |    95056 |        | pg_default |
| 16643 | snaga | public | partsupp | i_ps_suppkey          |  21937 |   119476 |   9544101 |  9544101 |  29220 |   355772 |        | pg_default |
| 16616 | snaga | public | partsupp | pk_partsupp           |  21937 |        0 |         0 |        0 |      5 |       25 |        | pg_default |
| 16629 | snaga | public | region   | pk_region             |      2 |       94 |        94 |       94 |     13 |      119 |        | pg_default |
| 16610 | snaga | public | supplier | pk_supplier           |    276 | 10468841 |  10468841 | 10468841 |    998 | 20994527 |        | pg_default |
| 16641 | snaga | public | supplier | i_s_nationkey         |    276 |       10 |     39950 |        0 |     57 |      143 |        | pg_default |
+-------+-------+--------+----------+-----------------------+--------+----------+-----------+----------+--------+----------+--------+------------+
